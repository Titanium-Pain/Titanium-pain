!function t(e,i,n){function r(s,c){if(!i[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){var i=e[s][1][t];return r(i?i:t)},l,l.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){function n(t){if(cc.js.isObject(t))try{return JSON.stringify(t)}catch(e){return""}else return t}if(cc._LogInfos={ActionManager:{addAction:"cc.ActionManager.addAction(): action must be non-null",removeAction:"cocos2d: removeAction: Target not found",removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",getActionByTag_2:"cocos2d : getActionByTag(tag = %s): Action not found"},configuration:{dumpInfo:"cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from CCMacro.js)",loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",loadConfigFile_2:"Please load the resource first : %s"},Director:{resume:"cocos2d: Director: Error in gettimeofday",setProjection:"cocos2d: Director: unrecognized projection",popToSceneStackLevel:"cocos2d: Director: unrecognized projection",popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",popScene:"running scene should not null",pushScene:"the scene should not null"},Array:{verifyType:"element type is wrong!"},deprecated:'"%s" is deprecated, please use "%s" instead.',Scheduler:{scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null"},Node:{getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",getRotation:"RotationX != RotationY. Don't know which one to return",getScale:"ScaleX != ScaleY. Don't know which one to return",addChild:"An Node can't be added as a child of itself.",addChild_2:"child already added. It can't be added again",addChild_3:"child must be non-null",removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",removeChildByTag:"argument tag is an invalid tag",removeChildByTag_2:"cocos2d: removeChildByTag(tag = %s): child not found!",removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",reumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",_arrayMakeObjectsPerformSelector:"Unknown callback function",reorderChild:"child must be non-null",runAction:"cc.Node.runAction(): action must be non-null",schedule:"callback function must be non-null",schedule_2:"interval must be positive",initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_requestDirtyFlag:"_ccsg.Node._requestDirtyFlag: failed to satisfy the request, key (%s) for flag have already been taken"},AtlasNode:{_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",_initWithTileFile:"",_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture."},_checkEventListenerAvailable:{keyboard:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",touchOneByOne:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",touchAllAtOnce:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",acceleration:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil"},EventListener:{create:"Invalid parameter."},__getListenerID:"Don't call this method if the event is for touch.",LayerMultiplex:{initWithLayers:"parameters should not be ending with null in Javascript",switchTo:"Invalid index in MultiplexLayer switchTo message",switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",addLayer:"cc.Layer.addLayer(): layer should be non-null"},view:{setDesignResolutionSize:"Resolution not valid",setDesignResolutionSize_2:"should set resolutionPolicy"},inputManager:{handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex = %s"},checkGLErrorDebug:"WebGL error %s",spriteFrameAnimationCache:{_addAnimationsWithDictionary:"cocos2d: cc.SpriteFrameAnimationCache: No animations were found in provided dictionary.",_addAnimationsWithDictionary_2:"cc.SpriteFrameAnimationCache. Invalid animation format",addAnimations:"cc.SpriteFrameAnimationCache.addAnimations(): File could not be found",_parseVersion1:"cocos2d: cc.SpriteFrameAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",_parseVersion1_2:"cocos2d: cc.SpriteFrameAnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",_parseVersion1_3:"cocos2d: cc.SpriteFrameAnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",_parseVersion1_4:"cocos2d: cc.SpriteFrameAnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",_parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",_parseVersion2_2:"cocos2d: cc.SpriteFrameAnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",addAnimations_2:"cc.SpriteFrameAnimationCache.addAnimations(): Invalid texture file name"},Sprite:{reorderChild:"cc.Sprite.reorderChild(): this child is not in children list",ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",_updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",initWithSpriteFrameName1:" is null, please check.",initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",reorderChild_2:"cc.Sprite.reorderChild(): child should be non-null",addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",addChild_3:"cc.Sprite.addChild(): child should be non-null",setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",setSpriteFrame:"Invalid spriteFrameName",setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null"},SpriteBatchNode:{addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",addChild_2:"cc.Sprite.addChild(): child should be non-null",setSpriteFrame:"Invalid spriteFrameName",setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null"},spriteFrameCache:{_getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",_checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",_getFrameConfig_2:"Please load the resource first : %s",addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",addSpriteFrames_3:"Argument must be non-nil"},TextureAtlas:{initWithFile:"cocos2d: Could not open file: %s",insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex"},textureCache:{addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",addPVRImage:"addPVRImage does not support on HTML5",addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",dumpCachedTextureInfo:"cocos2d: '%s' id=%s %s x %s",dumpCachedTextureInfo_2:"cocos2d: '%s' id= HTMLCanvasElement %s x %s",dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",invalidKey:"TextureCache: url should be non-null"},Texture2D:{initWithETCFile:"initWithETCFile does not support on HTML5",initWithPVRFile:"initWithPVRFile does not support on HTML5",initWithPVRTCData:"initWithPVRTCData does not support on HTML5",addImage:"cc.Texture.addImage(): path should be non-null",initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",initWithString:"initWithString isn't supported on cocos2d-html5",initWithETCFile_2:"initWithETCFile does not support on HTML5",initWithPVRFile_2:"initWithPVRFile does not support on HTML5",initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",_initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",addImage_2:"cc.Texture.addImage(): path should be non-null",initWithData:"NSInternalInconsistencyException"},MissingFile:"Missing file: %s",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager:{addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",removeListeners:"Invalid listener type!",setPriority:"Can't set fixed priority with scene graph based listener.",addListener_2:"Invalid parameters.",addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",addListener_4:"The listener has been registered, please don't register it again.",_forceAddEventListener:"Invalid scene graph priority!",_updateListeners:"If program goes here, there should be event in dispatch.",_updateListeners_2:"_inDispatch should be 1 here."}},!1)cc._LogInfos.Editor={Class:{callSuperCtor:"cc.Class will automatically call super constructor of %s, you should not call it manually."}};cc._logToWebPage=function(t){if(cc._canvas){var e=cc._logList,i=document;if(!e){var n=i.createElement("Div"),r=n.style;n.setAttribute("id","logInfoDiv"),cc._canvas.parentNode.appendChild(n),n.setAttribute("width","200"),n.setAttribute("height",cc._canvas.height),r.zIndex="99999",r.position="absolute",r.top="0",r.left="0",e=cc._logList=i.createElement("textarea");var o=e.style;e.setAttribute("rows","20"),e.setAttribute("cols","30"),e.setAttribute("disabled",!0),n.appendChild(e),o.backgroundColor="transparent",o.borderBottom="1px solid #cccccc",o.borderRightWidth="0px",o.borderLeftWidth="0px",o.borderTopWidth="0px",o.borderTopStyle="none",o.borderRightStyle="none",o.borderLeftStyle="none",o.padding="0px",o.margin=0}e.value=e.value+t+"\r\n",e.scrollTop=e.scrollHeight}};var r=t("./cocos2d/core/value-types/CCEnum");cc.DebugMode=r({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});var o=cc.log||console.log;cc._initDebugSetting=function(t){if(cc.log=cc.warn=cc.error=cc._throw=cc.assert=function(){},t!==cc.DebugMode.NONE){var e;if(false){if(e=cc._logToWebPage.bind(cc),cc.error=function(){e("ERROR :  "+cc.js.formatStr.apply(cc,arguments))},cc.assert=function(t,i){"use strict";if(!t&&i){for(var r=2;r<arguments.length;r++)i=i.replace(/(%s)|(%d)/,n(arguments[r]));e("Assert: "+i)}},t!==cc.DebugMode.ERROR_FOR_WEB_PAGE)cc.warn=function(){e("WARN :  "+cc.js.formatStr.apply(cc,arguments))};if(t===cc.DebugMode.INFO_FOR_WEB_PAGE)cc.log=cc.info=function(){e(cc.js.formatStr.apply(cc,arguments))}}else if(console&&console.log.apply){if(!console.error)console.error=console.log;if(!console.warn)console.warn=console.log;if(!1)cc.error=Editor.error;else if(console.error.bind)cc.error=console.error.bind(console);else cc.error=function(){return console.error.apply(console,arguments)};if(cc.assert=function(t,e){if(!t&&e){for(var i=2;i<arguments.length;i++)e=e.replace(/(%s)|(%d)/,n(arguments[i]));throw new Error(e)}},t!==cc.DebugMode.ERROR)if(!1)cc.warn=Editor.warn;else if(console.warn.bind)cc.warn=console.warn.bind(console);else cc.warn=function(){return console.warn.apply(console,arguments)};if(!1)cc.log=Editor.log,cc.info=Editor.info;else if(t===cc.DebugMode.INFO){if(!0)cc.log=o;else if(console.log.bind)cc.log=console.log.bind(console);else cc.log=function(){return console.log.apply(console,arguments)};cc.info=function(){(console.info||console.log).apply(console,arguments)}}}cc._throw=function(t){cc.error(t.stack||t)}}}},{"./cocos2d/core/value-types/CCEnum":95}],2:[function(t,e,i){cc.Action=cc._Class.extend({ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.Action.TAG_INVALID},clone:function(){var t=new cc.Action;return t.originalTarget=null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.originalTarget=t,this.target=t},stop:function(){this.target=null},step:function(t){cc.log("[Action step]. override me")},update:function(t){cc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(t){this.target=t},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(t){this.originalTarget=t},getTag:function(){return this.tag},setTag:function(t){this.tag=t},retain:function(){},release:function(){}}),cc.Action.TAG_INVALID=-1,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(t){this._duration=t},reverse:function(){return cc.log("cocos2d: FiniteTimeAction#reverse: Implement me"),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},initWithAction:function(t,e){if(!t)throw new Error("cc.Speed.initWithAction(): action must be non nil");return this._innerAction=t,this._speed=e,!0},clone:function(){var t=new cc.Speed;return t.initWithAction(this._innerAction.clone(),this._speed),t},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(t){this._innerAction.step(t*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(t){if(this._innerAction!==t)this._innerAction=t},getInnerAction:function(){return this._innerAction}}),cc.speed=function(t,e){return new cc.Speed(t,e)},cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){if(cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t)e?this.initWithTarget(t,e):this.initWithTarget(t)},clone:function(){var t=new cc.Follow,e=this._worldRect,i=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,i),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)throw new Error("cc.Follow.initWithAction(): followedNode must be non nil");var i=this;e=e||cc.rect(0,0,0,0),i._followedNode=t,i._worldRect=e,i._boundarySet=!cc._rectEqualToZero(e),i._boundaryFullyCovered=!1;var n=cc.director.getWinSize();if(i._fullScreenSize=cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet){if(i.leftBoundary=-(e.x+e.width-i._fullScreenSize.x),i.rightBoundary=-e.x,i.topBoundary=-e.y,i.bottomBoundary=-(e.y+e.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary)i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2;if(i.topBoundary<i.bottomBoundary)i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2;if(i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary)i._boundaryFullyCovered=!0}return!0},step:function(t){var e=this._followedNode.x,i=this._followedNode.y;if(e=this._halfScreenSize.x-e,i=this._halfScreenSize.y-i,this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(cc.clampf(e,this.leftBoundary,this.rightBoundary),cc.clampf(i,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(e,i)},isDone:function(){return!this._followedNode.isRunning()},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return new cc.Follow(t,e)}},{}],3:[function(t,e,i){cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ActionEase.initWithAction(): action must be non nil");if(this.initWithDuration(t.getDuration()))return this._inner=t,!0;else return!1},clone:function(){var t=new cc.ActionEase;return t.initWithAction(this._inner.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),cc.ActionInterval.prototype.stop.call(this)},update:function(t){this._inner.update(t)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),cc.actionEase=function(t){return new cc.ActionEase(t)},cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},setRate:function(t){this._rate=t},getRate:function(){return this._rate},initWithAction:function(t,e){if(cc.ActionEase.prototype.initWithAction.call(this,t))return this._rate=e,!0;else return!1},clone:function(){var t=new cc.EaseRateAction;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}}),cc.easeRateAction=function(t,e){return new cc.EaseRateAction(t,e)},cc.EaseIn=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseIn;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeIn=function(t){return{_rate:t,easing:function(t){return Math.pow(t,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.EaseOut=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseOut;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeOut=function(t){return{_rate:t,easing:function(t){return Math.pow(t,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.EaseInOut=cc.EaseRateAction.extend({update:function(t){if(t*=2,1>t)this._inner.update(.5*Math.pow(t,this._rate));else this._inner.update(1-.5*Math.pow(2-t,this._rate))},clone:function(){var t=new cc.EaseInOut;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}}),cc.easeInOut=function(t){return{_rate:t,easing:function(t){if(t*=2,1>t)return.5*Math.pow(t,this._rate);else return 1-.5*Math.pow(2-t,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}},cc.EaseExponentialIn=cc.ActionEase.extend({update:function(t){this._inner.update(0===t?0:Math.pow(2,10*(t-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInObj={easing:function(t){return 0===t?0:Math.pow(2,10*(t-1))},reverse:function(){return cc._easeExponentialOutObj}},cc.easeExponentialIn=function(){return cc._easeExponentialInObj},cc.EaseExponentialOut=cc.ActionEase.extend({update:function(t){this._inner.update(1===t?1:-Math.pow(2,-10*t)+1)},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialOutObj={easing:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},reverse:function(){return cc._easeExponentialInObj}},cc.easeExponentialOut=function(){return cc._easeExponentialOutObj},cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(t){if(1!==t&&0!==t)if(t*=2,1>t)t=.5*Math.pow(2,10*(t-1));else t=.5*(-Math.pow(2,-10*(t-1))+2);this._inner.update(t)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialInOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInOutObj={easing:function(t){if(1!==t&&0!==t)if(t*=2,1>t)return.5*Math.pow(2,10*(t-1));else return.5*(-Math.pow(2,-10*(t-1))+2);return t},reverse:function(){return cc._easeExponentialInOutObj}},cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj},cc.EaseSineIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1,this._inner.update(t)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var t=new cc.EaseSineIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineInObj={easing:function(t){return 0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}},cc.easeSineIn=function(){return cc._easeSineInObj},cc.EaseSineOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:Math.sin(t*Math.PI/2),this._inner.update(t)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var t=new cc.EaseSineOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineOutObj={easing:function(t){return 0===t||1===t?t:Math.sin(t*Math.PI/2)},reverse:function(){return cc._easeSineInObj}},cc.easeSineOut=function(){return cc._easeSineOutObj},cc.EaseSineInOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1),this._inner.update(t)},clone:function(){var t=new cc.EaseSineInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}}),cc._easeSineInOutObj={easing:function(t){return 0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1)},reverse:function(){return cc._easeSineInOutObj}},cc.easeSineInOut=function(){return cc._easeSineInOutObj},cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),t&&this.initWithAction(t,e)},getPeriod:function(){return this._period},setPeriod:function(t){this._period=t},initWithAction:function(t,e){return cc.ActionEase.prototype.initWithAction.call(this,t),this._period=null==e?.3:e,!0},reverse:function(){return cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass."),null},clone:function(){var t=new cc.EaseElastic;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticIn=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;t-=1,e=-Math.pow(2,10*t)*Math.sin((t-i)*Math.PI*2/this._period)}this._inner.update(e)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticIn;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticInObj={easing:function(t){if(0===t||1===t)return t;else return t-=1,-Math.pow(2,10*t)*Math.sin((t-.075)*Math.PI*2/.3)},reverse:function(){return cc._easeElasticOutObj}},cc.easeElasticIn=function(t){if(t&&.3!==t)return{_period:t,easing:function(t){if(0===t||1===t)return t;else return t-=1,-Math.pow(2,10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)},reverse:function(){return cc.easeElasticOut(this._period)}};else return cc._easeElasticInObj},cc.EaseElasticOut=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;e=Math.pow(2,-10*t)*Math.sin((t-i)*Math.PI*2/this._period)+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticOutObj={easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}},cc.easeElasticOut=function(t){if(t&&.3!==t)return{_period:t,easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}};else return cc._easeElasticOutObj},cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{if(t=2*t,!i)i=this._period=.3*1.5;var n=i/4;if(t-=1,0>t)e=-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i);else e=Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticInOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.easeElasticInOut=function(t){return t=t||.3,{_period:t,easing:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{if(t=2*t,!i)i=this._period=.3*1.5;var n=i/4;if(t-=1,0>t)e=-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i);else e=Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}return e},reverse:function(){return cc.easeElasticInOut(this._period)}}},cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(t){if(1/2.75>t)return 7.5625*t*t;else if(2/2.75>t)return t-=1.5/2.75,7.5625*t*t+.75;else if(2.5/2.75>t)return t-=2.25/2.75,7.5625*t*t+.9375;return t-=2.625/2.75,7.5625*t*t+.984375},clone:function(){var t=new cc.EaseBounce;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}}),cc.EaseBounceIn=cc.EaseBounce.extend({update:function(t){var e=1-this.bounceTime(1-t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceIn;return t.initWithAction(this._inner.clone()),t}}),cc._bounceTime=function(t){if(1/2.75>t)return 7.5625*t*t;else if(2/2.75>t)return t-=1.5/2.75,7.5625*t*t+.75;else if(2.5/2.75>t)return t-=2.25/2.75,7.5625*t*t+.9375;return t-=2.625/2.75,7.5625*t*t+.984375},cc._easeBounceInObj={easing:function(t){return 1-cc._bounceTime(1-t)},reverse:function(){return cc._easeBounceOutObj}},cc.easeBounceIn=function(){return cc._easeBounceInObj},cc.EaseBounceOut=cc.EaseBounce.extend({update:function(t){var e=this.bounceTime(t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBounceOutObj={easing:function(t){return cc._bounceTime(t)},reverse:function(){return cc._easeBounceInObj}},cc.easeBounceOut=function(){return cc._easeBounceOutObj},cc.EaseBounceInOut=cc.EaseBounce.extend({
update:function(t){var e=0;if(.5>t)t=2*t,e=.5*(1-this.bounceTime(1-t));else e=.5*this.bounceTime(2*t-1)+.5;this._inner.update(e)},clone:function(){var t=new cc.EaseBounceInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}}),cc._easeBounceInOutObj={easing:function(t){var e;if(.5>t)t=2*t,e=.5*(1-cc._bounceTime(1-t));else e=.5*cc._bounceTime(2*t-1)+.5;return e},reverse:function(){return cc._easeBounceInOutObj}},cc.easeBounceInOut=function(){return cc._easeBounceInOutObj},cc.EaseBackIn=cc.ActionEase.extend({update:function(t){var e=1.70158;t=0===t||1===t?t:t*t*((e+1)*t-e),this._inner.update(t)},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBackIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackInObj={easing:function(t){var e=1.70158;return 0===t||1===t?t:t*t*((e+1)*t-e)},reverse:function(){return cc._easeBackOutObj}},cc.easeBackIn=function(){return cc._easeBackInObj},cc.EaseBackOut=cc.ActionEase.extend({update:function(t){var e=1.70158;t-=1,this._inner.update(t*t*((e+1)*t+e)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBackOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackOutObj={easing:function(t){var e=1.70158;return t-=1,t*t*((e+1)*t+e)+1},reverse:function(){return cc._easeBackInObj}},cc.easeBackOut=function(){return cc._easeBackOutObj},cc.EaseBackInOut=cc.ActionEase.extend({update:function(t){var e=2.5949095;if(t=2*t,1>t)this._inner.update(t*t*((e+1)*t-e)/2);else t-=2,this._inner.update(t*t*((e+1)*t+e)/2+1)},clone:function(){var t=new cc.EaseBackInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}}),cc._easeBackInOutObj={easing:function(t){var e=2.5949095;if(t=2*t,1>t)return t*t*((e+1)*t-e)/2;else return t-=2,t*t*((e+1)*t+e)/2+1},reverse:function(){return cc._easeBackInOutObj}},cc.easeBackInOut=function(){return cc._easeBackInOutObj},cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(t){cc.ActionEase.prototype.ctor.call(this,t)},_updateTime:function(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},update:function(t){var e=this._updateTime(this._p0,this._p1,this._p2,this._p3,t);this._inner.update(e)},clone:function(){var t=new cc.EaseBezierAction;return t.initWithAction(this._inner.clone()),t.setBezierParamer(this._p0,this._p1,this._p2,this._p3),t},reverse:function(){var t=new cc.EaseBezierAction(this._inner.reverse());return t.setBezierParamer(this._p3,this._p2,this._p1,this._p0),t},setBezierParamer:function(t,e,i,n){this._p0=t||0,this._p1=e||0,this._p2=i||0,this._p3=n||0}}),cc.easeBezierAction=function(t,e,i,n){return{easing:function(r){return cc.EaseBezierAction.prototype._updateTime(t,e,i,n,r)},reverse:function(){return cc.easeBezierAction(n,i,e,t)}}},cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(t){return Math.pow(t,2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}}),cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}},cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn},cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-t*(t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionOut;return t.initWithAction(),t},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}}),cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}},cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut},cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(t){var e=t;if(t*=2,1>t)e=t*t*.5;else--t,e=-.5*(t*(t-2)-1);return e},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}}),cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}},cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut},cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}}),cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}},cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn},cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,-(t*t*t*t-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}}),cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}},cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut},cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(t){if(t=2*t,1>t)return.5*t*t*t*t;else return t-=2,-.5*(t*t*t*t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}}),cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}},cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut},cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}}),cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}},cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn},cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,t*t*t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}}),cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}},cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut},cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(t){if(t=2*t,1>t)return.5*t*t*t*t*t;else return t-=2,.5*(t*t*t*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}}),cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}},cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut},cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(t){return-1*(Math.sqrt(1-t*t)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}}),cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}},cc.easeCircleActionIn=function(){return cc._easeCircleActionIn},cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,Math.sqrt(1-t*t)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}}),cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}},cc.easeCircleActionOut=function(){return cc._easeCircleActionOut},cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(t){if(t=2*t,1>t)return-.5*(Math.sqrt(1-t*t)-1);else return t-=2,.5*(Math.sqrt(1-t*t)+1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}}),cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}},cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut},cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}}),cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}},cc.easeCubicActionIn=function(){return cc._easeCubicActionIn},cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}}),cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}},cc.easeCubicActionOut=function(){return cc._easeCubicActionOut},cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(t){if(t=2*t,1>t)return.5*t*t*t;else return t-=2,.5*(t*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}}),cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}},cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut}},{}],4:[function(t,e,i){cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(t){this.update(1)},update:function(t){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.ActionInstant.extend({update:function(t){this.target.visible=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Hide=cc.ActionInstant.extend({update:function(t){this.target.visible=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.ToggleVisibility=cc.ActionInstant.extend({update:function(t){this.target.visible=!this.target.visible},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.init(t)},update:function(t){this.target.removeFromParent(this._isNeedCleanUp)},init:function(t){return this._isNeedCleanUp=t,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(t){return new cc.RemoveSelf(t)},cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==t&&this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=t,!0},update:function(t){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?1:-1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var t=new cc.FlipX;return t.initWithFlipX(this._flippedX),t}}),cc.flipX=function(t){return new cc.FlipX(t)},cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==t&&this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=t,!0},update:function(t){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedX?1:-1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var t=new cc.FlipY;return t.initWithFlipY(this._flippedY),t}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(t,e){if(cc.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void 0!==t){if(void 0!==t.x)e=t.y,t=t.x;this.initWithPosition(t,e)}},initWithPosition:function(t,e){return this._x=t,this._y=e,!0},update:function(t){this.target.setPosition(this._x,this._y)},clone:function(){var t=new cc.Place;return t.initWithPosition(this._x,this._y),t}}),cc.place=function(t,e){return new cc.Place(t,e)},cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(t,e,i){cc.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){if(t)this._function=t;if(e)this._selectorTarget=e;if(void 0!==i)this._data=i;return!0},execute:function(){if(this._function)this._function.call(this._selectorTarget,this.target,this._data)},update:function(t){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(t){if(t!==this._selectorTarget){if(this._selectorTarget)this._selectorTarget=null;this._selectorTarget=t}},clone:function(){var t=new cc.CallFunc;return t.initWithFunction(this._function,this._selectorTarget,this._data),t}}),cc.callFunc=function(t,e,i){return new cc.CallFunc(t,e,i)}},{}],5:[function(t,e,i){cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(t){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(t)},getElapsed:function(){return this._elapsed},initWithDuration:function(t){return this._duration=0===t?cc.macro.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easeList.length;e++)t._easeList.push(this._easeList[e].reverse())}},clone:function(){var t=new cc.ActionInterval(this._duration);return this._cloneDecoration(t),t},easing:function(t){if(this._easeList)this._easeList.length=0;else this._easeList=[];for(var e=0;e<arguments.length;e++)this._easeList.push(arguments[e]);return this},_computeEaseTime:function(t){var e=this._easeList;if(!e||0===e.length)return t;for(var i=0,n=e.length;n>i;i++)t=e[i].easing(t);return t},step:function(t){if(this._firstTick)this._firstTick=!1,this._elapsed=0;else this._elapsed+=t;var e=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);if(e=1>e?e:1,this.update(e>0?e:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()){if(!this._repeatForever)this._timesForRepeat--;this.startWithTarget(this.target),this.step(this._elapsed-this._duration)}},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.log("cc.IntervalAction: reverse not implemented."),null},setAmplitudeRate:function(t){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){return cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass."),0},speed:function(t){if(0>=t)return cc.log("The speed parameter error"),this;else return this._speedMethod=!0,this._speed*=t,this},getSpeed:function(){return this._speed},setSpeed:function(t){return this._speed=t,this},repeat:function(t){if(t=Math.round(t),isNaN(t)||1>t)return cc.log("The repeat parameter error"),this;else return this._repeatMethod=!0,this._timesForRepeat*=t,this},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return new cc.ActionInterval(t)},cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var e=t instanceof Array?t:arguments,i=e.length-1;if(i>=0&&null==e[i])cc.log("parameters should not be ending with null in Javascript");if(i>=0){for(var n,r=e[0],o=1;i>o;o++)if(e[o])n=r,r=cc.Sequence._actionOneTwo(n,e[o]);this.initWithTwoActions(r,e[i])}},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil");var i=t._duration+e._duration;return this.initWithDuration(i),this._actions[0]=t,this._actions[1]=e,!0},clone:function(){var t=new cc.Sequence;return this._cloneDecoration(t),t.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){if(-1!==this._last)this._actions[this._last].stop();cc.Action.prototype.stop.call(this)},update:function(t){var e,i,n=0,r=this._split,o=this._actions,s=this._last;if(t=this._computeEaseTime(t),r>t){if(e=0!==r?t/r:1,0===n&&1===s)o[1].update(0),o[1].stop()}else{if(n=1,e=1===r?1:(t-r)/(1-r),-1===s)o[0].startWithTarget(this.target),o[0].update(1),o[0].stop();if(!s)o[0].update(1),o[0].stop()}if(i=o[n],s!==n||!i.isDone()){if(s!==n)i.startWithTarget(this.target);e*=i._timesForRepeat,i.update(e>1?e%1:e),this._last=n}},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.sequence=function(t){var e=t instanceof Array?t:arguments;if(e.length>0&&null==e[e.length-1])cc.log("parameters should not be ending with null in Javascript");for(var i,n,r,o;e&&e.length>0;){if(n=Array.prototype.shift.call(e),o=n._timesForRepeat||1,n._repeatMethod=!1,n._timesForRepeat=1,r=0,!i)i=n,r=1;for(r;o>r;r++)i=cc.Sequence._actionOneTwo(i,n)}return i},cc.Sequence._actionOneTwo=function(t,e){var i=new cc.Sequence;return i.initWithTwoActions(t,e),i},cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},initWithAction:function(t,e){var i=t._duration*e;if(this.initWithDuration(i)){if(this._times=e,this._innerAction=t,t instanceof cc.ActionInstant)this._actionInstant=!0,this._times-=1;return this._total=0,!0}return!1},clone:function(){var t=new cc.Repeat;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone(),this._times),t},startWithTarget:function(t){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var e=this._innerAction,i=this._duration,n=this._times,r=this._nextDt;if(t>=r){for(;t>r&&this._total<n;)e.update(1),this._total++,e.stop(),e.startWithTarget(this.target),r+=e._duration/i,this._nextDt=r;if(t>=1&&this._total<n)this._total++;if(!this._actionInstant)if(this._total===n)e.update(1),e.stop();else e.update(t-(r-e._duration/i))}else e.update(t*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var t=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){if(this._innerAction!==t)this._innerAction=t},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(t,e){return new cc.Repeat(t,e)},cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.RepeatForever.initWithAction(): action must be non null");return this._innerAction=t,!0},clone:function(){var t=new cc.RepeatForever;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},step:function(t){var e=this._innerAction;if(e.step(t),e.isDone())e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration)},isDone:function(){return!1},reverse:function(){var t=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){if(this._innerAction!==t)this._innerAction=t},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(t){return new cc.RepeatForever(t)},cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var e=t instanceof Array?t:arguments,i=e.length-1;if(i>=0&&null==e[i])cc.log("parameters should not be ending with null in Javascript");if(i>=0){for(var n,r=e[0],o=1;i>o;o++)if(e[o])n=r,r=cc.Spawn._actionOneTwo(n,e[o]);this.initWithTwoActions(r,e[i])}},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Spawn.initWithTwoActions(): arguments must all be non null");var i=!1,n=t._duration,r=e._duration;if(this.initWithDuration(Math.max(n,r))){if(this._one=t,this._two=e,n>r)this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-r));else if(r>n)this._one=cc.Sequence._actionOneTwo(t,cc.delayTime(r-n));i=!0}return i},clone:function(){var t=new cc.Spawn;return this._cloneDecoration(t),t.initWithTwoActions(this._one.clone(),this._two.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._one.startWithTarget(t),this._two.startWithTarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(t){if(t=this._computeEaseTime(t),this._one)this._one.update(t);if(this._two)this._two.update(t)},reverse:function(){var t=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.spawn=function(t){var e=t instanceof Array?t:arguments;if(e.length>0&&null==e[e.length-1])cc.log("parameters should not be ending with null in Javascript");for(var i=e[0],n=1;n<e.length;n++)if(null!=e[n])i=cc.Spawn._actionOneTwo(i,e[n]);return i},cc.Spawn._actionOneTwo=function(t,e){var i=new cc.Spawn;return i.initWithTwoActions(t,e),i},cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._dstAngleX=e||0,this._dstAngleY=i||this._dstAngleX,!0;else return!1},clone:function(){var t=new cc.RotateTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.rotationX%360,i=this._dstAngleX-e;if(i>180)i-=360;if(-180>i)i+=360;this._startAngleX=e,this._diffAngleX=i,this._startAngleY=t.rotationY%360;var n=this._dstAngleY-this._startAngleY;if(n>180)n-=360;if(-180>n)n+=360;this._diffAngleY=n},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(t){if(t=this._computeEaseTime(t),this.target)this.target.rotationX=this._startAngleX+this._diffAngleX*t,this.target.rotationY=this._startAngleY+this._diffAngleY*t}}),cc.rotateTo=function(t,e,i){return new cc.RotateTo(t,e,i)},cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._angleX=e||0,this._angleY=i||this._angleX,!0;else return!1},clone:function(){var t=new cc.RotateBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._angleX,this._angleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngleX=t.rotationX,this._startAngleY=t.rotationY},update:function(t){if(t=this._computeEaseTime(t),this.target)this.target.rotationX=this._startAngleX+this._angleX*t,this.target.rotationY=this._startAngleY+this._angleY*t},reverse:function(){var t=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.rotateBy=function(t,e,i){return new cc.RotateBy(t,e,i)},cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(cc.ActionInterval.prototype.initWithDuration.call(this,t)){if(void 0!==e.x)i=e.y,e=e.x;return this._positionDelta.x=e,this._positionDelta.y=i,!0}return!1},clone:function(){var t=new cc.MoveBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._positionDelta),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._positionDelta.x*t,i=this._positionDelta.y*t,n=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var r=this.target.getPositionX(),o=this.target.getPositionY(),s=this._previousPosition;n.x=n.x+r-s.x,n.y=n.y+o-s.y,e+=n.x,i+=n.y,s.x=e,s.y=i,this.target.setPosition(e,i)}else this.target.setPosition(n.x+e,n.y+i)}},reverse:function(){var t=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.moveBy=function(t,e,i){return new cc.MoveBy(t,e,i)},cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(t,e,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)){if(void 0!==e.x)i=e.y,e=e.x;return this._endPosition.x=e,this._endPosition.y=i,!0}return!1},clone:function(){var t=new cc.MoveTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition),t},startWithTarget:function(t){cc.MoveBy.prototype.startWithTarget.call(this,t),this._positionDelta.x=this._endPosition.x-t.getPositionX(),this._positionDelta.y=this._endPosition.y-t.getPositionY()}}),cc.moveTo=function(t,e,i){return new cc.MoveTo(t,e,i)},cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;if(cc.ActionInterval.prototype.initWithDuration.call(this,t))this._endSkewX=e,this._endSkewY=i,n=!0;return n},clone:function(){var t=new cc.SkewTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endSkewX,this._endSkewY),t},startWithTarget:function(t){if(cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startSkewX=t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180)this._deltaX-=360;if(this._deltaX<-180)this._deltaX+=360;if(this._startSkewY=t.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180)this._deltaY-=360;if(this._deltaY<-180)this._deltaY+=360},update:function(t){t=this._computeEaseTime(t),this.target.skewX=this._startSkewX+this._deltaX*t,this.target.skewY=this._startSkewY+this._deltaY*t}}),cc.skewTo=function(t,e,i){return new cc.SkewTo(t,e,i)},cc.SkewBy=cc.SkewTo.extend({ctor:function(t,e,i){cc.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;if(cc.SkewTo.prototype.initWithDuration.call(this,t,e,i))this._skewX=e,this._skewY=i,n=!0;return n},clone:function(){var t=new cc.SkewBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._skewX,this._skewY),t},startWithTarget:function(t){cc.SkewTo.prototype.startWithTarget.call(this,t),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var t=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.skewBy=function(t,e,i){return new cc.SkewBy(t,e,i)},cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(t,e,i,n,r){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){if(cc.ActionInterval.prototype.initWithDuration.call(this,t)){if(void 0===r)r=n,n=i,i=e.y,e=e.x;return this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=r,!0}return!1},clone:function(){var t=new cc.JumpBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._delta,this._height,this._jumps),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=t*this._jumps%1,i=4*this._height*e*(1-e);i+=this._delta.y*t;var n=this._delta.x*t,r=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var o=this.target.getPositionX(),s=this.target.getPositionY(),c=this._previousPosition;r.x=r.x+o-c.x,r.y=r.y+s-c.y,n+=r.x,i+=r.y,c.x=n,c.y=i,this.target.setPosition(n,i)}else this.target.setPosition(r.x+n,r.y+i)}},reverse:function(){var t=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.jumpBy=function(t,e,i,n,r){return new cc.JumpBy(t,e,i,n,r)},cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(t,e,i,n,r){
cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){if(cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,r)){if(void 0===r)i=e.y,e=e.x;return this._endPosition.x=e,this._endPosition.y=i,!0}return!1},startWithTarget:function(t){cc.JumpBy.prototype.startWithTarget.call(this,t),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var t=new cc.JumpTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),t}}),cc.jumpTo=function(t,e,i,n,r){return new cc.JumpTo(t,e,i,n,r)},cc.bezierAt=function(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._config=e,!0;else return!1},clone:function(){var t=new cc.BezierBy;this._cloneDecoration(t);for(var e=[],i=0;i<this._config.length;i++){var n=this._config[i];e.push(cc.p(n.x,n.y))}return t.initWithDuration(this._duration,e),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._config,i=0,n=e[0].x,r=e[1].x,o=e[2].x,s=0,c=e[0].y,a=e[1].y,h=e[2].y,l=cc.bezierAt(i,n,r,o,t),u=cc.bezierAt(s,c,a,h,t),f=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var d=this.target.getPositionX(),p=this.target.getPositionY(),_=this._previousPosition;f.x=f.x+d-_.x,f.y=f.y+p-_.y,l+=f.x,u+=f.y,_.x=l,_.y=u,this.target.setPosition(l,u)}else this.target.setPosition(f.x+l,f.y+u)}},reverse:function(){var t=this._config,e=[cc.pAdd(t[1],cc.pNeg(t[2])),cc.pAdd(t[0],cc.pNeg(t[2])),cc.pNeg(t[2])],i=new cc.BezierBy(this._duration,e);return this._cloneDecoration(i),this._reverseEaseList(i),i}}),cc.bezierBy=function(t,e){return new cc.BezierBy(t,e)},cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(t,e){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._toConfig=e,!0;else return!1},clone:function(){var t=new cc.BezierTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toConfig),t},startWithTarget:function(t){cc.BezierBy.prototype.startWithTarget.call(this,t);var e=this._startPosition,i=this._toConfig,n=this._config;n[0]=cc.pSub(i[0],e),n[1]=cc.pSub(i[1],e),n[2]=cc.pSub(i[2],e)}}),cc.bezierTo=function(t,e){return new cc.BezierTo(t,e)},cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._endScaleX=e,this._endScaleY=null!=i?i:e,!0;else return!1},clone:function(){var t=new cc.ScaleTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startScaleX=t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){if(t=this._computeEaseTime(t),this.target)this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t}}),cc.scaleTo=function(t,e,i){return new cc.ScaleTo(t,e,i)},cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var t=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.ScaleBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t}}),cc.scaleBy=function(t,e,i){return new cc.ScaleBy(t,e,i)},cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._times=e,!0;else return!1},clone:function(){var t=new cc.Blink;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._times),t},update:function(t){if(t=this._computeEaseTime(t),this.target&&!this.isDone()){var e=1/this._times,i=t%e;this.target.opacity=i>e/2?255:0}},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.opacity},stop:function(){this.target.opacity=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._toOpacity=e,!0;else return!1},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(t){if(cc.FadeTo.prototype.ctor.call(this),null==t)t=0;this.initWithDuration(t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){if(this._reverseAction)this._toOpacity=this._reverseAction._fromOpacity;cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeOut=cc.FadeTo.extend({ctor:function(t){if(cc.FadeTo.prototype.ctor.call(this),null==t)t=0;this.initWithDuration(t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._to=cc.color(e,i,n),!0;else return!1},clone:function(){var t=new cc.TintTo;this._cloneDecoration(t);var e=this._to;return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;if(e)this.target.setColor(cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t))}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){if(cc.ActionInterval.prototype.initWithDuration.call(this,t))return this._deltaR=e,this._deltaG=i,this._deltaB=n,!0;else return!1},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.color;this._fromR=e.r,this._fromG=e.g,this._fromB=e.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.DelayTime=cc.ActionInterval.extend({update:function(t){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ReverseTime.initWithAction(): action must be non null");if(t===this._other)throw new Error("cc.ReverseTime.initWithAction(): the action was already passed in.");if(cc.ActionInterval.prototype.initWithDuration.call(this,t._duration))return this._other=t,!0;else return!1},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){if(t=this._computeEaseTime(t),this._other)this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],t&&this.initWithAnimation(t)},getAnimation:function(){return this._animation},setAnimation:function(t){this._animation=t},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(t){if(!t)throw new Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var e=t.getDuration();if(this.initWithDuration(e*t.getLoops())){this._nextFrame=0,this.setAnimation(t),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,r=e/t.getTotalDelayUnits(),o=t.getFrames();cc.js.array.verifyType(o,cc.AnimationFrame);for(var s=0;s<o.length;s++){var c=o[s],a=n*r/e;n+=c.getDelayUnits(),i.push(a)}return!0}return!1},clone:function(){var t=new cc.Animate;return this._cloneDecoration(t),t.initWithAnimation(this._animation.clone()),t},startWithTarget:function(t){if(cc.ActionInterval.prototype.startWithTarget.call(this,t),this._animation.getRestoreOriginalFrame())this._origFrame=t.displayFrame();this._nextFrame=0,this._executedLoops=0},update:function(t){if(t=this._computeEaseTime(t),1>t){t*=this._animation.getLoops();var e=0|t;if(e>this._executedLoops)this._nextFrame=0,this._executedLoops++;t%=1}for(var i=this._animation.getFrames(),n=i.length,r=this._splitTimes,o=this._nextFrame;n>o&&r[o]<=t;o++)_currFrameIndex=o,this.target.setSpriteFrame(i[_currFrameIndex].getSpriteFrame()),this._nextFrame=o+1},reverse:function(){var t=this._animation,e=t.getFrames(),i=[];if(cc.js.array.verifyType(e,cc.AnimationFrame),e.length>0)for(var n=e.length-1;n>=0;n--){var r=e[n];if(!r)break;i.push(r.clone())}var o=new cc.SpriteFrameAnimation(i,t.getDelayPerUnit(),t.getLoops());o.setRestoreOriginalFrame(t.getRestoreOriginalFrame());var s=new cc.Animate(o);return this._cloneDecoration(s),this._reverseEaseList(s),s},stop:function(){if(this._animation.getRestoreOriginalFrame()&&this.target)this.target.setSpriteFrame(this._origFrame);cc.Action.prototype.stop.call(this)}}),cc.animate=function(t){return new cc.Animate(t)},cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){if(this.initWithDuration(e._duration))return this._forcedTarget=t,this._action=e,!0;else return!1},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){if(this._forcedTarget!==t)this._forcedTarget=t}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)}},{}],6:[function(t,e,i){t("./CCAction.js"),t("./CCActionInterval.js"),t("./CCActionInstant.js"),t("./CCActionEase.js")},{"./CCAction.js":2,"./CCActionEase.js":3,"./CCActionInstant.js":4,"./CCActionInterval.js":5}],7:[function(t,e,i){function n(t,e){a.call(this,t),this.animation=e}function r(t,e,i,n){i=i.clone();for(var r=i,o=e+1,s=t.indexOf(".",o);-1!==s;){var c=t.slice(o,s);r=r[c],o=s+1,s=t.indexOf(".",o)}var a=t.slice(o);return r[a]=n,i}function o(t){var e=t.split(".");return e.shift(),e.length>0?e:null}function s(t,e){function i(t){if(!Array.isArray(t))return!1;for(var e=0,i=t.length;i>e;e++){var n=t[e];if(!Array.isArray(n)||6!==n.length)return!1}return!0}function n(t,n,r){var c,c,a=t instanceof cc.Node&&"position"===n,f=[];if(a)c=new l;else c=new h;c.target=t;var d,p,_=n.indexOf("."),g=-1!==_;if(g)d=n.slice(0,_),p=t[d];else d=n;c.prop=d,c.subProps=o(n);for(var v=0,m=r.length;m>v;v++){var y=r[v],b=y.frame/e.duration;if(c.ratios.push(b),a){var T=y.motionPath;if(T&&!i(T))cc.error("motion path of target ["+t.name+"] in prop ["+n+"] frame ["+v+"] is not valid"),T=null;f.push(T)}var C=y.value;c.values.push(C);var A=y.curve;if(A)if("string"==typeof A){c.types.push(A);continue}else if(Array.isArray(A)){if(A[0]===A[1]&&A[2]===A[3])c.types.push(h.Linear);else c.types.push(h.Bezier(A));continue}c.types.push(h.Linear)}if(a)u(f,c,s.duration,s.sample);return c}function r(t,e){var i=e.props,r=e.comps;if(i)for(var o in i){var s=i[o],a=n(t,o,s);c.push(a)}if(r)for(var h in r){var l=t.getComponent(h);if(l){var u=r[h];for(var o in u){var s=u[o],a=n(l,o,s);c.push(a)}}else;}}var s=e.clip,c=e.curves;if(c.length=0,e.duration=s.duration,e.speed=s.speed,e.wrapMode=s.wrapMode,e.frameRate=s.sample,(e.wrapMode&p.Loop)===p.Loop)e.repeatCount=1/0;else e.repeatCount=1;var a=s.events;if(a)for(var g,v=0,m=a.length;m>v;v++){if(!g)g=new f,g.target=t,c.push(g);var y,b=a[v],T=b.frame/e.duration,C=_(g.ratios,T);if(C>=0)y=g.events[C];else y=new d,g.ratios.push(T),g.events.push(y);y.add(b.func,b.params)}var A=s.curveData,S=A.paths;r(t,A);for(var E in S){var x=cc.find(E,t);if(x){var O=S[E];r(x,O)}else;}}var c=cc.js,a=t("./animators").Animator,h=t("./animation-curves").DynamicAnimCurve,l=t("./animation-curves").SampledAnimCurve,u=t("./motion-path-helper").sampleMotionPaths,f=t("./animation-curves").EventAnimCurve,d=t("./animation-curves").EventInfo,p=t("./types").WrapModeMask,_=t("./binary-search");c.extend(n,a);var g=n.prototype;if(g.playState=function(t,e){if(t.clip){if(!t.curveLoaded)s(this.target,t);if(this.addAnimation(t),t.animator=this,t.play(),"number"==typeof e)t.time=e;this.play()}},g.removeAnimation=function(t){a.prototype.removeAnimation.call(this,t),t.animator=null},g.sample=function(){for(var t=this.playingAnims,e=0;e<t.length;e++){var i=t[e];i.sample()}},g.stopState=function(t){if(t)t.stop()},g.pauseState=function(t){if(t)t.pause()},g.resumeState=function(t){if(t)t.resume();if(this.isPaused)this.resume()},g.setStateTime=function(t,e){if(t)t.setTime(e)},g.onStop=function(){for(var t=this.playingAnims,e=t.length-1;e>=0;e--)t[e].stop();a.prototype.onStop.call(this)},g.onPause=function(){for(var t=this.playingAnims,e=0,i=t.length;i>e;e++)t[e].pause()},g.onResume=function(){for(var t=this.playingAnims,e=0,i=t.length;i>e;e++)t[e].resume()},g._reloadClip=function(t){s(this.target,t)},!1)cc._Test.createBatchedProperty=r;if(!1)cc._Test.initClipData=s;e.exports=n},{"./animation-curves":9,"./animators":12,"./binary-search":14,"./motion-path-helper":17,"./types":19}],8:[function(t,e,i){var n=cc.Class({name:"cc.AnimationClip","extends":cc.Asset,properties:{_duration:{"default":0,type:"Float"},duration:{get:function(){return this._duration}},sample:{"default":60},speed:{"default":1},wrapMode:{"default":cc.WrapMode.Normal},curveData:{"default":{},visible:!1},events:{"default":[],visible:!1}}});cc.AnimationClip=e.exports=n},{}],9:[function(t,e,i){function n(t,e){if("string"==typeof e){var i=cc.Easing[e];if(i)t=i(t);else cc.error("Can't find easing type ["+e+"]")}else if(Array.isArray(e))t=r(e,t);return t}var r=t("./bezier").bezierByTime,o=t("./binary-search"),s=t("./types").WrapModeMask,c=cc.Class({name:"cc.AnimCurve",sample:function(t,e,i){},onTimeChangedManually:function(){}}),a=cc.Class({name:"cc.DynamicAnimCurve","extends":c,properties:{target:null,prop:"",values:[],ratios:[],types:[],subProps:null},_calcValue:function(t,e){var i,n=this.values,r=n[t-1],o=n[t];if("number"==typeof r)i=r+(o-r)*e;else{var s=r.lerp;if(s)i=r.lerp(o,e);else i=r}return i},_applyValue:function(t,e,i){t[e]=i},_findFrameIndex:o,sample:function(t,e,i){var r=this.values,o=this.ratios,s=o.length;if(0!==s){var c,a=this._findFrameIndex(o,e);if(0>a)if(a=~a,0>=a)c=r[0];else if(a>=s)c=r[s-1];else{var h=o[a-1],l=o[a],u=this.types[a-1],f=(e-h)/(l-h);f=n(f,u),c=this._calcValue(a,f)}else c=r[a];var d=this.subProps;if(d){for(var p=this.target[this.prop],_=p,g=0;g<d.length-1;g++){var v=d[g];if(_)_=_[v];else return}var m=d[d.length-1];if(_)this._applyValue(_,m,c);else return;c=p}this._applyValue(this.target,this.prop,c)}}});a.Linear=null,a.Bezier=function(t){return t};var h=cc.Class({name:"cc.SampledAnimCurve","extends":a,_findFrameIndex:function(t,e){var i=t.length-1;if(0===i)return 0;var n=t[0];if(n>e)return 0;var r=t[i];if(e>r)return i;e=(e-n)/(r-n);var o=1/i,s=e/o,c=0|s,a=1e-6;if(a>s-c)return c;else return~(c+1)}}),l=function(){this.events=[]};l.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})};var u=cc.Class({name:"cc.EventAnimCurve","extends":c,properties:{target:null,ratios:[],events:[],_lastWrappedInfo:null},_wrapIterations:function(t){if(t-(0|t)===0)t-=1;return 0|t},sample:function(t,e,i){var n=this.ratios.length,r=i.getWrappedInfo(i.time),c=r.direction,a=o(this.ratios,r.ratio);if(0>a)if(a=~a-1,0>c)a+=1;var h=this._lastWrappedInfo;if(r.frameIndex=a,this._lastWrappedInfo=r,!h)return void this._fireEvent(a);var l=h.frameIndex,u=i.wrapMode,f=this._wrapIterations(r.iterations),d=this._wrapIterations(h.iterations),p=-1!==d&&f!==d;if(l===a&&p&&1===n)this._fireEvent(0);else if(l!==a||p){c=h.direction;do{if(l!==a){if(-1===c&&0===l&&a>0){if((u&s.PingPong)===s.PingPong)c*=-1;else l=n;d++}else if(1===c&&l===n-1&&n-1>a){if((u&s.PingPong)===s.PingPong)c*=-1;else l=-1;d++}if(l===a)break;if(d>f)break}l+=c,this._fireEvent(l)}while(l!==a&&l>-1&&n>l)}},_fireEvent:function(t){if(!(0>t||t>=this.events.length))for(var e=this.events[t],i=e.events,n=this.target._components,r=0;r<i.length;r++)for(var o=i[r],s=o.func,c=0;c<n.length;c++){var a=n[c],h=a[s];if(h)h.apply(a,o.params)}},onTimeChangedManually:function(){this._lastWrappedInfo=null}});if(!1)cc._Test.DynamicAnimCurve=a,cc._Test.SampledAnimCurve=h,cc._Test.EventAnimCurve=u;e.exports={AnimCurve:c,DynamicAnimCurve:a,SampledAnimCurve:h,EventAnimCurve:u,EventInfo:l,computeRatioByType:n}},{"./bezier":13,"./binary-search":14,"./types":19}],10:[function(t,e,i){var n=(cc.js,cc.Class({ctor:function(){this.animators=[],this.__instanceId=cc.ClassManager.getNewInstanceId(),this._updating=!1,this._removeList=[]},update:function(t){this._updating=!0;var e,i,n=this.animators;for(e=0,i=n.length;i>e;e++){var r=n[e];if(r._isPlaying&&!r._isPaused)r.update(t)}this._updating=!1;var o=this._removeList;for(e=0,i=o.length;i>e;e++)this.removeAnimator(o[e]);o.length=0},destruct:function(){},addAnimator:function(t){var e=this.animators.indexOf(t);if(-1===e)this.animators.push(t);if(e=this._removeList.indexOf(t),-1!==e)this._removeList.splice(e,1)},removeAnimator:function(t){var e=this.animators.indexOf(t);if(e>=0)if(this._updating){var i=this._removeList;if(-1===i.indexOf(t))i.push(t)}else this.animators.splice(e,1);else cc.error("animator not added or already removed")}}));cc.AnimationManager=e.exports=n},{}],11:[function(t,e,i){function n(t,e){o.call(this,null,null,{duration:t.length}),this._clip=t,this._name=e||t.name}var r=cc.js,o=t("./types").AnimationNode;r.extend(n,o);var s=n.prototype;r.get(s,"clip",function(){return this._clip}),r.get(s,"name",function(){return this._name}),r.obsolete(s,"AnimationState.length","duration"),r.getset(s,"curveLoaded",function(){return this.curves.length>0},function(){this.curves.length=0}),s.onPlay=function(){this.setTime(0)},s.onStop=function(){if(this.animator)this.animator.removeAnimation(this)},s.setTime=function(t){this.time=t||0,this.curves.forEach(function(t){t.onTimeChangedManually()})},cc.AnimationState=e.exports=n},{"./types":19}],12:[function(t,e,i){function n(t){this.target=t,this.playingAnims=[],this._updating=!1,this._removeList=[]}function r(t){n.call(this,t)}function o(t){for(var e=0,i=0,n=t.length,r=0;n>r;r++){var o=t[r],s=o.ratio;if(0===r&&"number"!=typeof s)o.computedRatio=s=0;else if(r===n-1&&"number"!=typeof s)o.computedRatio=s=1;if("number"==typeof s){if(r>e+1)for(var c=r-e,a=(s-i)/c,h=e+1;r>h;h++)i+=a,t[h].computedRatio=i;e=r,i=s}}}function s(t,e,i){for(var n,r=0;r<t.length;r++)if(n=t[r],n.target===e&&n.prop===i)return n;return null}function c(t,e,i,n,r){var o=s(t,e,i);if(!o)o=new u,t.push(o),o.target=e,o.prop=i;o.values.push(n),o.ratios.push(r)}var a=cc.js,h=t("./playable"),l=t("./types").AnimationNode,u=t("./animation-curves").DynamicAnimCurve;a.extend(n,h);var f=n.prototype;f.update=function(t){this._updating=!0;var e,i,n=this.playingAnims,r=0;for(e=0,i=n.length;i>e;e++){var o=n[e];if(o._isPlaying&&!o._isPaused)if(o.update(t),!o._isPlaying)r++}if(this._updating=!1,0===n.length||r>=n.length)this.stop();var s=this._removeList;for(e=0,i=s.length;i>e;e++)this.removeAnimation(s[e]);s.length=0},f.onPlay=function(){cc.director.getAnimationManager().addAnimator(this)},f.onStop=function(){cc.director.getAnimationManager().removeAnimator(this)},f.addAnimation=function(t){var e=this.playingAnims.indexOf(t);if(-1===e)this.playingAnims.push(t);if(e=this._removeList.indexOf(t),-1!==e)this._removeList.splice(e,1)},f.removeAnimation=function(t){var e=this.playingAnims.indexOf(t);if(e>=0)if(this._updating){var i=this._removeList;if(-1===i.indexOf(t))i.push(t)}else this.playingAnims.splice(e,1);else cc.error("animation not added or already removed")},a.extend(r,n);var d=r.prototype;if(!1)cc._Test.computeNullRatios=o;if(d.animate=function(t,e){if(!t)return cc.error("[animate] keyFrames must be non-nil"),null;o(t);var i=this._doAnimate(t,e);return this.play(),i},d._doAnimate=function(t,e){var i=new l(this,null,e);i.play();for(var n=i.curves,r=-1,o=0;o<t.length;o++){var s=t[o],a=s.ratio;if("number"!=typeof a)a=s.computedRatio;if(!(0>a))if(!(r>a)){r=a;for(var h in s){var u=s[h];if("props"===h)for(var f in u)c(n,this.target,f,u[f],a);else if("comps"===h)for(var d in u){var p=this.target.getComponent(d),_=u[d];for(var f in _)c(n,p,f,_[f],a)}}}else cc.error("[animate] ratio should in the order of smallest to largest!");else cc.error("[animate] ratio should >= 0!")}return this.playingAnims.push(i),i},!1)cc._Test.EntityAnimator=r;e.exports={Animator:n,EntityAnimator:r}},{"./animation-curves":9,"./playable":18,"./types":19}],13:[function(t,e,i){function n(t,e,i,n,r){var o=1-r;return t*o*o*o+3*e*o*o*r+3*i*o*r*r+n*r*r*r}function r(t){if(0>t)return-Math.pow(-t,1/3);else return Math.pow(t,1/3)}function o(t,e){var i,n,o,s,l,d=e-0,p=e-t[0],_=e-t[2],g=e-1,v=3*d,m=3*p,y=3*_,b=-d+m-y+g,T=1/b,C=1/3,A=(v-6*p+y)*T,S=A*C,E=(-v+m)*T,x=d*T,O=(3*E-A*A)*C,N=O*C,I=(2*A*A*A-9*A*E+27*x)/27,w=I/2,P=w*w+N*N*N;if(0>P){var L=-O*C,R=L*L*L,F=f(R),M=-I/(2*F),B=-1>M?-1:M>1?1:M,D=a(B),z=r(F),j=2*z;if(o=j*c(D*C)-S,s=j*c((D+u)*C)-S,l=j*c((D+2*u)*C)-S,o>=0&&1>=o)if(s>=0&&1>=s)if(l>=0&&1>=l)return h(o,s,l);else return h(o,s);else if(l>=0&&1>=l)return h(o,l);else return o;else if(s>=0&&1>=s)if(l>=0&&1>=l)return h(s,l);else return s;else return l}else if(0===P)if(i=0>w?r(-w):-r(w),o=2*i-S,s=-i-S,o>=0&&1>=o)if(s>=0&&1>=s)return h(o,s);else return o;else return s;else{var W=f(P);return i=r(-w+W),n=r(w+W),o=i-n-S}}function s(t,e){var i=o(t,e),n=0,r=t[1],s=t[3],c=1,a=1-i;return n*a*a*a+3*r*i*a*a+3*s*i*i*a+c*i*i*i}var c=Math.cos,a=Math.acos,h=Math.max,l=Math.PI,u=2*l,f=Math.sqrt;if(!1)cc._Test.bezier=n,cc._Test.bezierByTime=s;e.exports={bezier:n,bezierByTime:s}},{}],14:[function(t,e,i){function n(t,e){for(var i=0,n=t.length-1;n>=i;){var o=i+n>>1;if(Math.abs(t[o]-e)<r)return o;if(t[o]>e)n=o-1;else i=o+1}return~i}var r=1e-6;e.exports=n},{}],15:[function(t,e,i){function n(t,e){return function(i){if(.5>i)return e(2*i)/2;else return t(2*i-1)/2+.5}}var r={linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){if((t*=2)<1)return.5*t*t;else return-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){if((t*=2)<1)return.5*t*t*t;else return.5*((t-=2)*t*t+2)},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){if((t*=2)<1)return.5*t*t*t*t;else return-.5*((t-=2)*t*t*t-2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},quintInOut:function(t){if((t*=2)<1)return.5*t*t*t*t*t;else return.5*((t-=2)*t*t*t*t+2)},sineIn:function(t){return 1-Math.cos(t*Math.PI/2)},sineOut:function(t){return Math.sin(t*Math.PI/2)},sineInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},expoIn:function(t){return 0===t?0:Math.pow(1024,t-1)},expoOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){if(0===t)return 0;if(1===t)return 1;if((t*=2)<1)return.5*Math.pow(1024,t-1);else return.5*(-Math.pow(2,-10*(t-1))+2)},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},circInOut:function(t){if((t*=2)<1)return-.5*(Math.sqrt(1-t*t)-1);else return.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1,n=.4;if(0===t)return 0;if(1===t)return 1;if(!i||1>i)i=1,e=n/4;else e=n*Math.asin(1/i)/(2*Math.PI);return-(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n))},elasticOut:function(t){var e,i=.1,n=.4;if(0===t)return 0;if(1===t)return 1;if(!i||1>i)i=1,e=n/4;else e=n*Math.asin(1/i)/(2*Math.PI);return i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1},elasticInOut:function(t){var e,i=.1,n=.4;if(0===t)return 0;if(1===t)return 1;if(!i||1>i)i=1,e=n/4;else e=n*Math.asin(1/i)/(2*Math.PI);if((t*=2)<1)return-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n));else return i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;if((t*=2)<1)return.5*(t*t*((e+1)*t-e));else return.5*((t-=2)*t*((e+1)*t+e)+2)},bounceOut:function(t){if(1/2.75>t)return 7.5625*t*t;else if(2/2.75>t)return 7.5625*(t-=1.5/2.75)*t+.75;else if(2.5/2.75>t)return 7.5625*(t-=2.25/2.75)*t+.9375;else return 7.5625*(t-=2.625/2.75)*t+.984375},smooth:function(t){if(0>=t)return 0;if(t>=1)return 1;else return t*t*(3-2*t)},fade:function(t){if(0>=t)return 0;if(t>=1)return 1;else return t*t*t*(t*(6*t-15)+10)}};r.quadOutIn=n(r.quadIn,r.quadOut),r.cubicOutIn=n(r.cubicIn,r.cubicOut),r.quartOutIn=n(r.quartIn,r.quartOut),r.quintOutIn=n(r.quintIn,r.quintOut),r.sineOutIn=n(r.sineIn,r.sineOut),r.expoOutIn=n(r.expoIn,r.expoOut),r.circOutIn=n(r.circIn,r.circOut),r.backOutIn=n(r.backIn,r.backOut),r.backOutIn=n(r.backIn,r.backOut),r.bounceIn=function(t){return 1-r.bounceOut(1-t)},r.bounceInOut=function(t){if(.5>t)return.5*r.bounceIn(2*t);else return.5*r.bounceOut(2*t-1)+.5},r.bounceOutIn=n(r.bounceIn,r.bounceOut),cc.Easing=e.exports=r},{}],16:[function(t,e,i){t("./bezier"),t("./easing"),t("./types"),t("./motion-path-helper"),t("./animation-curves"),t("./animation-clip"),t("./animators"),t("./animation-manager"),t("./animation-state"),t("./animation-animator")},{"./animation-animator":7,"./animation-clip":8,"./animation-curves":9,"./animation-manager":10,"./animation-state":11,"./animators":12,"./bezier":13,"./easing":15,"./motion-path-helper":17,"./types":19}],17:[function(t,e,i){function n(t){this.points=t||[],this.beziers=[],this.ratios=[],this.progresses=[],this.length=0,this.computeBeziers()}function r(){this.start=l(),this.end=l(),this.startCtrlPoint=l(),this.endCtrlPoint=l()}function o(t,e,i,r){function o(t){if(t instanceof cc.Vec2)return{"in":t,pos:t,out:t};else if(Array.isArray(t)&&6===t.length)return{"in":l(t[2],t[3]),pos:l(t[0],t[1]),out:l(t[4],t[5])};return{"in":cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}function a(t,e,i){p.push(t),_.push(e),g.push(i)}var u=e.values;if(0!==t.length&&0!==u.length){if(u=u.map(function(t){return l(t[0],t[1])}),1===u.length)return void(e.values=u);for(var f=e.types,d=e.ratios,p=e.values=[],_=e.types=[],g=e.ratios=[],v=0,m=1e-6,y=0,b=t.length;b-1>y;y++){var T,C=t[y],A=d[y],S=d[y+1],E=S-A,x=u[y],O=u[y+1],N=f[y],I=[],w=v/E,P=1/(E*i*r);if(C&&C.length>0){var L=[];L.push(o(x));for(var R=0,F=C.length;F>R;R++){var M=o(C[R]);L.push(M)}L.push(o(O));var B=new n(L);B.computeBeziers();for(var D=B.progresses;1-w>m;){T=w,T=c(T,N);var z,j,W,k;if(0>T)j=B.beziers[0],k=(0-T)*j.getLength(),W=j.start.sub(j.endCtrlPoint).normalize(),z=j.start.add(W.mul(k));else if(T>1)j=B.beziers[B.beziers.length-1],k=(T-1)*j.getLength(),W=j.end.sub(j.startCtrlPoint).normalize(),z=j.end.add(W.mul(k));else{var U=h(D,T);if(0>U)U=~U;T-=U>0?D[U-1]:0,T/=B.ratios[U],z=B.beziers[U].getPointAt(T)}I.push(z),w+=P}}else for(;1-w>m;)T=w,T=c(T,N),I.push(x.lerp(O,T)),w+=P;for(var R=0,F=I.length;F>R;R++){var V=A+v+P*R*E;a(I[R],s.Linear,V)}if(Math.abs(w-1)>m)v=(w-1)*E;else v=0}if(d[d.length-1]!==g[g.length-1])a(u[u.length-1],s.Linear,d[d.length-1])}}var s=t("./animation-curves").DynamicAnimCurve,c=t("./animation-curves").computeRatioByType,a=t("./bezier").bezier,h=t("./binary-search"),l=cc.v2;if(n.prototype.computeBeziers=function(){this.beziers.length=0,this.ratios.length=0,this.progresses.length=0,this.length=0;for(var t,e=1;e<this.points.length;e++){var i=this.points[e-1],n=this.points[e];t=new r,t.start=i.pos,t.startCtrlPoint=i.out,t.end=n.pos,t.endCtrlPoint=n["in"],this.beziers.push(t),this.length+=t.getLength()}for(var o=0,e=0;e<this.beziers.length;e++)t=this.beziers[e],this.ratios[e]=t.getLength()/this.length,this.progresses[e]=o+=this.ratios[e];return this.beziers},r.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},r.prototype.getPoint=function(t){var e=a(this.start.x,this.startCtrlPoint.x,this.endCtrlPoint.x,this.end.x,t),i=a(this.start.y,this.startCtrlPoint.y,this.endCtrlPoint.y,this.end.y,t);
return new l(e,i)},r.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},r.prototype.getLengths=function(t){if(!t)t=this.__arcLengthDivisions?this.__arcLengthDivisions:200;if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1)return this.cacheArcLengths;var e,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;t>=i;i++)e=this.getPoint(i/t),o+=cc.pDistance(e,r),n.push(o),r=e;return this.cacheArcLengths=n,n},r.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),r=0,o=n.length;if(e)i=e;else i=t*n[o-1];for(var s,c=0,a=o-1;a>=c;)if(r=Math.floor(c+(a-c)/2),s=n[r]-i,!(0>s))if(s>0){a=r-1;continue}else{a=r;break}else c=r+1;if(r=a,n[r]===i){var h=r/(o-1);return h}var l=n[r],u=n[r+1],f=u-l,d=(i-l)/f,h=(r+d)/(o-1);return h},!1)cc._Test.sampleMotionPaths=o;e.exports={sampleMotionPaths:o,Curve:n,Bezier:r}},{"./animation-curves":9,"./bezier":13,"./binary-search":14}],18:[function(t,e,i){function n(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var r=cc.js,o=n.prototype;r.get(o,"isPlaying",function(){return this._isPlaying},!0),r.get(o,"isPaused",function(){return this._isPaused},!0);var s=function(){};o.onPlay=s,o.onPause=s,o.onResume=s,o.onStop=s,o.onError=s,o.play=function(){if(this._isPlaying)if(this._isPaused)this._isPaused=!1,this.onResume();else this.onError("already-playing");else this._isPlaying=!0,this.onPlay()},o.stop=function(){if(this._isPlaying)this._isPlaying=!1,this._isPaused=!1,this.onStop()},o.pause=function(){this._isPaused=!0,this.onPause()},o.resume=function(){this._isPaused=!1,this.onResume()},o.step=function(){if(this.pause(),this._stepOnce=!0,!this._isPlaying)this.play()},e.exports=n},{}],19:[function(t,e,i){function n(t,e,i){if(a.call(this),this.animator=t,this.curves=e||[],this.delay=0,this.repeatCount=1,this.duration=1,this.speed=1,this.wrapMode=c.Normal,i){this.delay=i.delay||this.delay;var n=i.duration;if("undefined"!=typeof n)this.duration=n;var r=i.speed;if("undefined"!=typeof r)this.speed=r;var o=i.wrapMode;if("undefined"!=typeof o){var h="number"==typeof o;if(h)this.wrapMode=o;else this.wrapMode=c[o]}var l=i.repeatCount;if("undefined"!=typeof l)this.repeatCount=l;else if(this.wrapMode&s.Loop)this.repeatCount=1/0}if(this.time=0,this._timeNoScale=0,this._firstFramePlayed=!1,this._duringDelay=!1,this.delay>0)this._duringDelay=!0}var r=cc.js,o=t("./playable"),s={Loop:2,ShouldWrap:4,PingPong:22,Reverse:36},c=cc.Enum({Default:0,Normal:1,Reverse:s.Reverse,Loop:s.Loop,LoopReverse:s.Loop|s.Reverse,PingPong:s.PingPong,PingPongReverse:s.PingPong|s.Reverse});cc.WrapMode=c;var a=function(){o.call(this)};r.extend(a,o),a.prototype.update=function(t){},r.extend(n,a),r.mixin(n.prototype,{update:function(t){if(this._duringDelay)if(this._timeNoScale+=t,this._timeNoScale<this.delay)return;else this._duringDelay=!1;if(this._firstFramePlayed)this.time+=t*this.speed;else this._firstFramePlayed=!0;if(this.sample())this.stop()},_needRevers:function(t){var e=this.wrapMode,i=!1;if((e&s.PingPong)===s.PingPong){var n=t-(0|t)===0;if(n&&t>0)t-=1;var r=1&t;if(r)i=!i}if((e&s.Reverse)===s.Reverse)i=!i;return i},getWrappedInfo:function(t){var e=!1,i=this.duration,n=0,r=this.wrapMode,o=Math.abs(t/i);if(o>this.repeatCount)o=this.repeatCount;var c=!1;if(r&s.ShouldWrap)c=this._needRevers(o);var a=c?-1:1;if(this.speed<0)a*=-1;if(o>=this.repeatCount){e=!0;var h=this.repeatCount-(0|this.repeatCount);if(0===h)h=1;t=h*i*(t>0?1:-1)}if(t>i){var l=t%i;t=0===l?i:l}else if(0>t)if(t%=i,0!==t)t+=i;if(r&s.ShouldWrap)if(c)t=i-t;return n=t/i,{ratio:n,time:t,direction:a,stopped:e,iterations:o}},sample:function(){for(var t=this.getWrappedInfo(this.time),e=this.curves,i=0,n=e.length;n>i;i++){var r=e[i];r.sample(t.time,t.ratio,this)}return t.stopped}}),cc.AnimationNode=n,e.exports={WrapModeMask:s,WrapMode:c,AnimationNode:n}},{"./playable":18}],20:[function(t,e,i){"use strict";function n(t){if(!t)return cc.error("getComponent: Type must be non-nil"),null;if("string"==typeof t)return h.getClassByName(t);else return t}function r(t,e){for(var i=0;i<t._components.length;++i){var n=t._components[i];if(n instanceof e)return n}return null}function o(t,e,i){for(var n=0;n<t._components.length;++n){var r=t._components[n];if(r instanceof e)i.push(r)}}function s(t,e){for(var i=0;i<t.length;++i){var n=t[i],o=r(n,e);if(o)return o;else if(n.children.length>0)if(o=s(n.children,e))return o}return null}function c(t,e,i){for(var n=0;n<t.length;++n){var r=t[n];if(o(r,e,i),r._children.length>0)c(r._children,e,i)}}var a=t("./event/event-target"),h=cc.js,l=cc.Object.Flags,u=l.Destroying,f=l.DontDestroy,d=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel"}),p=[d.TOUCH_START,d.TOUCH_MOVE,d.TOUCH_END,d.TOUCH_CANCEL],_=[d.MOUSE_DOWN,d.MOUSE_ENTER,d.MOUSE_MOVE,d.MOUSE_LEAVE,d.MOUSE_UP,d.MOUSE_WHEEL],g=null,v=function(t,e){var i=t.getLocation(),n=this.owner;if(n._hitTest(i,this))return e.type=d.TOUCH_START,e.touch=t,e.bubbles=!0,n.dispatchEvent(e),!0;else return!1},m=function(t,e){var i=this.owner;e.type=d.TOUCH_MOVE,e.touch=t,e.bubbles=!0,i.dispatchEvent(e)},y=function(t,e){var i=t.getLocation(),n=this.owner;if(n._hitTest(i,this))e.type=d.TOUCH_END;else e.type=d.TOUCH_CANCEL;e.touch=t,e.bubbles=!0,n.dispatchEvent(e)},b=function(t){var e=t.getLocation(),i=this.owner;if(i._hitTest(e,this))t.type=d.MOUSE_DOWN,i.dispatchEvent(t),t.stopPropagation()},T=function(t){var e=t.getLocation(),i=this.owner;if(i._hitTest(e,this)){if(t.stopPropagation(),!this._previousIn){if(g)t.type=d.MOUSE_LEAVE,g.owner.dispatchEvent(t),g._previousIn=!1;g=this,t.type=d.MOUSE_ENTER,i.dispatchEvent(t),this._previousIn=!0}t.type=d.MOUSE_MOVE,i.dispatchEvent(t)}else if(this._previousIn)t.type=d.MOUSE_LEAVE,i.dispatchEvent(t),this._previousIn=!1,g=null},C=function(t){var e=t.getLocation(),i=this.owner;if(i._hitTest(e,this))t.type=d.MOUSE_UP,i.dispatchEvent(t),t.stopPropagation()},A=function(t){var e=t.getLocation(),i=this.owner;if(i._hitTest(e,this))t.type=d.MOUSE_WHEEL,i.dispatchEvent(t)},S=function(t){if(cc.Mask)for(var e=0,i=null,n=t;n&&n instanceof cc.Node;n=n.parent,++e)if(i=n.getComponent(cc.Mask))return{index:e,node:n};return null},E=cc.Class({name:"cc.Node","extends":t("./utils/base-node"),mixins:[a],properties:{active:{get:function(){return this._active},set:function(t){if(t=!!t,this._active!==t){this._active=t;var e=this._parent&&this._parent._activeInHierarchy;if(e)this._onActivatedInHierarchy(t),this.emit("active-in-hierarchy-changed",this)}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}},_active:!0,_components:[],_prefab:{"default":null,editorOnly:!0},_persistNode:{get:function(){return(this._objFlags&f)>0},set:function(t){if(t)this._objFlags|=f;else this._objFlags&=~f}}},ctor:function(){var t=arguments[0];if(this._name="undefined"!=typeof t?t:"New Node",this._activeInHierarchy=!1,this.__instanceId=this._id||cc.ClassManager.getNewInstanceId(),this._widget=null,this._touchListener=null,this._mouseListener=null,this.__eventTargets=[],cc.sys.isNative)this._retainedActions=[]},statics:{_DirtyFlags:t("./utils/misc").DirtyFlags},destroy:function(){if(cc.Object.prototype.destroy.call(this))if(this._activeInHierarchy)this._deactivateChildComponents()},_onPreDestroy:function(){var t,e;this._objFlags|=u;var i=this._parent,n=i&&i._objFlags&u;if(!n)if(!1)this._registerIfAttached(!1);var r=this._children;for(t=0,e=r.length;e>t;++t)r[t]._destroyImmediate();for(t=0,e=this._components.length;e>t;++t){var o=this._components[t];o._destroyImmediate()}for(this.stopAllActions(),this._releaseAllActions(),cc.eventManager.removeListeners(this),t=0,e=this.__eventTargets.length;e>t;++t){var s=this.__eventTargets[t];s&&s.targetOff(this)}if(this.__eventTargets.length=0,this._persistNode)cc.game.removePersistRootNode(this);if(!n){if(i){var c=i._children.indexOf(this);i._children.splice(c,1),i.emit("child-removed",this)}if(this._removeSgNode(),!1)this._parent=null}else this._sgNode.release()},getComponent:function(t){var e=n(t);if(e)return r(this,e);else return null},getComponents:function(t){var e=n(t),i=[];if(e)o(this,e,i);return i},getComponentInChildren:function(t){var e=n(t);if(e)return s(this._children,e);else return null},getComponentsInChildren:function(t){var e=n(t),i=[];if(e)c(this._children,e,i);return i},_checkMultipleComp:!1,addComponent:function(t){if(this._objFlags&u,!1)return cc.error("isDestroying"),null;var e;if("string"==typeof t){if(e=h.getClassByName(t),!e){if(cc.error('addComponent: Failed to get class "%s"',t),cc._RFpeek())cc.error('addComponent: Should not add component ("%s") when the scripts are still loading.',t);return null}}else{if(!t)return cc.error("addComponent: Type must be non-nil"),null;e=t}if("function"!=typeof e)return cc.error("addComponent: The component to add must be a constructor"),null;if(!cc.isChildClassOf(e,cc.Component))return cc.error("addComponent: The component to add must be child class of cc.Component"),null;if(e._disallowMultiple,!1)if(!this._checkMultipleComp(e))return null;var i=e._requireComponent;if(i&&!this.getComponent(i)){var n=this.addComponent(i);if(!n)return null}var r=new e;if(r.node=this,this._components.push(r),this._activeInHierarchy)r.__onNodeActivated(!0);return r},_addComponentAt:!1,removeComponent:function(t){if(!t)return void cc.error("removeComponent: Component must be non-nil");if("object"!=typeof t)t=this.getComponent(t);if(t)t.destroy()},_getDependComponent:!1,_removeComponent:function(t){if(!t)return void cc.error("Argument must be non-nil");if(!(this._objFlags&u)){var e=this._components.indexOf(t);if(-1!==e)this._components.splice(e,1);else if(t.node!==this)cc.error("Component not owned by this entity")}},_registerIfAttached:!1,_onActivatedInHierarchy:function(t){this._activeInHierarchy=t;for(var e=this._components.length,i=0;e>i;++i){var n=this._components[i];if(!(n instanceof cc.Component)){if(!1)cc.error('Sorry, the component of "%s" which with an index of %s is corrupted! It has been removed.',this.name,i),console.log("Corrupted component value:",n);if(n)this._removeComponent(n);else this._components.splice(i,1);--i,--e}else n.__onNodeActivated(t)}for(var r=0,o=this.childrenCount;o>r;++r){var s=this._children[r];if(s._active)s._onActivatedInHierarchy(t)}if(t)cc.director.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this);else cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this)},_onHierarchyChanged:function(t){var e=this._parent;if(this._persistNode&&!(e instanceof cc.Scene))if(cc.game.removePersistRootNode(this),!1)cc.warn('Set "%s" to normal node (not persist root node).');var i=this._active&&!(!t||!t._activeInHierarchy),n=this._active&&!(!e||!e._activeInHierarchy);if(i!==n)this._onActivatedInHierarchy(n);if(!1){var r=cc.director.getScene(),o=t&&t.isChildOf(r),s=e&&e.isChildOf(r);if(!o&&s)this._registerIfAttached(!0);else if(o&&!s)this._registerIfAttached(!1);var c=e&&e._prefab&&e._prefab.root,a=this._prefab;if(a){if(c)_Scene.PrefabUtils.linkPrefab(c._prefab.asset,c,this);else if(a.root!==this)_Scene.PrefabUtils.unlinkPrefab(this)}else if(c)_Scene.PrefabUtils.linkPrefab(c._prefab.asset,c,this);_Scene.DetectConflict.afterAddChild(this)}},_deactivateChildComponents:function(){for(var t=this._components.length,e=0;t>e;++e){var i=this._components[e];i.__onNodeActivated(!1)}for(var n=0,r=this.childrenCount;r>n;++n){var o=this._children[n];if(o._active)o._deactivateChildComponents()}},_instantiate:function(){var t=cc.instantiate._clone(this,this);if(t._parent=null,false)this._name+=" (Clone)";return t._onBatchCreated(),t},_onColorChanged:function(){for(var t=0;t<this._components.length;++t){var e=this._components[t];if(e instanceof cc._SGComponent&&e.isValid&&e._sgNode)if(e._sgNode.setColor(this._color),!this._cascadeOpacityEnabled)e._sgNode.setOpacity(this._opacity)}},_onCascadeChanged:function(){for(var t=this._cascadeOpacityEnabled?255:this._opacity,e=0;e<this._components.length;++e){var i=this._components[e];if(i instanceof cc._SGComponent&&i.isValid&&i._sgNode)i._sgNode.setOpacity(t)}},_onAnchorChanged:function(){for(var t=0;t<this._components.length;++t){var e=this._components[t];if(e instanceof cc._SGComponent&&e.isValid&&e._sgNode)e._sgNode.setAnchorPoint(this._anchorPoint),e._sgNode.ignoreAnchorPointForPosition(this.__ignoreAnchor)}},_onOpacityModifyRGBChanged:function(){for(var t=0;t<this._components.length;++t){var e=this._components[t];if(e instanceof cc._SGComponent&&e.isValid&&e._sgNode)e._sgNode.setOpacityModifyRGB(this._opacityModifyRGB)}},on:function(t,e,i){if(-1!==p.indexOf(t)){if(!this._touchListener)this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this,mask:S(this),onTouchBegan:v,onTouchMoved:m,onTouchEnded:y}),this._touchListener.retain(),cc.eventManager.addListener(this._touchListener,this)}else if(-1!==_.indexOf(t))if(!this._mouseListener)this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:S(this),onMouseDown:b,onMouseMove:T,onMouseUp:C,onMouseScroll:A}),this._mouseListener.retain(),cc.eventManager.addListener(this._mouseListener,this);a.prototype.on.call(this,t,e,i)},off:function(t,e,i){if(a.prototype.off.call(this,t,e,i),-1!==p.indexOf(t))this._checkTouchListeners();else if(-1!==_.indexOf(t))this._checkMouseListeners()},targetOff:function(t){a.prototype.targetOff.call(this,t),this._checkTouchListeners(),this._checkMouseListeners()},_checkTouchListeners:function(){if(!(this._objFlags&u)&&this._bubblingListeners&&this._touchListener){for(var t=0;t<p.length;++t)if(this._bubblingListeners.has(p[t]))return;cc.eventManager.removeListener(this._touchListener),this._touchListener=null}},_checkMouseListeners:function(){if(!(this._objFlags&u)&&this._bubblingListeners&&this._mouseListener){for(var t=0;t<_.length;++t)if(this._bubblingListeners.has(_[t]))return;cc.eventManager.removeListener(this._mouseListener),this._mouseListener=null}},_hitTest:function(t,e){var i=this.width,n=this.height,r=cc.rect(0,0,i,n),o=this.getNodeToWorldTransform();cc._rectApplyAffineTransformIn(r,o);var s=t.x-r.x,c=r.x+r.width-t.x,a=t.y-r.y,h=r.y+r.height-t.y;if(s>=0&&c>=0&&h>=0&&a>=0)if(e&&e.mask){for(var l=e.mask,u=this,f=0;u&&f<l.index;++f,u=u.parent);if(u===l.node)return u._hitTest(t);else return e.mask=null,!0}else return!0;else return!1},_getBubblingTargets:function(t,e){for(var i=this.parent;i;){if(i.hasEventListener(t))e.push(i);i=i.parent}},isRunning:function(){return this._activeInHierarchy},runAction:function(t){if(this.active){if(cc.assert(t,cc._LogInfos.Node.runAction),cc.sys.isNative)this._retainAction(t),this._sgNode._owner=this;return cc.director.getActionManager().addAction(t,this,!1),t}},stopAllActions:function(){cc.director.getActionManager().removeAllActionsFromTarget(this)},stopAction:function(t){cc.director.getActionManager().removeAction(t)},stopActionByTag:function(t){if(t===cc.Action.TAG_INVALID)return void cc.log(cc._LogInfos.Node.stopActionByTag);else return void cc.director.getActionManager().removeActionByTag(t,this)},getActionByTag:function(t){if(t===cc.Action.TAG_INVALID)return cc.log(cc._LogInfos.Node.getActionByTag),null;else return void cc.director.getActionManager().getActionByTag(t,this)},getNumberOfRunningActions:function(){cc.director.getActionManager().numberOfRunningActionsInTarget(this)},_retainAction:function(t){if(cc.sys.isNative&&t instanceof cc.Action&&-1===this._retainedActions.indexOf(t))this._retainedActions.push(t),t.retain()},_releaseAllActions:function(){if(cc.sys.isNative){for(var t=0;t<this._retainedActions.length;++t)this._retainedActions[t].release();this._retainedActions.length=0}}});if(cc.sys.isNative)cc.js.getset(E.prototype,"_sgNode",function(){return this.__sgNode},function(t){if(this.__sgNode=t,this._touchListener)this._touchListener.retain(),cc.eventManager.removeListener(this._touchListener),cc.eventManager.addListener(this._touchListener,this),this._touchListener.release();if(this._mouseListener)this._mouseListener.retain(),cc.eventManager.removeListener(this._mouseListener),cc.eventManager.addListener(this._mouseListener,this),this._mouseListener.release()},!0);E.EventType=d,cc.Node=e.exports=E},{"./event/event-target":56,"./utils/base-node":89,"./utils/misc":91}],21:[function(t,e,i){var n=function(){};if(cc.Scene=cc.Class({name:"cc.Scene","extends":t("./utils/base-node"),ctor:function(){var t=this._sgNode=new _ccsg.Scene;t.retain(),t.setAnchorPoint(0,0),this._anchorPoint.x=0,this._anchorPoint.y=0,this._activeInHierarchy=!1,this._inited=!cc.game._isCloning},destroy:function(){for(var t=this._children,e=cc.Object.Flags.DontDestroy,i=0,n=t.length;n>i;++i){var r=t[i];if(r.isValid)if(!(r._objFlags&e))r.destroy()}this._super(),this._activeInHierarchy=!1},_onHierarchyChanged:n,_onColorChanged:n,_onAnchorChanged:n,_onOpacityModifyRGBChanged:n,_onCascadeChanged:n,_load:function(){if(!this._inited)this._onBatchCreated(),this._inited=!0},_activate:function(t){t=t!==!1;var e,i,n=this._children,r=n.length;if(!1)for(e=0;r>e;++e)i=n[e],i._registerIfAttached(t);for(this._activeInHierarchy=t,e=0;r>e;++e)if(i=n[e],i._active)i._onActivatedInHierarchy(t)}}),e.exports=cc.Scene,!1){var r='"%s" is not defined in the Scene, it is only defined in child nodes.';Object.defineProperties(cc.Scene.prototype,{active:{get:function(){return cc.error(r,"active"),!0},set:function(){cc.error(r,"active")}},activeInHierarchy:{get:function(){return cc.error(r,"activeInHierarchy"),!0}},getComponent:{get:function(){return cc.error(r,"getComponent"),function(){return null}}},addComponent:{get:function(){return cc.error(r,"addComponent"),function(){return null}}}})}},{"./utils/base-node":89}],22:[function(t,e,i){var n=t("./CCRawAsset");cc.Asset=cc.Class({name:"cc.Asset","extends":n,properties:{rawUrl:{get:function(){if(this._rawFiles)if(cc.AssetLibrary)return cc.AssetLibrary.getImportedDir(this._uuid)+"/"+this._uuid+"/"+this._rawFiles[0];else cc.error("asset.url is not usable in core process");return""},visible:!1},rawUrls:{get:function(){if(this._rawFiles)if(cc.AssetLibrary){var t=cc.AssetLibrary.getImportedDir(this._uuid)+"/"+this._uuid+"/";return this._rawFiles.map(function(e){return t+e})}else cc.error("asset.urls is not usable in core process");return[]},visible:!1},_rawFiles:void 0},statics:{deserialize:function(t){return cc.deserialize(t)}},serialize:function(){return Editor.serialize(this)},createNode:null,_setRawFiles:function(t){this._rawFiles=t.length>0?t:void 0}}),e.exports=cc.Asset},{"./CCRawAsset":27}],23:[function(t,e,i){var n=cc.Class({name:"cc.AudioClip","extends":cc.RawAsset});cc.AudioClip=n,e.exports=n},{}],24:[function(t,e,i){var n=cc.Class({name:"cc.BitmapFont","extends":cc.Font});cc.BitmapFont=n,e.exports=n},{}],25:[function(t,e,i){var n=cc.Class({name:"cc.Font","extends":cc.RawAsset});cc.Font=n,e.exports=n},{}],26:[function(t,e,i){var n=cc.Class({name:"cc.Prefab","extends":cc.Asset,properties:{data:null},createNode:function(t){if(!1){var e=cc.instantiate(this);t(null,e)}},_instantiate:function(){var t=cc.instantiate(this.data);if(!1)_Scene.PrefabUtils.linkPrefab(this,t);return t}});cc.Prefab=e.exports=n,cc.js.obsolete(cc,"cc._Prefab","Prefab")},{}],27:[function(t,e,i){var n=t("../platform/CCObject");cc.RawAsset=cc.Class({name:"cc.RawAsset","extends":n,ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0,enumerable:!1})},statics:{createNodeByInfo:null,isRawAssetType:function(t){return cc.isChildClassOf(t,cc.RawAsset)&&!cc.isChildClassOf(t,cc.Asset)}}}),e.exports=cc.RawAsset},{"../platform/CCObject":70}],28:[function(t,e,i){var n=cc.Class({name:"cc.SceneAsset","extends":cc.Asset,properties:{scene:null}});cc.SceneAsset=n,e.exports=n},{}],29:[function(t,e,i){var n=cc.Class({name:"cc.Script","extends":cc.Asset});cc._Script=n;var r=cc.Class({name:"cc.JavaScript","extends":n});cc._JavaScript=r;var o=cc.Class({name:"cc.CoffeeScript","extends":n});cc._CoffeeScript=o},{}],30:[function(t,e,i){var n=cc.Class({name:"cc.SpriteAtlas","extends":cc.Asset,properties:{_spriteFrames:{"default":{}}},getTexture:function(){var t=Object.keys(this._spriteFrames);if(t.length>0){var e=this._spriteFrames[t[0]];return e?e.getTexture():null}else return null},getSpriteFrame:function(t){return this._spriteFrames[t]}});cc.SpriteAtlas=n,e.exports=n},{}],31:[function(t,e,i){var n=cc.Class({name:"cc.TTFFont","extends":cc.Font});cc.TTFFont=n,e.exports=n},{}],32:[function(t,e,i){t("./CCRawAsset"),t("./CCAsset"),t("./CCFont"),t("./CCPrefab"),t("./CCAudioClip"),t("./CCBitmapFont"),t("./CCScripts"),t("./CCSceneAsset"),t("../sprites/CCSpriteFrame"),t("../textures/CCTexture2D"),t("./CCTTFFont"),t("./CCSpriteAtlas")},{"../sprites/CCSpriteFrame":134,"../textures/CCTexture2D":134,"./CCAsset":22,"./CCAudioClip":23,"./CCBitmapFont":24,"./CCFont":25,"./CCPrefab":26,"./CCRawAsset":27,"./CCSceneAsset":28,"./CCScripts":29,"./CCSpriteAtlas":30,"./CCTTFFont":31}],33:[function(t,e,i){function n(t){if(t instanceof cc.Scene)return!1?cc.engine.getDesignResolutionSize():cc.visibleRect;else if(!t._sizeProvider||t._sizeProvider instanceof _ccsg.Node)return t._contentSize;else return t.getContentSize()}function r(t,e){var i,r,o,s,c=t._parent,a=n(c),h=a.width,l=a.height,u=c._anchorPoint;if(c instanceof cc.Scene){var f=cc.visibleRect;i=f.left.x,r=f.right.x,s=f.bottom.y,o=f.top.y}else i=-u.x*h,r=i+h,s=-u.y*l,o=s+l;i+=e._isAbsLeft?e._left:e._left*h,r-=e._isAbsRight?e._right:e._right*h,s+=e._isAbsBottom?e._bottom:e._bottom*l,o-=e._isAbsTop?e._top:e._top*l;var d,p=t.getAnchorPoint(),_=t._position.x,g=p.x;if(e.isStretchWidth)d=r-i,t.width=d,_=i+g*d;else if(d=t.width,e.isAlignHorizontalCenter){var v=(.5-u.x)*h;_=v+(g-.5)*d}else if(e.isAlignLeft)_=i+g*d;else if(e.isAlignRight)_=r+g*d-d;var m,y=t._position.y,b=p.y;if(e.isStretchHeight)m=o-s,t.height=m,y=s+b*m;else if(m=t.height,e.isAlignVerticalCenter){var T=(.5-u.y)*l;y=T+(b-.5)*m}else if(e.isAlignBottom)y=s+b*m;else if(e.isAlignTop)y=o+b*m-m;t.setPosition(_,y)}function o(t){var e=t._widget;if(e)if(r(t,e),e.isAlignOnce)e.enabled=!1;for(var i=t._children,n=0;n<i.length;n++){var s=i[n];if(s._active)o(s)}}function s(){var t=cc.director.getScene();if(t)h.isAligning=!0,o(t),h.isAligning=!1}var c=!1,a=!1,h=cc._widgetManager={isAligning:!1,init:function(t){t.on(cc.Director.EVENT_BEFORE_VISIT,s)},add:function(t){if(t.node._widget=t,false)t.node.on("position-changed",c,t),t.node.on("size-changed",a,t)},remove:function(t){if(t.node._widget=null,false)t.node.off("position-changed",c,t),t.node.off("size-changed",a,t)},_getParentSize:n}},{}],34:[function(t,e,i){function n(t,e){if(t===e)return!0;else return t&&e&&(t.name===e.name||t._uuid===e._uuid)}var r=t("../../animation/animation-animator"),o=t("../../animation/animation-clip"),s=cc.Class({name:"cc.Animation","extends":t("./CCComponent"),editor:!1,ctor:function(){this._animator=null,this._nameToState={},this._didInit=!1,this._currentClip=null},properties:{_defaultClip:{"default":null,type:o},defaultClip:{type:o,get:function(){return this._defaultClip},set:function(t){cc.engine;if(!1)if(this._defaultClip=t,t){for(var e=this._clips,i=0,r=e.length;r>i;i++)if(n(t,e[i]))return;this.addClip(t)}},tooltip:"i18n:COMPONENT.animation.default_clip"},currentClip:{get:function(){return this._currentClip},set:function(t,e){if(this._currentClip=t,false)this._updateClip(t)},type:o,visible:!1},_clips:{"default":[],type:[o],tooltip:"i18n:COMPONENT.animation.clips",visible:!0},playOnLoad:{"default":!1,tooltip:"i18n:COMPONENT.animation.play_on_load"}},onLoad:function(){if(1)if(this._init(),this.playOnLoad&&this._defaultClip){var t=this.getAnimationState(this._defaultClip.name);this._animator.playState(t)}},onEnable:function(){this.resume()},onDisable:function(){this.pause()},getClips:function(){return this._clips},play:function(t,e){for(var i=this.playAdditive(t,e),n=this._animator.playingAnims,r=n.length;r>=0;r--)if(n[r]!==i)this._animator.stopState(n[r]);else;return i},playAdditive:function(t,e){this._init();var i=this.getAnimationState(t||this._defaultClip.name);if(i){var n=this._animator;if(n.isPlaying&&i.isPlaying)if(i.isPaused)n.resumeState(i);else n.stopState(i),n.playState(i,e);else n.playState(i,e);this.currentClip=i.clip}return i},stop:function(t){if(this._didInit)if(t){var e=this._nameToState[t];if(e)this._animator.stopState(e)}else this._animator.stop()},pause:function(t){if(this._didInit)if(t){var e=this._nameToState[t];if(e)this._animator.pauseState(e)}else this._animator.pause()},resume:function(t){if(this._didInit)if(t){var e=this._nameToState[t];if(e)this._animator.resumeState(e)}else this._animator.resume()},setCurrentTime:function(t,e){if(this._init(),e){var i=this._nameToState[e];if(i)this._animator.setStateTime(i,t)}else for(var e in this._nameToState)i=this._nameToState[e],this._animator.setStateTime(i,t)},getAnimationState:function(t){this._init();var e=this._nameToState[t];if(false){if(this._didInit=!1,this.animator)this.animator.stop();this._init(),e=this._nameToState[t]}if(e&&!e.curveLoaded)this._animator._reloadClip(e);return e||null},addClip:function(t,e){if(!t)return void cc.warn("Invalid clip to add");if(this._init(),!cc.js.array.contains(this._clips,t))this._clips.push(t);e=e||t.name;var i=this._nameToState[e];if(i)if(i.clip===t)return i;else{var n=this._clips.indexOf(i.clip);if(-1!==n)this._clips.splice(n,1)}var r=new cc.AnimationState(t,e);return this._nameToState[e]=r,r},_removeStateIfNotUsed:function(t,e){var i=t.clip!==this._defaultClip&&!cc.js.array.contains(this._clips,t.clip);if(e||i){if(t.isPlaying)this.stop(t.name);delete this._nameToState[t.name]}},removeClip:function(t,e){if(!t)return void cc.warn("Invalid clip to remove");this._init(),this._clips=this._clips.filter(function(e){return e!==t});var i;for(var n in this._nameToState){i=this._nameToState[n];var r=i.clip;if(r===t)this._removeStateIfNotUsed(i,e)}},sample:function(){this._init(),this._animator.sample()},_init:function(){if(!this._didInit)this._didInit=!0,this._animator=new r(this.node,this),this._createStates()},_createStates:function(){for(var t=null,e=!1,i=0;i<this._clips.length;++i){var r=this._clips[i];if(r){if(t=new cc.AnimationState(r),!1)this._animator._reloadClip(t);if(this._nameToState[t.name]=t,n(this._defaultClip,r))e=t}}if(this._defaultClip&&!e){if(t=new cc.AnimationState(this._defaultClip),!1)this._animator._reloadClip(t);this._nameToState[t.name]=t}},_updateClip:!1});cc.Animation=e.exports=s},{"../../animation/animation-animator":7,"../../animation/animation-clip":8,"./CCComponent":38}],35:[function(t,e,i){var n=cc.audioEngine,r=cc.Class({name:"cc.AudioSource","extends":t("./CCComponent"),editor:!1,ctor:function(){this.audio=null},properties:{_clip:{"default":"",url:cc.AudioClip},_volume:1,_mute:!1,_loop:!1,isPlaying:{get:function(){return!cc.sys.isNative&&this.audio&&this.audio.getPlaying()},visible:!1},clip:{get:function(){return this._clip},set:function(t){this._clip=t},url:cc.AudioClip,tooltip:"i18n:COMPONENT.audio.clip",animatable:!1},volume:{get:function(){return this._volume},set:function(t){if(this._volume=t,this.audio)if(cc.sys.isNative)cc.audioEngine.setEffectsVolume(t);else this.audio.setVolume(t)},tooltip:"i18n:COMPONENT.audio.volume"},mute:{get:function(){return this._mute},set:function(t){if(this._mute=t,this.audio)if(this._mute)if(cc.sys.isNative)cc.audioEngine.setEffectsVolume(0);else this.audio.setVolume(0);else if(cc.sys.isNative)cc.audioEngine.setEffectsVolume(this._volume);else this.audio.setVolume(this._volume)},animatable:!1,tooltip:"i18n:COMPONENT.audio.mute"},loop:{get:function(){return this._loop},set:function(t){if(this._loop=t,this.audio)this.audio.loop=this._loop},animatable:!1,tooltip:"i18n:COMPONENT.audio.loop"},playOnLoad:{"default":!1,tooltip:"i18n:COMPONENT.audio.play_on_load",animatable:!1}},onEnable:function(){if(this.playOnLoad)this.play()},onDisable:function(){this.stop()},onDestroy:function(){this.stop()},play:function(){if(this._clip){var t=this._mute?0:this._volume;if(cc.sys.isNative)n.playEffect(this._clip,this._loop),cc.audioEngine.setEffectsVolume(t);else this.audio=n.playEffect(this._clip,this._loop),this.audio.setVolume(t)}},stop:function(){if(this.audio)cc.audioEngine.stopEffect(this.audio)},pause:function(){if(this.audio)cc.audioEngine.pauseEffect(this.audio)},resume:function(){if(this.audio)cc.audioEngine.resumeEffect(this.audio)},rewind:function(){if(this.audio)cc.audioEngine.stopEffect(this.audio),cc.audioEngine.playEffect(this.audio)}});cc.AudioSource=e.exports=r},{"./CCComponent":38}],36:[function(t,e,i){var n=cc.Enum({NONE:0,COLOR:1,SPRITE:2}),r=cc.Class({name:"cc.Button","extends":t("./CCComponent"),ctor:function(){this._pressed=!1,this._hovered=!1,this._sprite=null,this._fromColor=null,this._toColor=null,this._time=0,this._transitionFinished=!0},editor:!1,properties:{interactable:{"default":!0,tooltip:"i18n:COMPONENT.button.interactable",notify:function(){this._updateState()},animatable:!1},transition:{"default":n.NONE,tooltip:"i18n:COMPONENT.button.transition",type:n,animatable:!1},normalColor:{"default":cc.color(214,214,214),displayName:"Normal",tooltip:"i18n:COMPONENT.button.normal_color",notify:function(){this._updateState()}},pressedColor:{"default":cc.color(211,211,211),displayName:"Pressed",tooltip:"i18n:COMPONENT.button.pressed_color"},hoverColor:{"default":cc.Color.WHITE,displayName:"Hover",tooltip:"i18n:COMPONENT.button.hover_color"},disabledColor:{"default":cc.color(124,124,124),displayName:"Disabled",tooltip:"i18n:COMPONENT.button.diabled_color",notify:function(){this._updateState()}},duration:{"default":.1,range:[0,10],tooltip:"i18n:COMPONENT.button.duration"},normalSprite:{"default":null,type:cc.SpriteFrame,displayName:"Normal",tooltip:"i18n:COMPONENT.button.normal_sprite",notify:function(){this._updateState()}},pressedSprite:{"default":null,type:cc.SpriteFrame,displayName:"Pressed",tooltip:"i18n:COMPONENT.button.pressed_sprite"},hoverSprite:{"default":null,type:cc.SpriteFrame,displayName:"Hover",tooltip:"i18n:COMPONENT.button.hover_sprite"},disabledSprite:{"default":null,type:cc.SpriteFrame,displayName:"Disabled",tooltip:"i18n:COMPONENT.button.disabled_sprite",notify:function(){this._updateState()}},target:{"default":null,type:cc.Node,tooltip:"i18n:COMPONENT.button.target",notify:function(){this._applyTarget()}},clickEvents:{"default":[],type:cc.Component.EventHandler,tooltip:"i18n:COMPONENT.button.click_events"}},statics:{Transition:n},onLoad:function(){if(!this.target)this.target=this.node},onEnable:function(){if(1)this._registerEvent();else this.node.on("spriteframe-changed",function(t){if(this.transition===n.SPRITE)this.normalSprite=t.detail.spriteFrame}.bind(this))},start:function(){this._applyTarget(),this._updateState()},update:function(t){var e=this.target;if(!this.transition!==n.COLOR&&e&&!this._transitionFinished){this.time+=t;var i=this.time/this.duration;if(i>1)i=1,this._transitionFinished=!0;e.color=this._fromColor.lerp(this._toColor,i)}},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_cancelButtonClick:function(){this._pressed=!1},_applyTarget:function(){var t=this.target;if(t)this._sprite=t.getComponent(cc.Sprite);else this._sprite=null},_onTouchBegan:function(t){if(this.interactable&&this.enabledInHierarchy)this._pressed=!0,this._updateState()},_onTouchMove:function(t){if(this.interactable&&this.enabledInHierarchy){var e,i=t.touch,n=this.node._hitTest(i.getLocation());if(n)e="pressed";else e="normal";var r=this[e+"Color"],o=this[e+"Sprite"];this._applyTransition(r,o)}
},_onTouchEnded:function(){if(this.interactable&&this.enabledInHierarchy){if(this._pressed)cc.Component.EventHandler.emitEvents(this.clickEvents);this._pressed=!1,this._updateState()}},_onTouchCancel:function(){if(this.interactable&&this.enabledInHierarchy)this._pressed=!1,this._updateState()},_onMouseMoveIn:function(t){if(!this._pressed&&this.interactable&&this.enabledInHierarchy)if(!this._hovered)this._hovered=!0,this._updateState()},_onMouseMoveOut:function(){if(this._hovered)this._hovered=!1,this._updateState()},_updateState:function(){var t;if(!this.interactable)t="disabled";else if(this._pressed)t="pressed";else if(this._hovered)t="hover";else t="normal";var e=this[t+"Color"],i=this[t+"Sprite"];this._applyTransition(e,i)},onDisable:function(){if(this._hovered=!1,this._pressed=!1,1)this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this);else this.node.off("spriteframe-changed")},_applyTransition:function(t,e){var i=this.transition;if(i===n.COLOR){var r=this.target;if(!1)r.color=t;else this._fromColor=r.color.clone(),this._toColor=t,this.time=0,this._transitionFinished=!1}else if(i===n.SPRITE&&this._sprite&&e)this._sprite.spriteFrame=e}});cc.Button=e.exports=r},{"./CCComponent":38}],37:[function(t,e,i){var n={getContentSize:function(){return!1?cc.engine.getDesignResolutionSize():cc.visibleRect},setContentSize:function(t){},_getWidth:function(){return this.getContentSize().width},_getHeight:function(){return this.getContentSize().height}},r=cc.Class({name:"cc.Canvas","extends":t("./CCComponent"),editor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},set:function(t){this._designResolution.width=t.width,this._designResolution.height=t.height,this.applySettings()},tooltip:"i18n:COMPONENT.canvas.design_resolution"},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(t){if(this._fitHeight!==t)this._fitHeight=t,this.applySettings()},tooltip:"i18n:COMPONENT.canvas.fit_height"},fitWidth:{get:function(){return this._fitWidth},set:function(t){if(this._fitWidth!==t)this._fitWidth=t,this.applySettings()},tooltip:"i18n:COMPONENT.canvas.fit_width"}},ctor:function(){this._thisOnResized=this.onResized.bind(this)},onLoad:function(){var t=cc.Object.Flags;if(this._objFlags|=t.IsPositionLocked|t.IsAnchorLocked|t.IsSizeLocked,r.instance)return cc.error("Can't init canvas '%s' because it conflicts with the existing '%s', the scene should only have one active canvas at the same time",this.node.name,r.instance.node.name);if(r.instance=this,!this.node._sizeProvider)this.node._sizeProvider=n;else cc.error("CCCanvas: Node can only have one size.");if(cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),!1)cc.engine.on("design-resolution-changed",this._thisOnResized);else if(!cc.sys.isNative)if(cc.sys.isMobile)window.addEventListener("resize",this._thisOnResized);else cc.eventManager.addCustomListener("canvas-resize",this._thisOnResized);this.applySettings(),this.onResized()},onDestroy:function(){if(this.node._sizeProvider===n)this.node._sizeProvider=null;if(cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),!1)cc.engine.off("design-resolution-changed",this._thisOnResized);else if(!cc.sys.isNative)if(cc.sys.isMobile)window.removeEventListener("resize",this._thisOnResized);else cc.eventManager.removeCustomListeners("canvas-resize",this._thisOnResized);if(r.instance===this)r.instance=null},alignWithScreen:function(){var t;if(!1)t=cc.engine.getDesignResolutionSize(),this.node.setPosition(.5*t.width,.5*t.height);else{var e=cc.visibleRect,i=!this.fitHeight&&!this.fitWidth,n=0,r=0;if(i)t=cc.view.getDesignResolutionSize(),n=.5*(t.width-e.width),r=.5*(t.height-e.height);this.node.setPosition(.5*e.width+n,.5*e.height+r)}},onResized:function(){this.alignWithScreen()},applySettings:function(){var t,e=cc.ResolutionPolicy;if(this.fitHeight&&this.fitWidth)t=e.SHOW_ALL;else if(!this.fitHeight&&!this.fitWidth)t=e.NO_BORDER;else if(this.fitWidth)t=e.FIXED_WIDTH;else t=e.FIXED_HEIGHT;var i=this._designResolution;if(!1)cc.engine.setDesignResolutionSize(i.width,i.height);else cc.view.setDesignResolutionSize(i.width,i.height,t)}});cc.Canvas=e.exports=r},{"./CCComponent":38}],38:[function(t,e,i){function n(t,e){if(!1)if(!cc.engine.isPlaying&&!t.constructor._executeInEditMode)return;var i=t._objFlags&c;if(e){if(!i){if(t.onEnable)if(!1)f(t);else t.onEnable();cc.director.getScheduler().resumeTarget(t),r(t,!0),t._objFlags|=c}}else if(i){if(t.onDisable)if(!1)d(t);else t.onDisable();cc.director.getScheduler().pauseTarget(t),r(t,!1),t._objFlags&=~c}}function r(t,e){if(!0){if(e&&t.start&&!(t._objFlags&l))cc.director.once(cc.Director.EVENT_BEFORE_UPDATE,y,t);if(t.update)if(e)cc.director.on(cc.Director.EVENT_COMPONENT_UPDATE,b,t);else cc.director.off(cc.Director.EVENT_COMPONENT_UPDATE,b,t);if(t.lateUpdate)if(e)cc.director.on(cc.Director.EVENT_COMPONENT_LATE_UPDATE,T,t);else cc.director.off(cc.Director.EVENT_COMPONENT_LATE_UPDATE,T,t)}}t("../platform/CCObject"),t("../CCNode");var o=t("../platform/id-generater"),s=cc.Object.Flags,c=s.IsOnEnableCalled,a=s.IsOnLoadStarted,h=s.IsOnLoadCalled,l=s.IsOnStartCalled,u=!1;if(!1)u="(function call_FUNC_InTryCatch (c) { c._FUNC_() })";var f=!1,d=!1,p=!1,_=!1,g=!1,v=!1,m=!1,y=!1?function(){_(this),this._objFlags|=l}:function(){this.start(),this._objFlags|=l},b=!1?function(t){try{this.update(t.detail)}catch(e){cc._throw(e)}}:function(t){this.update(t.detail)},T=!1?function(t){try{this.lateUpdate(t.detail)}catch(e){cc._throw(e)}}:function(t){this.lateUpdate(t.detail)},C=new o("Comp"),A=cc.Class({name:"cc.Component","extends":cc.Object,ctor:function(){if(false)_Scene.AssetsWatcher.initComponent(this);Object.defineProperty(this,"_id",{value:"",enumerable:!1}),this.__instanceId=cc.ClassManager.getNewInstanceId()},properties:{node:{"default":null,visible:!1},name:{get:function(){if(this._name)return this._name;var t=cc.js.getClassName(this),e=t.lastIndexOf(".");if(e>=0)t=t.slice(e+1);return this.node.name+"<"+t+">"},set:function(t){this._name=t},visible:!1},_id:{"default":"",serializable:!1},uuid:{get:function(){var t=this._id;if(!t)if(t=this._id=C.getNewId(),!1)cc.engine.attachedObjsForEditor[t]=this;return t},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(t){if(this._enabled!==t)if(this._enabled=t,this.node._activeInHierarchy)n(this,t)},visible:!1},enabledInHierarchy:{get:function(){return this._enabled&&this.node._activeInHierarchy},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&h}},__eventTargets:{"default":[],serializable:!1}},update:null,lateUpdate:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,addComponent:function(t){return this.node.addComponent(t)},getComponent:function(t){return this.node.getComponent(t)},getComponents:function(t){return this.node.getComponents(t)},getComponentInChildren:function(t){return this.node.getComponentInChildren(t)},getComponentsInChildren:function(t){return this.node.getComponentsInChildren(t)},_getLocalBounds:null,onRestore:null,destroy:function(){if(!1){var t=this.node._getDependComponent(this);if(t)return cc.error("Can't remove '%s' because '%s' depends on it.",cc.js.getClassName(this),cc.js.getClassName(t))}if(this._super())if(this._enabled&&this.node._activeInHierarchy)n(this,!1)},__onNodeActivated:!1?function(t){if(!(this._objFlags&a)&&(cc.engine._isPlaying||this.constructor._executeInEditMode)){if(this._objFlags|=a,this.onLoad)p(this);if(this._objFlags|=h,this.onLoad&&!cc.engine._isPlaying){var e=Editor.Selection.curActivate("node")===this.node.uuid;if(e&&this.onFocusInEditor)v(this);else if(this.onLostFocusInEditor)m(this)}if(1)_Scene.AssetsWatcher.start(this)}if(this._enabled)n(this,t)}:function(t){if(!(this._objFlags&a)){if(this._objFlags|=a,this.onLoad)this.onLoad();this._objFlags|=h}if(this._enabled)n(this,t)},_onPreDestroy:function(){var t,e,i;for(n(this,!1),this.unscheduleAllCallbacks(),t=0,e=this.__eventTargets.length;e>t;++t)i=this.__eventTargets[t],i&&i.targetOff(this);if(this.__eventTargets.length=0,cc.eventManager.removeListeners(this),!1){if(1)_Scene.AssetsWatcher.stop(this);if(cc.engine._isPlaying||this.constructor._executeInEditMode)if(this.onDestroy)g(this)}else if(this.onDestroy)this.onDestroy();if(this.node._removeComponent(this),!1)delete cc.engine.attachedObjsForEditor[this._id]},_instantiate:function(){var t=cc.instantiate._clone(this,this);return t.node=null,t},isRunning:function(){return this.enabledInHierarchy},schedule:function(t,e,i,n){cc.assert(t,cc._LogInfos.Node.schedule),cc.assert(e>=0,cc._LogInfos.Node.schedule_2),e=e||0,i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0,cc.director.getScheduler().schedule(t,this,e,i,n,!this.enabledInHierarchy)},scheduleOnce:function(t,e){this.schedule(t,0,0,e)},unschedule:function(t){if(t)cc.director.getScheduler().unschedule(t,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});if(A._requireComponent=null,!1)A._executeInEditMode=!1,A._playOnFocus=!1,A._disallowMultiple=null,A._help="",Object.defineProperty(A,"_inspector",{value:"",enumerable:!1}),Object.defineProperty(A,"_icon",{value:"",enumerable:!1}),cc._componentMenuItems=[],A._addMenuItem=function(t,e,i){cc._componentMenuItems.push({component:t,menuPath:e,priority:i})};Object.defineProperty(A,"_registerEditorProps",{value:function(t,e){var i=e.requireComponent;if(i)t._requireComponent=i;if(!1){var n=cc.js.getClassName(t);for(var r in e){var o=e[r];switch(r){case"executeInEditMode":t._executeInEditMode=!!o;break;case"playOnFocus":if(o){var s="executeInEditMode"in e?e.executeInEditMode:t._executeInEditMode;if(s)t._playOnFocus=!0;else cc.warn('The editor property "playOnFocus" should be used with "executeInEditMode" in class "%s".',n)}break;case"inspector":Object.defineProperty(t,"_inspector",{value:o});break;case"icon":Object.defineProperty(t,"_icon",{value:o});break;case"menu":A._addMenuItem(t,o,e.menuPriority);break;case"disallowMultiple":t._disallowMultiple=t;break;case"requireComponent":break;case"help":t._help=o;break;default:cc.warn('Unknown editor property "%s" in class "%s".',r,n)}}}}}),A.prototype.__scriptUuid="",cc.Component=e.exports=A},{"../CCNode":20,"../platform/CCObject":70,"../platform/id-generater":77}],39:[function(t,e,i){cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{"default":null,type:cc.Node},component:{"default":""},handler:{"default":""}},statics:{emitEvents:function(t,e){for(var i=0,n=t.length;n>i;i++){var r=t[i];if(!(!r instanceof cc.Component.EventHandler))r.emit(e);else;}}},emit:function(t){var e=this.target;if(cc.isValid(e)){var i=e.getComponent(this.component);if(cc.isValid(i)){var n=i[this.handler];if("function"==typeof n)n.call(i,t)}}}})},{}],40:[function(t,e,i){var n=_ccsg.EditBox.KeyboardReturnType,r=_ccsg.EditBox.InputMode,o=_ccsg.EditBox.InputFlag,s=cc.Class({name:"cc.EditBox","extends":cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,_string:"",string:{tooltip:"i18n:COMPONENT.editbox.string",get:function(){return this._sgNode.string},set:function(t){this._sgNode.string=this._string=t}},backgroundImage:{tooltip:"i18n:COMPONENT.editbox.backgroundImage","default":null,type:cc.SpriteFrame,notify:function(){var t=this._sgNode,e=t.getBackgroundSprite();if(this.backgroundImage){var i=this._createBackgroundSprite();i.setContentSize(t.getContentSize())}else e.removeFromParent()}},returnType:{"default":n.DEFAULT,tooltip:"i18n:COMPONENT.editbox.returnType",displayName:"KeyboardReturnType",type:n,notify:function(){this._sgNode.returnType=this.returnType}},inputFlag:{tooltip:"i18n:COMPONENT.editbox.input_flag","default":o.INITIAL_CAPS_ALL_CHARACTERS,type:o,notify:function(){this._sgNode.inputFlag=this.inputFlag}},inputMode:{tooltip:"i18n:COMPONENT.editbox.input_mode","default":r.ANY,type:r,notify:function(){this._sgNode.inputMode=this.inputMode}},fontSize:{tooltip:"i18n:COMPONENT.editbox.font_size","default":20,notify:function(){this._sgNode.fontSize=this.fontSize}},lineHeight:{tooltip:"i18n:COMPONENT.editbox.line_height","default":40,notify:function(){this._sgNode.setLineHeight(this.lineHeight)}},fontColor:{tooltip:"i18n:COMPONENT.editbox.font_color","default":cc.Color.WHITE,notify:function(){this._sgNode.fontColor=this.fontColor}},placeholder:{tooltip:"i18n:COMPONENT.editbox.placeholder","default":"Enter text here...",notify:function(){this._sgNode.placeholder=this.placeholder}},placeholderFontSize:{tooltip:"i18n:COMPONENT.editbox.placeholder_font_size","default":20,notify:function(){this._sgNode.placeholderFontSize=this.placeholderFontSize}},placeholderFontColor:{tooltip:"i18n:COMPONENT.editbox.placeholder_font_color","default":cc.Color.GRAY,notify:function(){this._sgNode.placeholderFontColor=this.placeholderFontColor}},maxLength:{tooltip:"i18n:COMPONENT.editbox.max_length","default":20,notify:function(){this._sgNode.maxLength=this.maxLength}},editingDidBegan:{"default":[],type:cc.Component.EventHandler},textChanged:{"default":[],type:cc.Component.EventHandler},editingDidEnded:{"default":[],type:cc.Component.EventHandler}},statics:{KeyboardReturnType:n,InputFlag:o,InputMode:r},_applyCapInset:function(t){var e=this.backgroundImage;t.setInsetTop(e.insetTop),t.setInsetBottom(e.insetBottom),t.setInsetRight(e.insetRight),t.setInsetLeft(e.insetLeft)},_createSgNode:function(){return new _ccsg.EditBox(cc.size(160,40))},_createBackgroundSprite:function(){var t=this._sgNode,e=new cc.Scale9Sprite;if(e.setRenderingType(cc.Scale9Sprite.RenderingType.SLICED),this.backgroundImage)e.setSpriteFrame(this.backgroundImage),this._applyCapInset(e);return t.initWithSizeAndBackgroundSprite(cc.size(160,40),e),e},_initSgNode:function(){var t=this._sgNode;if(this._createBackgroundSprite(),this._useOriginalSize,!1)this.node.setContentSize(t.getContentSize()),this._useOriginalSize=!1;else t.setContentSize(this.node.getContentSize());t.inputMode=this.inputMode,t.maxLength=this.maxLength,t.string=this._string,t.fontSize=this.fontSize,t.fontColor=this.fontColor,t.placeholder=this.placeholder,t.placeholderFontSize=this.placeholderFontSize,t.placeholderFontColor=this.placeholderFontColor,t.inputFlag=this.inputFlag,t.returnType=this.returnType,t.setLineHeight(this.lineHeight),t.setDelegate(this)},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded)},editBoxTextChanged:function(t,e){cc.Component.EventHandler.emitEvents(this.textChanged,e)},onLoad:function(){if(this._super(),1)this._registerEvent()},_registerEvent:function(){if(0)this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_onTouchBegan:function(t){if(this._sgNode)this._sgNode._onTouchBegan(t.touch);t.stopPropagation()},_onTouchEnded:function(t){if(this._sgNode)this._sgNode._onTouchEnded();t.stopPropagation()}});if(!0)s.prototype.editBoxEditingDidBegin=function(t){this.editBoxEditingDidBegan(t)},s.prototype.editBoxEditingDidEnd=function(t){this.editBoxEditingDidEnded(t)};cc.EditBox=e.exports=s},{}],41:[function(t,e,i){var n=cc.TextAlignment,r=cc.VerticalTextAlignment,o=_ccsg.Label.Overflow,s=(_ccsg.Label.Type,cc.Class({name:"cc.Label","extends":cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,string:{"default":"Label",multiline:!0,tooltip:"i18n:COMPONENT.label.string",notify:function(){if(this._sgNode)this._sgNode.setString(this.string),this._updateNodeSize()}},horizontalAlign:{"default":n.LEFT,type:n,tooltip:"i18n:COMPONENT.label.horizontal_align",notify:function(){if(this._sgNode)this._sgNode.setHorizontalAlign(this.horizontalAlign)},animatable:!1},verticalAlign:{"default":r.TOP,type:r,tooltip:"i18n:COMPONENT.label.vertical_align",notify:function(){if(this._sgNode)this._sgNode.setVerticalAlign(this.verticalAlign)},animatable:!1},_fontSize:40,fontSize:{get:function(){if(this._sgNode)this._fontSize=this._sgNode.getFontSize();return this._fontSize},set:function(t){if(this._fontSize=t,this._sgNode)this._sgNode.setFontSize(t),this._updateNodeSize()},tooltip:"i18n:COMPONENT.label.font_size"},_lineHeight:40,lineHeight:{get:function(){if(this._sgNode)this._lineHeight=this._sgNode.getLineHeight();return this._lineHeight},set:function(t){if(this._lineHeight=t,this._sgNode)this._sgNode.setLineHeight(t),this._updateNodeSize()},tooltip:"i18n:COMPONENT.label.line_height"},overflow:{"default":o.NONE,type:o,tooltip:"i18n:COMPONENT.label.overflow",notify:function(){if(this._sgNode)this._sgNode.setOverflow(this.overflow),this._updateNodeSize()},animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){if(this._sgNode)this._enableWrapText=this._sgNode.isWrapTextEnabled();return this._enableWrapText},set:function(t){if(this._enableWrapText=t,this._sgNode)this._sgNode.enableWrapText(t)},animatable:!1,tooltip:"i18n:COMPONENT.label.wrap"},file:{"default":"Arial",url:cc.Font,tooltip:"i18n:COMPONENT.label.file",notify:function(){if(this._sgNode)this._sgNode.setFontFileOrFamily(this.file)},animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){if(this._sgNode)this._isSystemFontUsed=this._sgNode.isSystemFontUsed();return this._isSystemFontUsed},set:function(t){if(this._isSystemFontUsed=t,t)if(this.file="",this._sgNode)this._sgNode.setSystemFontUsed(t)},animatable:!1,tooltip:"i18n:COMPONENT.label.system_font"}},statics:{HorizontalAlign:n,VerticalAlign:r,Overflow:o},onLoad:function(){this._super();var t=this._sgNode._isUseSystemFont;if(t)this._updateNodeSize();else if(this.node._sizeProvider===this._sgNode)this.node._sizeProvider=null;if(!cc.sys.isNative)this._sgNode.on("load",this._updateNodeSize,this)},_createSgNode:function(){return null},_initSgNode:function(){this._sgNode=new _ccsg.Label(this.string,this.file),this._sgNode.retain();var t=this._sgNode;if(t.setHorizontalAlign(this.horizontalAlign),t.setVerticalAlign(this.verticalAlign),t.setFontSize(this._fontSize),t.setOverflow(this.overflow),t.enableWrapText(this._enableWrapText),t.setLineHeight(this._lineHeight),t.setString(this.string),t.setFontFileOrFamily(this.file),this._useOriginalSize,!1)this.node.setContentSize(t.getContentSize()),this._useOriginalSize=!1;else t.setContentSize(this.node.getContentSize());t.setColor(this.node.color)},_updateNodeSize:function(){var t=this._sgNode&&this._sgNode.parent;if(t){if(this.overflow===o.NONE)this.node.setContentSize(this._sgNode.getContentSize());if(!this.node._sizeProvider)this.node._sizeProvider=this._sgNode}}}));cc.Label=e.exports=s},{}],42:[function(t,e,i){var n=cc.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3}),r=cc.Enum({NONE:0,CONTAINER:1,CHILDREN:2}),o=cc.Enum({HORIZONTAL:0,VERTICAL:1}),s=cc.Enum({BOTTOM_TO_TOP:0,TOP_TO_BOTTOM:1}),c=cc.Enum({LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1}),a=cc.Class({name:"cc.Layout","extends":t("./CCComponent"),editor:!1,properties:{_layoutSize:cc.size(300,200),_layoutDirty:{"default":!0,serializable:!1},_resize:r.NONE,_N$layoutType:n.NONE,type:{type:n,get:function(){return this._N$layoutType},set:function(t){if(this._N$layoutType=t,this.type!==n.NONE&&this._resize===r.CONTAINER,!1){var e=_Scene.DetectConflict.checkConflict_Layout(this);if(e)return}this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.layout_type"},resizeMode:{type:r,tooltip:"i18n:COMPONENT.layout.resize_mode",get:function(){return this._resize},set:function(t){if(this.type!==n.NONE||t!==r.CHILDREN){if(this._resize=t,this.type!==n.NONE&&t===r.CONTAINER,!1){var e=_Scene.DetectConflict.checkConflict_Layout(this);if(e)return}this._doLayoutDirty()}},animatable:!1},cellSize:{"default":cc.size(40,40),tooltip:"i18n:COMPONENT.layout.cell_size",type:cc.Size,notify:function(){this._doLayoutDirty()},animatable:!1},startAxis:{"default":o.HORIZONTAL,tooltip:"i18n:COMPONENT.layout.start_axis",type:o,notify:function(){if(this._resize===r.CONTAINER,!1){var t=_Scene.DetectConflict.checkConflict_Layout(this);if(t)return}this._doLayoutDirty()},animatable:!1},padding:{"default":0,tooltip:"i18n:COMPONENT.layout.padding",notify:function(){this._doLayoutDirty()},animatable:!1},spacingX:{"default":0,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.space_x"},spacingY:{"default":0,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.space_y"},verticalDirection:{"default":s.TOP_TO_BOTTOM,type:s,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.vertical_direction"},horizontalDirection:{"default":c.LEFT_TO_RIGHT,type:c,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.horizontal_direction"}},statics:{Type:n,VerticalDirection:s,HorizontalDirection:c,ResizeMode:r,AxisDirection:o},onLoad:function(){if(cc.sizeEqualToSize(this.node.getContentSize(),cc.size(0,0)))this.node.setContentSize(this._layoutSize);this.node.on("size-changed",this._resized,this),this.node.on("anchor-changed",this._doLayoutDirty,this),this.node.on("child-added",this._childrenAddOrDeleted,this),this.node.on("child-removed",this._childrenAddOrDeleted,this),this.node.on("child-reorder",this._doLayoutDirty,this),this._updateChildrenEventListener()},_doLayoutDirty:function(){this._layoutDirty=!0},_updateChildrenEventListener:function(){var t=this.node.children;t.forEach(function(t){t.on("size-changed",this._doLayoutDirty,this),t.on("position-changed",this._doLayoutDirty,this),t.on("anchor-changed",this._doLayoutDirty,this),t.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}.bind(this))},_childrenAddOrDeleted:function(){this._updateChildrenEventListener(),this._doLayoutDirty()},_resized:function(){this._layoutSize=this.node.getContentSize(),this._doLayoutDirty()},_doLayoutHorizontally:function(t,e,i,o){var a=this.node.getAnchorPoint(),h=this.node.children,l=1,u=-a.x*t;if(this.horizontalDirection===c.RIGHT_TO_LEFT)l=-1,u=(1-a.x)*t;var f,d=u+l*this.padding-l*this.spacingX,p=0,_=0,g=0,v=0,m=0,y=this.cellSize.width;if(this.type!==n.GRID&&this.resizeMode===r.CHILDREN)y=(t-2*this.padding-(h.length-1)*this.spacingX)/h.length;return h.forEach(function(h){if(h.activeInHierarchy){if(this._resize===r.CHILDREN)if(h.width=y,this.type===n.GRID)h.height=this.cellSize.height;var b=h.anchorX;if(g>_)_=g;if(h.height>=_)g=_,_=h.height,m=h.getAnchorPoint().y;if(this.horizontalDirection===c.RIGHT_TO_LEFT)b=1-h.anchorX;d=d+l*b*h.width+l*this.spacingX;var T=l*(1-b)*h.width;if(e){var C=d+T+l*this.padding,A=this.horizontalDirection===c.LEFT_TO_RIGHT&&C>(1-a.x)*t,S=this.horizontalDirection===c.RIGHT_TO_LEFT&&C<-a.x*t;if(A||S){if(h.height>=_){if(0===g)g=_;p+=g,g=_}else p+=_,g=h.height,_=0;d=u+l*(this.padding+b*h.width),v++}}var E=i(h,p,v);if(t>=h.width+2*this.padding)if(o)h.setPosition(cc.p(d,E));var x,O=1,N=0===_?h.height:_;if(this.verticalDirection===s.TOP_TO_BOTTOM){if(f=f||this.node._contentSize.height,O=-1,x=E+O*(N*m+this.padding),f>x)f=x}else if(f=f||-this.node._contentSize.height,x=E+O*(N*m+this.padding),x>f)f=x;d+=T}}.bind(this)),f},_getVerticalBaseHeight:function(t){var e=0;if(this.resizeMode===r.CONTAINER)t.forEach(function(t){e+=t.height}),e+=(t.length-1)*this.spacingY+2*this.padding;else e=this.node.getContentSize().height;return e},_doLayoutVertically:function(t,e,i,o){var a=this.node.getAnchorPoint(),h=this.node.children,l=1,u=-a.y*t;if(this.verticalDirection===s.TOP_TO_BOTTOM)l=-1,u=(1-a.y)*t;var f,d=u+l*this.padding-l*this.spacingY,p=0,_=0,g=0,v=0,m=0,y=this.cellSize.height;if(this.type!==n.GRID&&this.resizeMode===r.CHILDREN)y=(t-2*this.padding-(h.length-1)*this.spacingY)/h.length;return h.forEach(function(h){if(h.activeInHierarchy){if(this.resizeMode===r.CHILDREN)if(h.height=y,this.type===n.GRID)h.width=this.cellSize.width;var b=h.anchorY;if(g>_)_=g;if(h.width>=_)g=_,_=h.width,m=h.getAnchorPoint().x;if(this.verticalDirection===s.TOP_TO_BOTTOM)b=1-h.anchorY;d=d+l*b*h.height+l*this.spacingY;var T=l*(1-b)*h.height;if(e){var C=d+T+l*this.padding,A=this.verticalDirection===s.BOTTOM_TO_TOP&&C>(1-a.y)*t,S=this.verticalDirection===s.TOP_TO_BOTTOM&&C<-a.y*t;if(A||S){if(h.width>=_){if(0===g)g=_;p+=g,g=_}else p+=_,g=h.width,_=0;d=u+l*(this.padding+b*h.height),v++}}var E=i(h,p,v);if(t>=h.height+2*this.padding)if(o)h.setPosition(cc.p(E,d));var x,O=1,N=0===_?h.width:_;if(this.horizontalDirection===c.RIGHT_TO_LEFT){if(O=-1,f=f||this.node._contentSize.width,x=E+O*(N*m+this.padding),f>x)f=x}else if(f=f||-this.node._contentSize.width,x=E+O*(N*m+this.padding),x>f)f=x;d+=T}}.bind(this)),f},_doLayoutBasic:function(){var t=this.node.children,e=null;if(t.forEach(function(t){if(!e)e=t.getBoundingBoxToWorld();else e=cc.rectUnion(e,t.getBoundingBoxToWorld())}),e){var i=this.node.parent.convertToNodeSpaceAR(cc.p(e.x,e.y)),n=this.node.parent.convertToNodeSpaceAR(cc.p(e.x+e.width,e.y+e.height)),r=cc.size(n.x-i.x,n.y-i.y),o=this.node.getPosition(),s=cc.p((o.x-i.x)/r.width,(o.y-i.y)/r.height);this.node.setAnchorPoint(s),this.node.setContentSize(r)}},_doLayoutGridAxisHorizontal:function(t,e){var i=e.width,n=1,o=-t.y*e.height;if(this.verticalDirection===s.TOP_TO_BOTTOM)n=-1,o=(1-t.y)*e.height;var c=function(t,e,i){return o+n*(e+t.anchorY*t.height+this.padding+i*this.spacingY)}.bind(this),a=0;if(this.resizeMode===r.CONTAINER){var h=this._doLayoutHorizontally(i,!0,c,!1);if(a=o-h,0>a)a*=-1;if(o=-t.y*a,this.verticalDirection===s.TOP_TO_BOTTOM)n=-1,o=(1-t.y)*a}if(this._doLayoutHorizontally(i,!0,c,!0),this.resizeMode===r.CONTAINER)this.node.setContentSize(i,a)},_doLayoutGridAxisVertical:function(t,e){var i=e.height,n=1,o=-t.x*e.width;if(this.horizontalDirection===c.RIGHT_TO_LEFT)n=-1,o=(1-t.x)*e.width;var s=function(t,e,i){return o+n*(e+t.anchorX*t.width+this.padding+i*this.spacingX)}.bind(this),a=0;if(this.resizeMode===r.CONTAINER){var h=this._doLayoutVertically(i,!0,s,!1);if(a=o-h,0>a)a*=-1;if(o=-t.x*a,this.horizontalDirection===c.RIGHT_TO_LEFT)n=-1,o=(1-t.x)*a}if(this._doLayoutVertically(i,!0,s,!0),this.resizeMode===r.CONTAINER)this.node.setContentSize(a,i)},_doLayoutGrid:function(){var t=this.node.getAnchorPoint(),e=this.node.getContentSize();if(this.startAxis===o.HORIZONTAL)this._doLayoutGridAxisHorizontal(t,e);else if(this.startAxis===o.VERTICAL)this._doLayoutGridAxisVertical(t,e)},_getHorizontalBaseWidth:function(t){var e=0;if(this.resizeMode===r.CONTAINER)t.forEach(function(t){e+=t.width}),e+=(t.length-1)*this.spacingX+2*this.padding;else e=this.node.getContentSize().width;return e},_doLayout:function(){if(this.type===n.HORIZONTAL){var t=this._getHorizontalBaseWidth(this.node.children),e=function(t){return t.y};this._doLayoutHorizontally(t,!1,e,!0),this.node.width=t}else if(this.type===n.VERTICAL){var i=this._getVerticalBaseHeight(this.node.children),o=function(t){return t.x};this._doLayoutVertically(i,!1,o,!0),this.node.height=i}else if(this.type===n.NONE){if(this.resizeMode===r.CONTAINER)this._doLayoutBasic()}else if(this.type===n.GRID)this._doLayoutGrid()},lateUpdate:function(){if(this._layoutDirty&&this.node.children.length>0)this._doLayout(),this._layoutDirty=!1}});cc.Layout=e.exports=a},{"./CCComponent":38}],43:[function(t,e,i){var n=cc.Enum({RECT:0,ELLIPSE:1}),r=cc.Class({name:"cc.Mask","extends":cc._RendererInSG,editor:!1,properties:{_clippingStencil:{"default":null,serializable:!1},_type:0,_segements:64,type:{get:function(){return this._type},set:function(t){this._type=t,this._refreshStencil()},type:n},segements:{get:function(){return this._segements},set:function(t){if(3>t)t=3;this._segements=t,this._refreshStencil()},type:cc.Integer}},statics:{Type:n},_createSgNode:function(){return this._clippingStencil=new cc.DrawNode,this._clippingStencil.retain(),new cc.ClippingNode(this._clippingStencil)},_initSgNode:function(){},onEnable:function(){this._refreshStencil(),this._super(),this.node.on("size-changed",this._refreshStencil,this),this.node.on("anchor-changed",this._refreshStencil,this)},onDisable:function(){this._super(),this.node.off("size-changed",this._refreshStencil,this),this.node.off("anchor-changed",this._refreshStencil,this)},onDestroy:function(){this._super(),this._clippingStencil.release()},_calculateCircle:function(t,e,i){for(var n=[],r=2*Math.PI/i,o=0;i>o;++o)n.push(cc.v2(e.x*Math.cos(r*o)+t.x,e.y*Math.sin(r*o)+t.y));return n},_refreshStencil:function(){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=t.width,r=t.height,o=-i*e.x,s=-r*e.y,c=cc.color(255,255,255,0);if(this._clippingStencil.clear(),this._type===n.RECT){var a=[cc.v2(o,s),cc.v2(o+i,s),cc.v2(o+i,s+r),cc.v2(o,s+r)];this._clippingStencil.drawPoly(a,c,0,c)}else{var h=cc.v2(o+i/2,s+r/2),l={x:i/2,y:r/2},u=this._segements;this._clippingStencil.drawPoly(this._calculateCircle(h,l,u),c,0,c)}}});cc.Mask=e.exports=r},{}],44:[function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2}),r=cc.Class({name:"cc.ProgressBar","extends":t("./CCComponent"),editor:!1,_initBarSprite:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=this.node.getContentSize(),i=this.node.getAnchorPoint(),r=t.getContentSize();if(t.parent===this.node)this.node.setContentSize(r);if(this.barSprite.fillType===cc.Sprite.FillType.RADIAL)this.mode=n.FILLED;var o=t.getContentSize();if(this.mode===n.HORIZONTAL)this.totalLength=o.width;else if(this.mode===n.VERTICAL)this.totalLength=o.height;else this.totalLength=this.barSprite.fillRange;if(t.parent===this.node){var s=-e.width*i.x,c=0;t.setPosition(cc.p(s,c))}}},_updateBarStatus:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e,i,r,o=t.getAnchorPoint(),s=t.getContentSize(),c=t.getPosition(),a=cc.p(0,.5),h=cc.clamp01(this.progress),l=this.totalLength*h;switch(this.mode){case n.HORIZONTAL:if(this.reverse)a=cc.p(1,.5);e=cc.size(l,s.height),i=this.totalLength,r=s.height;break;case n.VERTICAL:if(this.reverse)a=cc.p(.5,1);else a=cc.p(.5,0);e=cc.size(s.width,l),i=s.width,r=this.totalLength;break;case n.FILLED:if(this.reverse)l=-1*l;this.barSprite.fillRange=l}if(this.barSprite.type!==cc.Sprite.Type.FILLED){var u=a.x-o.x,f=a.y-o.y,d=cc.p(i*u,r*f);t.setPosition(cc.pAdd(c,d)),t.setAnchorPoint(a),t.setContentSize(e)}}},properties:{barSprite:{"default":null,type:cc.Sprite,tooltip:"i18n:COMPONENT.progress.bar_sprite",notify:function(){this._initBarSprite()},animatable:!1},mode:{"default":n.HORIZONTAL,type:n,tooltip:"i18n:COMPONENT.progress.mode",notify:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=t.getContentSize();if(this.mode===n.HORIZONTAL)this.totalLength=e.width;else if(this.mode===n.VERTICAL)this.totalLength=e.height;else if(this.mode===n.FILLED)this.totalLength=this.barSprite.fillRange}},animatable:!1},totalLength:{"default":1,range:[0,Number.MAX_VALUE],tooltip:"i18n:COMPONENT.progress.total_length",notify:function(t){this._updateBarStatus()}},progress:{"default":1,type:"Float",range:[0,1,.1],tooltip:"i18n:COMPONENT.progress.progress",notify:function(){this._updateBarStatus()}},reverse:{"default":!1,tooltip:"i18n:COMPONENT.progress.reverse",notify:function(){if(this.barSprite)this.barSprite.fillStart=1-this.barSprite.fillStart;this._updateBarStatus()},animatable:!1}},statics:{Mode:n}});cc.ProgressBar=e.exports=r},{"./CCComponent":38}],45:[function(t,e,i){var n=cc.Class({"extends":t("./CCSGComponent"),ctor:function(){if(this._sgNode=this._createSgNode(),this._sgNode)this._sgNode.retain();else if(!1)cc.error("Not support for asynchronous creating node in SG");this._plainNode=new _ccsg.Node,this._plainNode.retain()},onLoad:function(){if(this._initSgNode(),!1){var t=this._sgNode.getContentSize();if(0!==t.width||0!==t.height)cc.error("Renderer error: Size of the cc._RendererInSG._sgNode must be zero");
}},onEnable:function(){this._replaceSgNode(this._sgNode)},onDisable:function(){this._replaceSgNode(this._plainNode)},onDestroy:function(){this._removeSgNode();var t=this.node._sgNode;if(this._plainNode!==t)this._plainNode.release()},_replaceSgNode:function(t){if(!(t instanceof _ccsg.Node),!1)throw new Error("Invalid sgNode. It must be an instance of _ccsg.Node");var e=this.node,i=e._sgNode;if(false)return void cc.warn("The same sgNode");var n=i.getChildren().slice();if(i.removeAllChildren(),t.getChildrenCount()>0){if(!1)cc.warn("The replacement sgNode should not contain any child.");t.removeAllChildren()}for(var r=0,o=n.length;o>r;++r)t.addChild(n[r]);var s=i.getParent();if(s.removeChild(i),s.addChild(t),t.arrivalOrder=i.arrivalOrder,0)cc.renderer.childrenOrderDirty=s._reorderChildDirty=!0;e._sgNode=t,e._updateSgNode()}});cc._RendererInSG=e.exports=n},{"./CCSGComponent":47}],46:[function(t,e,i){var n=cc.Class({"extends":t("./CCSGComponent"),ctor:function(){if(this._sgNode=this._createSgNode(),this._sgNode)this._sgNode.retain()},onLoad:function(){this._initSgNode();var t=this._sgNode;if(!this.node._sizeProvider)this.node._sizeProvider=t;this._appendSgNode(this._sgNode)},onEnable:function(){if(this._sgNode)this._sgNode.setVisible(!0)},onDisable:function(){if(this._sgNode)this._sgNode.setVisible(!1)},onDestroy:function(){if(this.node._sizeProvider===this._sgNode)this.node._sizeProvider=null;this._removeSgNode()},_appendSgNode:function(t){if(t){if(!this.enabled)t.setVisible(!1);var e=this.node;if(t.setColor(e._color),!e._cascadeOpacityEnabled)t.setOpacity(e._opacity);t.setAnchorPoint(e._anchorPoint),t.ignoreAnchorPointForPosition(e.__ignoreAnchor),t.setOpacityModifyRGB(e._opacityModifyRGB),t.setLocalZOrder(-1);var i=e._sgNode;i.addChild(t)}}});cc._RendererUnderSG=e.exports=n},{"./CCSGComponent":47}],47:[function(t,e,i){var n=t("../utils/scene-graph-helper"),r=cc.Class({"extends":t("./CCComponent"),editor:!1,properties:{_sgNode:{"default":null,serializable:!1}},_createSgNode:null,_initSgNode:null,_removeSgNode:n.removeSgNode});cc._SGComponent=e.exports=r},{"../utils/scene-graph-helper":92,"./CCComponent":38}],48:[function(t,e,i){var n=20,r=cc.Enum({HORIZONTAL:0,VERTICAL:1}),o=cc.Class({name:"cc.Scrollbar","extends":t("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{"default":0,serializable:!1},_opacity:255,handle:{"default":null,type:cc.Sprite,tooltip:"i18n:COMPONENT.scrollbar.handle",notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},direction:{"default":r.HORIZONTAL,type:r,tooltip:"i18n:COMPONENT.scrollbar.direction",notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},enableAutoHide:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollbar.auto_hide"},autoHideTime:{"default":1,animatable:!1,tooltip:"i18n:COMPONENT.scrollbar.auto_hide_time"}},statics:{Direction:r},setTargetScrollView:function(t){this._scrollView=t},_convertToScrollViewSpace:function(t){var e=t.convertToWorldSpace(cc.p(0,0)),i=this._scrollView.node.convertToNodeSpace(e);return i},_setOpacity:function(t){if(this.handle)this.node.setOpacity(t)},_onScroll:function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e.getContentSize(),n=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(i,n))return;if(this.enableAutoHide)this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity);var o=0,s=0,c=0,a=0;if(this.direction===r.HORIZONTAL)o=i.width,s=n.width,c=t.x,a=-this._convertToScrollViewSpace(e).x;else if(this.direction===r.VERTICAL)o=i.height,s=n.height,c=t.y,a=-this._convertToScrollViewSpace(e).y;var h=this._calculateLength(o,s,c),l=this._calculatePosition(o,s,a,c,h);this._updateLength(h),this._updateHanlderPosition(l)}}},_updateHanlderPosition:function(t){if(this.handle){var e=this._fixupHandlerPosition();this.handle.node.setPosition(cc.pAdd(t,e))}},_fixupHandlerPosition:function(){var t,e=this.node.getContentSize(),i=this.node.getAnchorPoint(),n=(this.node.getPosition(),this.handle.node.parent);if(this.direction===r.HORIZONTAL){var o=this.node.convertToWorldSpaceAR(cc.p(-e.width*i.x,-e.height*i.y));t=n.convertToNodeSpaceAR(o)}else if(this.direction===r.VERTICAL){var s=this.node.convertToWorldSpaceAR(cc.p(-e.width*i.x,-e.height*i.y));t=n.convertToNodeSpaceAR(s)}return this.handle.node.setPosition(t),t},_onTouchBegan:function(){if(this.enableAutoHide)this._touching=!0},_conditionalDisableScrollBar:function(t,e){if(t.width<=e.width&&this.direction===r.HORIZONTAL)return!0;if(t.height<=e.height&&this.direction===r.VERTICAL)return!0;else return!1},_onTouchEnded:function(){if(this.enableAutoHide)if(this._touching=!1,!(this.autoHideTime<=0)){if(this._scrollView){var t=this._scrollView.content;if(t){var e=t.getContentSize(),i=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this.autoHideTime}},_calculateLength:function(t,e,i){var r=t;if(i)r+=(i>0?i:-i)*n;var o=e/r;return e*o},_calculatePosition:function(t,e,i,n,o){var s=t-e;if(n)s+=Math.abs(n);var c=0;if(s)c=i/s,c=cc.clamp01(c);var a=(e-o)*c;if(this.direction===r.VERTICAL)return cc.p(0,a);else return cc.p(a,0)},_updateLength:function(t){if(this.handle){var e=this.handle.node,i=this.node.getContentSize();if(e.setAnchorPoint(cc.p(0,0)),this.direction===r.HORIZONTAL)e.setContentSize(t,i.height);else e.setContentSize(i.width,t)}},_processAutoHide:function(t){if(this.enableAutoHide&&!(this._autoHideRemainingTime<=0)){if(this._touching)return;if(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this.autoHideTime){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var e=this._opacity*(this._autoHideRemainingTime/this.autoHideTime);this._setOpacity(e)}}},start:function(){if(this.enableAutoHide)this._setOpacity(0)},update:function(t){this._processAutoHide(t)}});cc.Scrollbar=e.exports=o},{"./CCComponent":38}],49:[function(t,e,i){var n=5,r=.05,o=1e-7,s=.7,c=function(t){return t-=1,t*t*t*t*t+1},a=function(){var t=new Date;return t.getMilliseconds()},h=cc.Class({name:"cc.ScrollView","extends":t("./CCComponent"),editor:!1,ctor:function(){this._topBoundary=0,this._bottomBoundary=0,this._leftBoundary=0,this._rightBoundary=0,this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._autoScrolling=!1,this._autoScrollAttenuate=!1,this._autoScrollStartPosition=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0,this._autoScrollCurrentlyOutOfBoundary=!1,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0),this._outOfBoundaryAmount=cc.p(0,0),this._outOfBoundaryAmountDirty=!0,this._stopMouseWheel=!1,this._mouseWheelEventElapsedTime=0},properties:{content:{"default":null,type:cc.Node,tooltip:"i18n:COMPONENT.scrollview.content"},horizontal:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.horizontal"},vertical:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.vertical"},inertia:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.inertia"},brake:{"default":.5,type:"Float",range:[0,1,.1],animatable:!1},elastic:{"default":!0,animatable:!1},bounceDuration:{"default":1,range:[0,10],animatable:!1},horizontalScrollBar:{"default":null,type:cc.Scrollbar,tooltip:"i18n:COMPONENT.scrollview.horizontal_bar",notify:function(){if(this.horizontalScrollBar)this.horizontalScrollBar.setTargetScrollView(this),this._updateScrollBar(0)},animatable:!1},verticalScrollBar:{"default":null,type:cc.Scrollbar,tooltip:"i18n:COMPONENT.scrollview.vertical_bar",notify:function(){if(this.verticalScrollBar)this.verticalScrollBar.setTargetScrollView(this),this._updateScrollBar(0)},animatable:!1}},scrollToBottom:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!1,applyToVertical:!0});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i,!0)},scrollToTop:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!1,applyToVertical:!0});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i)},scrollToLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!1});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i)},scrollToRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!1});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i)},scrollToTopLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!0,applyToVertical:!0});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i)},scrollToTopRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,1),applyToHorizontal:!0,applyToVertical:!0});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i)},scrollToBottomLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!0});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i)},scrollToBottomRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!0});if(t)this._startAutoScroll(i,t,e!==!1);else this._moveContent(i)},scrollToPercentHorizontal:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(t,0),applyToHorizontal:!0,applyToVertical:!1});if(e)this._startAutoScroll(n,e,i!==!1);else this._moveContent(n)},scrollTo:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:t,applyToHorizontal:!0,applyToVertical:!0});if(e)this._startAutoScroll(n,e,i!==!1);else this._moveContent(n)},scrollToPercentVertical:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(0,t),applyToHorizontal:!1,applyToVertical:!0});if(e)this._startAutoScroll(n,e,i!==!1);else this._moveContent(n)},setContentPosition:function(t){if(!cc.pFuzzyEqual(t,this.getContentPosition(),o))this.content.setPosition(t),this._outOfBoundaryAmountDirty=!0},getContentPosition:function(){return this.content.getPosition()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this)},_onMouseWheel:function(t){var e=cc.p(0,0),i=.025;if(cc.sys.isNative)i=7;if(this.vertical)e=cc.p(0,t.getScrollY()*i);else if(this.horizontal)e=cc.p(t.getScrollY()*i,0);if(this._mouseWheelEventElapsedTime=0,this._processDeltaMove(e),!this._stopMouseWheel)this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0;t.stopPropagation()},_checkMouseWheel:function(t){var e=this._getHowMuchOutOfBoundary(),i=.1;if(!cc.pFuzzyEqual(e,cc.p(0,0),o))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),void(this._stopMouseWheel=!1);if(this._mouseWheelEventElapsedTime+=t,this._mouseWheelEventElapsedTime>i)this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._stopMouseWheel=!1},_calculateMovePercentDelta:function(t){var e=t.anchor,i=t.applyToHorizontal,n=t.applyToVertical;this._calculateBoundary(),e=cc.pClamp(e,cc.p(0,0),cc.p(1,1));var r=this.node.getContentSize(),o=this.content.getContentSize(),s=Math.abs(this._getContentBottomBoundary()-this._bottomBoundary),c=Math.abs(this._getContentLeftBoundary()-this._leftBoundary),a=cc.p(0,0);if(i)a.x=(o.width-r.width)*e.x-c;if(n)a.y=(o.height-r.height)*e.y-s;return a=cc.pNeg(a)},_calculateBoundary:function(){if(this.content){var t=this.node.getContentSize(),e=this._convertToContentParentSpace(cc.p(0,0));this._leftBoundary=e.x,this._bottomBoundary=e.y;var i=this._convertToContentParentSpace(cc.p(t.width,t.height));this._rightBoundary=i.x,this._topBoundary=i.y}},_convertToContentParentSpace:function(t){var e=this.node.convertToWorldSpace(t),i=this.content.parent;return i.convertToNodeSpaceAR(e)},_onTouchBegan:function(t){var e=t.touch;if(this.content)this._handlePressLogic(e);t.stopPropagation()},_cancelButtonClick:function(t){var e=t.getDelta(),i=!1;if(cc.sys.isMobile){var n=7;if(cc.pLength(e)>n)i=!0}else i=!0;return i},_onTouchMoved:function(t){var e=t.touch;if(this.content){var i=t.target.getComponent(cc.Button);if(i&&this._cancelButtonClick(e))i._cancelButtonClick();this._handleMoveLogic(e)}t.stopPropagation()},_onTouchEnded:function(t){var e=t.touch;if(this.content)this._handleReleaseLogic(e);t.stopPropagation()},_onTouchCancelled:function(t){var e=t.touch;if(this.content)this._handleReleaseLogic(e);t.stopPropagation()},_processDeltaMove:function(t){this._scrollChildren(t),this._gatherTouchMove(t)},_handleMoveLogic:function(t){var e=t.getDelta();this._processDeltaMove(e)},_scrollChildren:function(t){t=this._clampDelta(t);var e,i=t;if(this.elastic)e=this._getHowMuchOutOfBoundary(),i.x*=0===e.x?1:.5,i.y*=0===e.y?1:.5;if(!this.elastic)e=this._getHowMuchOutOfBoundary(i),i=cc.pAdd(i,e);this._moveContent(i,!1)},_handlePressLogic:function(){this._autoScrolling=!1,this._calculateBoundary(),this._touchMovePreviousTimestamp=a(),this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._onScrollBarTouchBegan()},_clampDelta:function(t){var e=this.content.getContentSize(),i=this.node.getContentSize();if(e.width<=i.width)t.x=0;if(e.height<=i.height)t.y=0;return t},_gatherTouchMove:function(t){for(t=this._clampDelta(t);this._touchMoveDisplacements.length>=n;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=a();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if(t=this._clampDelta(t),cc.pFuzzyEqual(t,cc.p(0,0),o))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),!0},_processInertiaScroll:function(){var t=this._startBounceBackIfNeeded();if(!t&&this.inertia){var e=this._calculateTouchMoveVelocity();if(!cc.pFuzzyEqual(e,cc.p(0,0),o)&&this.brake<1)this._startInertiaScroll(e)}this._onScrollBarTouchEnded()},_handleReleaseLogic:function(t){var e=t.getDelta();this._gatherTouchMove(e),this._processInertiaScroll()},_isOutOfBoundary:function(){var t=this._getHowMuchOutOfBoundary();return!cc.pFuzzyEqual(t,cc.p(0,0),o)},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},_processAutoScrolling:function(t){var e=this._isNecessaryAutoScrollBrake(),i=e?r:1;this._autoScrollAccumulatedTime+=t*(1/i);var n=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);if(this._autoScrollAttenuate)n=c(n);var s=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,n)),a=1===n;if(this.elastic){var h=cc.pSub(s,this._autoScrollBrakingStartPosition);if(e)h=cc.pMult(h,i);s=cc.pAdd(this._autoScrollBrakingStartPosition,h)}else{var l=cc.pSub(s,this.getContentPosition()),u=this._getHowMuchOutOfBoundary(l);if(!cc.pFuzzyEqual(u,cc.p(0,0),o))s=cc.pAdd(s,u),a=!0}if(a)this._autoScrolling=!1;var f=cc.pSub(s,this.getContentPosition());this._moveContent(f,a)},_startInertiaScroll:function(t){var e=cc.pMult(t,s);this._startAttenuatingAutoScroll(e,t)},_calculateAttenuatedFactor:function(t){if(this.brake<=0)return 1-this.brake;var e=(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9));return e},_startAttenuatingAutoScroll:function(t,e){var i=this._calculateAutoScrollTimeByInitalSpeed(cc.pLength(e)),n=cc.pLength(t),r=cc.pNormalize(t),o=this.content.getContentSize(),s=this.node.getContentSize(),c=o.width-s.width,a=o.height-s.height,h=this._calculateAttenuatedFactor(c),l=this._calculateAttenuatedFactor(a);r=cc.p(r.x*c*(1-this.brake)*h,r.y*a*l*(1-this.brake)),r=cc.pAdd(t,r);var u=cc.pLength(r)/n;i*=u,this._startAutoScroll(r,i,!0)},_calculateAutoScrollTimeByInitalSpeed:function(t){var e=Math.sqrt(Math.sqrt(t/5));return e},_startAutoScroll:function(t,e,i){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this.getContentPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var r=this._getHowMuchOutOfBoundary();if(!cc.pFuzzyEqual(r,cc.p(0,0),o)){this._autoScrollCurrentlyOutOfBoundary=!0;var s=this._getHowMuchOutOfBoundary(n);if(r.x*s.x>0||r.y*s.y>0)this._autoScrollBraking=!0}},_calculateTouchMoveVelocity:function(){var t=0;if(t=this._touchMoveTimeDeltas.reduce(function(t,e){return t+e},t),0>=t||t>=.5)return cc.p(0,0);var e=cc.p(0,0);return e=this._touchMoveDisplacements.reduce(function(t,e){return cc.pAdd(t,e)},e),cc.p(e.x/t,e.y/t)},_flattenVectorByDirection:function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},_moveContent:function(t,e){var i=this._flattenVectorByDirection(t),n=cc.pAdd(this.getContentPosition(),i);this.setContentPosition(n);var r=this._getHowMuchOutOfBoundary();if(this._updateScrollBar(r),this.elastic&&e)this._startBounceBackIfNeeded()},_getContentLeftBoundary:function(){var t=this.getContentPosition(),e=t.x-this.content.getAnchorPoint().x*this.content.getContentSize().width;return e},_getContentRightBoundary:function(){var t=this.content.getContentSize();return this._getContentLeftBoundary()+t.width},_getContentTopBoundary:function(){var t=this.content.getContentSize();return this._getContentBottomBoundary()+t.height},_getContentBottomBoundary:function(){var t=this.getContentPosition(),e=t.y-this.content.getAnchorPoint().y*this.content.getContentSize().height;return e},_getHowMuchOutOfBoundary:function(t){if(t=t||cc.p(0,0),cc.pFuzzyEqual(t,cc.p(0,0),o)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=cc.p(0,0);if(this._getContentLeftBoundary()+t.x>this._leftBoundary)e.x=this._leftBoundary-(this._getContentLeftBoundary()+t.x);else if(this._getContentRightBoundary()+t.x<this._rightBoundary)e.x=this._rightBoundary-(this._getContentRightBoundary()+t.x);if(this._getContentTopBoundary()+t.y<this._topBoundary)e.y=this._topBoundary-(this._getContentTopBoundary()+t.y);else if(this._getContentBottomBoundary()+t.y>this._bottomBoundary)e.y=this._bottomBoundary-(this._getContentBottomBoundary()+t.y);if(cc.pFuzzyEqual(t,cc.p(0,0),o))this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1;return e=this._clampDelta(e)},_updateScrollBar:function(t){if(this.horizontalScrollBar)this.horizontalScrollBar._onScroll(t);if(this.verticalScrollBar)this.verticalScrollBar._onScroll(t)},_onScrollBarTouchBegan:function(){if(this.horizontalScrollBar)this.horizontalScrollBar._onTouchBegan();if(this.verticalScrollBar)this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){if(this.horizontalScrollBar)this.horizontalScrollBar._onTouchEnded();if(this.verticalScrollBar)this.verticalScrollBar._onTouchEnded()},onLoad:function(){if(1)this._registerEvent()},start:function(){this._calculateBoundary()},update:function(t){if(this._autoScrolling)this._processAutoScrolling(t)}});cc.ScrollView=e.exports=h},{"./CCComponent":38}],50:[function(t,e,i){var n=cc.Scale9Sprite.RenderingType,r=cc.Scale9Sprite.FillType,o=cc.BlendFunc.BlendFactor,s=cc.Enum({CUSTOM:0,TRIMMED:1,RAW:2}),c=cc.Class({name:"cc.Sprite","extends":t("./CCRendererUnderSG"),editor:!1,ctor:function(){this._blendFunc=new cc.BlendFunc(this._srcBlendFactor,this._dstBlendFactor)},properties:{_spriteFrame:{"default":null,type:cc.SpriteFrame},_type:n.SIMPLE,_sizeMode:s.TRIMMED,_fillType:0,_fillCenter:cc.v2(0,0),_fillStart:0,_fillRange:0,_isTrimmedMode:!0,_srcBlendFactor:o.SRC_ALPHA,_dstBlendFactor:o.ONE_MINUS_SRC_ALPHA,_atlas:{"default":null,type:cc.SpriteAtlas,tooltip:"i18n:COMPONENT.sprite.atlas",editorOnly:!0,visible:!0,animatable:!1},spriteFrame:{get:function(){return this._spriteFrame},set:function(t,e){if(this._spriteFrame!==t){var i=this._spriteFrame;if(this._spriteFrame=t,this._applySpriteFrame(i),!1)this.node.emit("spriteframe-changed",this)}},type:cc.SpriteFrame},type:{get:function(){return this._type},set:function(t){this._type=t,this._sgNode.setRenderingType(this._type),this._applyCapInset()},type:n,animatable:!1,tooltip:"i18n:COMPONENT.sprite.type"},fillType:{get:function(){return this._fillType},set:function(t){this._fillType=t,this._sgNode&&this._sgNode.setFillType(t)},type:r,tooltip:"i18n:COMPONENT.sprite.fill_type"},fillCenter:{get:function(){return this._fillCenter},set:function(t){this._fillCenter=cc.v2(t),this._sgNode&&this._sgNode.setFillCenter(this._fillCenter)},tooltip:"i18n:COMPONENT.sprite.fill_center"},fillStart:{get:function(){return this._fillStart},set:function(t){this._fillStart=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillStart(t)},tooltip:"i18n:COMPONENT.sprite.fill_start"},fillRange:{get:function(){return this._fillRange},set:function(t){this._fillRange=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillRange(t)},tooltip:"i18n:COMPONENT.sprite.fill_range"},trim:{get:function(){return this._isTrimmedMode},set:function(t){if(this._isTrimmedMode!==t)this._isTrimmedMode=t,this._sgNode.enableTrimmedContentSize(t)},animatable:!1,tooltip:"i18n:COMPONENT.sprite.trim"},srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:o,tooltip:"i18n:COMPONENT.sprite.src_blend_factor"},dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:o,tooltip:"i18n:COMPONENT.sprite.dst_blend_factor"},sizeMode:{get:function(){return this._sizeMode},set:function(t){if(this._sizeMode=t,t!==s.CUSTOM)this._applySpriteSize()},animatable:!1,type:s,tooltip:"i18n:COMPONENT.sprite.size_mode"}},statics:{FillType:r,Type:n,SizeMode:s},setVisible:function(t){this.enabled=t},getOriginalSize:function(){return this._sgNode.getOriginalSize()},setInsetLeft:function(t){this._sgNode.setInsetLeft(t)},getInsetLeft:function(){return this._sgNode.getInsetLeft()},setInsetTop:function(t){this._sgNode.setInsetTop(t)},getInsetTop:function(){return this._sgNode.getInsetTop()},setInsetRight:function(t){this._sgNode.setInsetRight(t)},getInsetRight:function(){return this._sgNode.getInsetRight()},setInsetBottom:function(t){this._sgNode.setInsetBottom(t)},getInsetBottom:function(){return this._sgNode.getInsetBottom()},onLoad:!1,onEnable:function(){if(this._sgNode)if(this._spriteFrame&&this._spriteFrame.textureLoaded())this._sgNode.setVisible(!0)},onDestroy:!1,_applyAtlas:!1,_applyCapInset:function(){if(this._type===n.SLICED&&this._spriteFrame){var t=this._sgNode;t.setInsetTop(this._spriteFrame.insetTop),t.setInsetBottom(this._spriteFrame.insetBottom),t.setInsetRight(this._spriteFrame.insetRight),t.setInsetLeft(this._spriteFrame.insetLeft)}},_applySpriteSize:function(){if(s.CUSTOM===this._sizeMode||!this._spriteFrame)this.node.setContentSize(this.node.getContentSize(!0));else if(s.RAW===this._sizeMode){var t=this._spriteFrame.getOriginalSize();this.node.setContentSize(t)}else if(s.TRIMMED===this._sizeMode){var e=this._spriteFrame.getRect();this.node.setContentSize(cc.size(e.width,e.height))}else this.node.setContentSize(this.node.getContentSize(!0))},_onSpriteFrameLoaded:function(t){var e=this,i=this._sgNode;if(i.setSpriteFrame(e._spriteFrame),e._applyCapInset(),e._applySpriteSize(),e.enabledInHierarchy&&!i.isVisible())i.setVisible(!0)},_applySpriteFrame:function(t){var e=this._sgNode;if(t&&t.off)t.off("load",this._onSpriteFrameLoaded,this);if(this._spriteFrame)if(this._spriteFrame.textureLoaded())this._onSpriteFrameLoaded(null);else this._spriteFrame.once("load",this._onSpriteFrameLoaded,this);else e.setVisible(!1);if(!1)this._applyAtlas(this._spriteFrame)},_createSgNode:function(){return new cc.Scale9Sprite},_initSgNode:function(){var t=this._sgNode;this._applySpriteFrame(null),t.setContentSize(this.node.getContentSize(!0)),this._applySpriteSize(),t.setRenderingType(this._type),t.setFillType(this._fillType),t.setFillCenter(this._fillCenter),t.setFillStart(this._fillStart),t.setFillRange(this._fillRange),t.enableTrimmedContentSize(this._isTrimmedMode),this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc)},_resized:!1}),a=t("../utils/misc"),h=["atlas","capInsets","insetLeft","insetTop","insetRight","insetBottom"],l={type:[null,"setRenderingType"]};a.propertyDefine(c,h,l),cc.Sprite=e.exports=c},{"../utils/misc":91,"./CCRendererUnderSG":46}],51:[function(t,e,i){var n=cc.Class({name:"cc.SpriteDistortion","extends":t("./CCComponent"),editor:!1,ctor:function(){this._spriteSGNode=null},properties:{_distortionOffset:cc.v2(0,0),offset:{get:function(){return this._distortionOffset},set:function(t){this._distortionOffset.x=t.x,this._distortionOffset.y=t.y}},_distortionTiling:cc.v2(1,1),tiling:{get:function(){return this._distortionTiling},set:function(t){this._distortionTiling.x=t.x,this._distortionTiling.y=t.y}}},onEnable:function(){var t=this.node.getComponent("cc.Sprite"),e=this._spriteSGNode=t&&t._sgNode;if(this._spriteSGNode)e.setState(cc.Scale9Sprite.state.DISTORTION),e._distortionOffset=this._distortionOffset,e._distortionTiling=this._distortionTiling},onDisable:function(){if(this._spriteSGNode)this._spriteSGNode.setState(cc.Scale9Sprite.state.NORMAL);this._spriteSGNode=null}});cc.SpriteDistortion=e.exports=n},{"./CCComponent":38}],52:[function(t,e,i){var n=1,r=2,o=4,s=8,c=16,a=32,h=n|o,l=s|a,u=cc.Class({name:"cc.Widget","extends":t("./CCComponent"),editor:!1,properties:{isAlignTop:{get:function(){return(this._alignFlags&n)>0},set:function(t){this._setAlign(n,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_top"},isAlignVerticalCenter:{get:function(){return(this._alignFlags&r)>0},set:function(t){if(t)this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=r;else this._alignFlags&=~r},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_v_center"},isAlignBottom:{get:function(){return(this._alignFlags&o)>0},set:function(t){this._setAlign(o,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_bottom"},isAlignLeft:{get:function(){return(this._alignFlags&s)>0},set:function(t){this._setAlign(s,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_left"},isAlignHorizontalCenter:{get:function(){return(this._alignFlags&c)>0},set:function(t){if(t)this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=c;else this._alignFlags&=~c},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_h_center"},isAlignRight:{get:function(){return(this._alignFlags&a)>0},set:function(t){this._setAlign(a,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_right"},isStretchWidth:{get:function(){return(this._alignFlags&l)===l},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&h)===h},visible:!1},top:{get:function(){return this._top},set:function(t){this._top=t},tooltip:"i18n:COMPONENT.widget.top"},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t},tooltip:"i18n:COMPONENT.widget.bottom"},left:{get:function(){return this._left},set:function(t){this._left=t},tooltip:"i18n:COMPONENT.widget.left"},right:{get:function(){return this._right},set:function(t){this._right=t},tooltip:"i18n:COMPONENT.widget.right"},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(t){this._isAbsTop=t},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(t){this._isAbsBottom=t},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(t){this._isAbsLeft=t},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(t){this._isAbsRight=t},animatable:!1},isAlignOnce:{"default":!1,tooltip:"i18n:COMPONENT.widget.align_once",displayName:"AlignOnce"},_alignFlags:0,_left:0,_right:0,_top:0,_bottom:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_originalWidth:0,_originalHeight:0},onEnable:function(){cc._widgetManager.add(this)},onDisable:function(){cc._widgetManager.remove(this)},_setAlign:function(t,e){var i=(this._alignFlags&t)>0;if(e!=i){var r=(t&l)>0;if(e){if(this._alignFlags|=t,r){if(this.isAlignHorizontalCenter=!1,this.isStretchWidth)if(this._originalWidth=this.node.width,false)_Scene.DetectConflict.checkConflict_Widget(this)}else if(this.isAlignVerticalCenter=!1,this.isStretchHeight)if(this._originalHeight=this.node.height,false)_Scene.DetectConflict.checkConflict_Widget(this);if(false){var c;if(t&n)c="top";else if(t&s)c="left";else if(t&a)c="right";else if(t&o)c="bottom";cc._widgetManager.updateOffsetsToStayPut(this,c)}}else{if(r){if(this.isStretchWidth)this.node.width=this._originalWidth}else if(this.isStretchHeight)this.node.height=this._originalHeight;this._alignFlags&=~t}}}});cc.Widget=e.exports=u},{"./CCComponent":38}],53:[function(t,e,i){t("./CCComponent"),t("./CCRendererInSG"),t("./CCRendererUnderSG"),t("./CCComponentEventHandler"),t("./missing-script"),e.exports=[t("./CCSprite"),t("./CCWidget"),t("./CCCanvas"),t("./CCAudioSource"),t("./CCAnimation"),t("./CCButton"),t("./CCLabel"),t("./CCProgressBar"),t("./CCMask"),t("./CCScrollBar"),t("./CCScrollView"),t("./CCLayout"),t("./CCEditBox"),t("./CCSpriteDistortion")]},{"./CCAnimation":34,"./CCAudioSource":35,"./CCButton":36,"./CCCanvas":37,"./CCComponent":38,"./CCComponentEventHandler":39,"./CCEditBox":40,"./CCLabel":41,"./CCLayout":42,"./CCMask":43,"./CCProgressBar":44,"./CCRendererInSG":45,"./CCRendererUnderSG":46,"./CCScrollBar":48,"./CCScrollView":49,"./CCSprite":50,"./CCSpriteDistortion":51,"./CCWidget":52,"./missing-script":54}],54:[function(t,e,i){var n=cc.js,r=cc.Class({name:"cc.MissingScript","extends":cc.Component,editor:{inspector:"app://editor/page/inspector/missing-script.html"},properties:{compiled:{"default":!1,serializable:!1},_$erialized:{"default":null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(t){var e=n._getClassById(t);if(e)return e;if(t)return r;else return null}},onLoad:function(){cc.warn('The referenced script on "%s" is missing!',this.name)}});cc._MissingScript=e.exports=r},{}],55:[function(t,e,i){function n(){o.call(this),this._invoking={},this._toRemove={},this._toRemoveAll=null}var r=cc.js,o=t("../platform/callbacks-invoker").CallbacksHandler;if(r.extend(n,o),n.prototype.invoke=function(t){var e,i,n,r,o,s=t.type,c=this._callbackTable[s];if(this._invoking[s]=!0,c)if(1===c.length)c[0].call(t.currentTarget,t);else for(i=c.length-1,e=0;i>=e;){n=c[e],r=c[e+1],o=r&&"object"==typeof r;var a;if(o)n.call(r,t),a=2;else n.call(t.currentTarget,t),a=1;if(t._propagationImmediateStopped||e+a>i)break;e+=a}this._invoking[s]=!1;var h=this._toRemove[s];if(h){for(e=0;e<h.length;++e){var l=h[e];this.remove(s,l[0],l[1])}delete this._toRemove[s]}if(this._toRemoveAll)this.removeAll(this._toRemoveAll),this._toRemoveAll=null},e.exports=n,!1)cc._Test.EventListeners=n},{"../platform/callbacks-invoker":75}],56:[function(t,e,i){var n=t("./event-listeners");t("./event");var r=cc.js,o=new Array(16);o.length=0;var s=function(t,e){var i,n;for(e.target=t,t._getCapturingTargets(e.type,o),e.eventPhase=1,n=o.length-1;n>=0;--n)if(i=o[n],i._isTargetActive(e.type)&&i._capturingListeners)if(e.currentTarget=i,i._capturingListeners.invoke(e),e._propagationStopped)return;if(o.length=0,t._isTargetActive(e.type))if(c(t,e),e._propagationStopped)return;if(e.bubbles)for(t._getBubblingTargets(e.type,o),e.eventPhase=3,n=0;n<o.length;++n)if(i=o[n],i._isTargetActive(e.type)&&i._bubblingListeners)if(e.currentTarget=i,i._bubblingListeners.invoke(e),e._propagationStopped)return;o.length=0;
},c=function(t,e){if(e.eventPhase=2,e.currentTarget=t,t._capturingListeners)if(t._capturingListeners.invoke(e),e._propagationStopped)return;if(t._bubblingListeners)t._bubblingListeners.invoke(e)},a=function(){this._capturingListeners=null,this._bubblingListeners=null};r.mixin(a.prototype,{hasEventListener:function(t){if(this._bubblingListeners&&this._bubblingListeners.has(t))return!0;if(this._capturingListeners&&this._capturingListeners.has(t))return!0;else return!1},on:function(t,e,i,r){if("boolean"==typeof i)r=i,i=void 0;else r=!!r;if(!e)return void cc.error("Callback of event must be non-nil");var o=null;if(r)o=this._capturingListeners=this._capturingListeners||new n;else o=this._bubblingListeners=this._bubblingListeners||new n;if(!o.has(t,e,i))if(o.add(t,e,i),i&&i.__eventTargets)i.__eventTargets.push(this);return e},off:function(t,e,i,n){if("boolean"==typeof i)n=i,i=void 0;else n=!!n;if(e){var r=n?this._capturingListeners:this._bubblingListeners;if(r)if(r.remove(t,e,i),i&&i.__eventTargets){var o=i.__eventTargets.indexOf(this);i.__eventTargets.splice(o,1)}}},targetOff:function(t){if(this._capturingListeners)this._capturingListeners.removeAll(t);if(this._bubblingListeners)this._bubblingListeners.removeAll(t)},once:function(t,e,i,n){var r=this,o=function(s){r.off(t,o,i,n),e.call(this,s)};this.on(t,o,i,n)},dispatchEvent:function(t){s(this,t),o.length=0;var e=!t._defaultPrevented;return e},emit:function(t,e){if("string"==typeof t){var i=new cc.Event.EventCustom(t);i.detail=e,c(this,i)}else cc.error("The message must be provided")},_isTargetActive:function(t){return!0},_getCapturingTargets:function(t,e){},_getBubblingTargets:function(t,e){}}),cc.EventTarget=e.exports=a},{"./event":134,"./event-listeners":55}],57:[function(t,e,i){t("./event.js"),t("./event-listeners.js"),t("./event-target.js")},{"./event-listeners.js":55,"./event-target.js":56,"./event.js":134}],58:[function(t,e,i){if(t("./platform"),t("./assets"),true){if(0)t("./sprites/CCSpriteFrameCache");t("./CCNode"),t("./CCScene"),t("./components")}t("./base-ui/CCWidgetManager")},{"./CCNode":20,"./CCScene":21,"./assets":32,"./base-ui/CCWidgetManager":33,"./components":53,"./platform":78,"./sprites/CCSpriteFrameCache":87}],59:[function(t,e,i){var n=t("../platform/js"),r=t("./pipeline"),o=t("./downloader"),s=t("./loader"),c=t("./asset-table"),a=t("../platform/utils").callInNextTick,h=new o,l=new s,u=new c;cc.loader=new r([h,l]),n.mixin(cc.loader,{downloader:h,loader:l,getXMLHttpRequest:r.getXMLHttpRequest,addDownloadHandlers:function(t){h.addHandlers(t)},addLoadHandlers:function(t){l.addHandlers(t)},load:function(t,e,i){function n(t){if(c[t.id]=t,t.error)s=s||[],s.push(t.id);l++,e&&e.call(r,l,h,t);for(var n in c)if(!c[n])return;if(i)if(o)i.call(r,t.error,t.content);else i.call(r,s,r._items);i=null}if("string"==typeof t&&t.startsWith("resources://"))return cc.warn('Sorry, the "resources://" protocol is obsoleted, use cc.loader.loadRes instead please.'),void this.loadRes(t.slice("resources://".length),e,i);if(void 0===i)i=e,e=null;var r=this,o=!1;if(!(t instanceof Array))t=t?[t]:[],o=!0;if(0!==t.length){for(var s=null,c={},h=0,l=0,u=0;u<t.length;++u){var f=t[u].id||t[u];if("string"==typeof f){var d=this._items.map[f];if(!d||d&&!d.complete)this._items.addListener(f,n),c[f]=null,h++;else if(d&&d.complete)c[f]=d,h++,l++}else;}if(h===l){var p=t[0].id||t[0],_=this._items.map[p];if(i)a(function(){if(o)i.call(r,_.error,_.content);else i.call(r,null,r._items);i=null})}else this.flowIn(t)}else if(i)a(function(){i.call(r,null,r._items),i=null})},_resources:u,_getResUuid:function(t){var e=u.getUuid(t);if(!e){var i=cc.path.extname(t);if(i)t=t.slice(0,-i.length),e=u.getUuid(t)}return e},loadRes:function(t,e){var i=this._getResUuid(t);if(i)this.load({id:i,type:"uuid",uuid:i},e);else a(function(){e.call(null,new Error('Resources url "'+t+'" does not exist.'),null)})},loadResAll:function(t,e){function i(t,i){if(!s){if(t)return s=!0,void e(t,null);if(o.push(i),--r,0===r)e(null,o)}}var n=u.getUuidArray(t),r=n.length;if(r>0)for(var o=[],s=!1,c=0,h=r;h>c;++c){var l=n[c];this.load({id:l,type:"uuid",uuid:l},i)}else a(function(){e.call(null,null,[])})},getRes:function(t){var e=this._items.getContent(t);if(!e){var i=this._getResUuid(t);e=this._items.getContent(i)}return e},getResCount:function(){return this._items.totalCount},release:function(t){this.removeItem(t)},releaseAsset:function(t){var e=t._uuid;if(e)this.removeItem(e)},releaseRes:function(t){var e=this._getResUuid(t);if(e)this.removeItem(e);else cc.error('Resources url "%s" does not exist.',t)},releaseAll:function(){this.clear()}}),e.exports=cc.loader},{"../platform/js":80,"../platform/utils":86,"./asset-table":60,"./downloader":61,"./loader":63,"./pipeline":65}],60:[function(t,e,i){function n(){this._pathToUuid={}}cc.js.mixin(n.prototype,{getUuid:function(t){if(t=cc.url.normalize(t),!t)return"";var e=this._pathToUuid[t];if(e)return e;else return""},getUuidArray:function(t){if(t=cc.url.normalize(t),!t)return[];var e=[],i=this._pathToUuid;for(var n in i)if(n.startsWith(t))e.push(i[n]);return e},getAllPaths:function(){return Object.keys(this._pathToUuid)},add:function(t,e){this._pathToUuid[t]=e},_removeByPath:function(t){delete this._pathToUuid[t]}}),e.exports=n},{}],61:[function(t,e,i){function n(t){if(cc.game.config.noCache&&"string"==typeof t)if(p.test(t))t+="&_t="+(new Date-0);else t+="?_t="+(new Date-0);return t}function r(t,e,i){function r(){a.parentNode.removeChild(a),a.removeEventListener("load",r,!1),a.removeEventListener("error",o,!1),e(null,s)}function o(){a.parentNode.removeChild(a),a.removeEventListener("load",r,!1),a.removeEventListener("error",o,!1),e(new Error("Load "+s+" failed!"),s)}var s=t.url,c=document,a=document.createElement("script");a.async=i,a.src=n(s),a.addEventListener("load",r,!1),a.addEventListener("error",o,!1),c.body.appendChild(a)}function o(t,e){var i=t.url,r=d.getXMLHttpRequest(),o="Load "+i+" failed!",s=window.navigator;if(i=n(i),r.open("GET",i,!0),/msie/i.test(s.userAgent)&&!/opera/i.test(s.userAgent))r.setRequestHeader("Accept-Charset","utf-8"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status||0===r.status)e(null,r.responseText);else e({status:r.status,errorMessage:o})};else{if(r.overrideMimeType)r.overrideMimeType("text/plain; charset=utf-8");r.onload=function(){if(4===r.readyState)if(200===r.status||0===r.status)e(null,r.responseText);else e({status:r.status,errorMessage:o})},r.onerror=function(){e({status:r.status,errorMessage:o})}}r.send(null)}function s(t,e,i){function r(){if(a.removeEventListener("load",r),a.removeEventListener("error",o),e)e(null,a)}function o(){if(a.removeEventListener("load",r),a.removeEventListener("error",o),a.crossOrigin&&"anonymous"===a.crossOrigin.toLowerCase())s(c,e,!1);else e("Load image ("+c+") failed")}if(void 0===i)i=!0;var c=n(t.url),a=new Image;if(i&&"file://"!==window.location.origin)a.crossOrigin="anonymous";if(a.complete&&a.naturalWidth>0)e(null,a);else a.addEventListener("load",r),a.addEventListener("error",o);a.src=c}function c(t,e,i){var n=document,r=cc.path,o=document.createElement("style");o.type="text/css",n.body.appendChild(o);var s="";if(isNaN(t-0))s+="@font-face { font-family:"+t+"; src:";else s+="@font-face { font-family:'"+t+"'; src:";if(e instanceof Array)for(var c=0,a=e.length;a>c;c++){var h=e[c];i=r.extname(h).toLowerCase(),s+="url('"+e[c]+"') format('"+_[i]+"')",s+=c===a-1?";":","}else i=i.toLowerCase(),s+="url('"+e+"') format('"+_[i]+"');";o.textContent+=s+"}";var l=document.createElement("div"),u=l.style;u.fontFamily=t,l.innerHTML=".",u.position="absolute",u.left="-100px",u.top="-100px",n.body.appendChild(l)}function a(t,e){var i=t.url,n=t.type,r=t.name,o=t.srcs;if(r&&o){if(-1===o.indexOf(i))o.push(i);c(r,o)}else n=cc.path.extname(i),r=cc.path.basename(i,n),c(r,i,n);if(document.fonts)document.fonts.load("1em "+r).then(function(){e(null,null)},function(t){e(t)});else e(null,null)}function h(t,e){var i=t.id,n=this;cc.AssetLibrary.queryAssetInfo(i,function(r,o,s){if(r)e(r);else if(t.url=o,t.isRawAsset=s,s){var c=f.extname(o).toLowerCase();if(!c)return void e(new Error("Download Uuid: can not find type of raw asset["+i+"]: "+o));c=c.substr(1);var a=n.extMap[c]||n.extMap["default"];t.type=c,a(t,e)}else n.extMap.json(t,e)})}var l,u=t("../platform/js"),f=t("../utils/CCPath"),d=t("./pipeline");if(true)l=t("./audio-downloader");else l=null;var p=/\?/,_={".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},g={js:r,png:s,jpg:s,bmp:s,jpeg:s,gif:s,ico:s,tiff:s,webp:s,image:s,mp3:l,ogg:l,wav:l,mp4:l,m4a:l,txt:o,xml:o,vsh:o,fsh:o,atlas:o,tmx:o,tsx:o,json:o,ExportJson:o,plist:o,fnt:o,font:a,eot:a,ttf:a,woff:a,svg:a,ttc:a,uuid:h,prefab:h,fire:h,scene:h,"default":o},v="Downloader",m=function(t){this.id=v,this.async=!0,this.pipeline=null,this.maxConcurrent=2,this._curConcurrent=0,this._loadQueue=[],this.extMap=u.mixin(t,g)};m.ID=v,u.mixin(m.prototype,{addHandlers:function(t){this.extMap=u.mixin(this.extMap,t)},handle:function(t,e){var i=this,n=this.extMap[t.type]||this.extMap["default"];if(this._curConcurrent<this.maxConcurrent){if(cc.sys.isMobile)this._curConcurrent++;n.call(this,t,function(t,n){if(cc.sys.isMobile)for(i._curConcurrent=Math.max(0,i._curConcurrent-1);i._curConcurrent<i.maxConcurrent;){var r=i._loadQueue.shift();if(!r)break;i.handle(r.item,r.callback)}e&&e(t,n)})}else this._loadQueue.push({item:t,callback:e})}}),d.Downloader=e.exports=m},{"../platform/js":80,"../utils/CCPath":88,"./audio-downloader":134,"./pipeline":65}],62:[function(t,e,i){t("./downloader"),t("./loader"),t("./loading-items"),t("./pipeline"),t("./CCLoader")},{"./CCLoader":59,"./downloader":61,"./loader":63,"./loading-items":64,"./pipeline":65}],63:[function(t,e,i){function n(t,e){e(null,null)}function r(t,e){if("string"!=typeof t.content)e(new Error("JSON Loader: Input item doesn't contain string content"));try{var i=JSON.parse(t.content);e(null,i)}catch(n){e(new Error("JSON Loader: Parse json ["+t.id+"] failed : "+n))}}function o(t,e){if(!(t.content instanceof Image))e(new Error("Image Loader: Input item doesn't contain Image content"));var i=t.url,n=cc.textureCache.getTextureForKey(i)||new u;n.url=i,n.initWithElement(t.content),n.handleLoadedTexture(),cc.textureCache.cacheImage(i,n),e(null,n)}function s(t,e){if("string"!=typeof t.content)e(new Error("Plist Loader: Input item doesn't contain string content"));var i=cc.plistParser.parse(t.content);if(i)e(null,i);else e(new Error("Plist Loader: Parse ["+t.id+"] failed"))}function c(t){var e=t.match(d.ITEM_EXP),i={};if(e)for(var n=0,r=e.length;r>n;n++){var o=e[n],s=o.indexOf("="),c=o.substring(0,s),a=o.substring(s+1);if(a.match(d.INT_EXP))a=parseInt(a);else if('"'===a[0])a=a.substring(1,a.length-1);i[c]=a}return i}function a(t,e){var i,n,r=t.content,o=t.url,s={},a=c(r.match(d.INFO_EXP)[0]),h=a.padding.split(","),l=({left:parseInt(h[0]),top:parseInt(h[1]),right:parseInt(h[2]),bottom:parseInt(h[3])},c(r.match(d.COMMON_EXP)[0]));if(s.commonHeight=l.lineHeight,s.fontSize=a.size,cc._renderType===cc.game.RENDER_TYPE_WEBGL){var u=cc.configuration.getMaxTextureSize();if(l.scaleW>u.width||l.scaleH>u.height)cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}if(1!==l.pages)cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");var f=c(r.match(d.PAGE_EXP)[0]);if(0!==f.id)cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found");s.atlasName=cc.path.changeBasename(o,f.file);var p=r.match(d.CHAR_EXP),_=s.fontDefDictionary={};for(i=0,n=p.length;n>i;i++){var g=c(p[i]),v=g.id;_[v]={rect:{x:g.x,y:g.y,width:g.width,height:g.height},xOffset:g.xoffset,yOffset:g.yoffset,xAdvance:g.xadvance}}var m=s.kerningDict={},y=r.match(d.KERNING_EXP);if(y)for(i=0,n=y.length;n>i;i++){var b=c(y[i]);m[b.first<<16|65535&b.second]=b.amount}e(null,s)}var h=t("../platform/js"),l=t("./pipeline"),u=t("../textures/CCTexture2D"),f=t("./uuid-loader"),d={INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/},p={png:o,jpg:o,bmp:o,jpeg:o,gif:o,ico:o,tiff:o,webp:o,image:o,json:r,ExportJson:r,plist:s,fnt:a,uuid:f,prefab:f,fire:f,scene:f,"default":n},_="Loader",g=function(t){this.id=_,this.async=!0,this.pipeline=null,this.extMap=h.mixin(t,p)};g.ID=_,h.mixin(g.prototype,{addHandlers:function(t){this.extMap=h.mixin(this.extMap,t)},handle:function(t,e){var i=this.extMap[t.type]||this.extMap["default"];i.call(this,t,function(t,i){if(t)e&&e(t);else e&&e(null,i)})}}),l.Loader=e.exports=g},{"../platform/js":80,"../textures/CCTexture2D":134,"./pipeline":65,"./uuid-loader":66}],64:[function(t,e,i){var n=t("../platform/callbacks-invoker"),r=t("../platform/js"),o=function(){n.call(this),this.map={},this.completed={},this.totalCount=0,this.completedCount=0};r.mixin(o.prototype,n.prototype,{append:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i],r=n.id;if(!this.map[r])this.map[n.id]=n,e.push(n)}return this.totalCount+=e.length,e},isCompleted:function(){return this.completedCount>=this.totalCount},isItemCompleted:function(t){return!!this.completed[t]},exists:function(t){return!!this.map[t]},getContent:function(t){var e=this.map[t];return e?e.content:null},getError:function(t){var e=this.map[t];return e?e.error:null},addListener:n.prototype.add,hasListener:n.prototype.has,removeListener:n.prototype.remove,removeAllListeners:n.prototype.removeAll,removeItem:function(t){if(this.completed[t])delete this.completed[t],delete this.map[t],this.completedCount--,this.totalCount--},complete:function(t){if(this.map[t]&&!this.completed[t]){var e=this.map[t];e.complete=!0,this.completed[t]=e,this.completedCount++}}}),e.exports=o},{"../platform/callbacks-invoker":75,"../platform/js":80}],65:[function(t,e,i){function n(t){var e=this.id,i=t.states[e],n=this.next;if(!t.error&&i!==u.WORKING&&i!==u.ERROR)if(i===u.COMPLETE)if(n)n.flowIn(t);else this.pipeline.flowOut(t);else{t.states[e]=u.WORKING;var r=this;this.handle(t,function(i,o){if(i)t.error=i,t.states[e]=u.ERROR,r.pipeline.flowOut(t);else{if(o)t.content=o;if(t.states[e]=u.COMPLETE,n)n.flowIn(t);else r.pipeline.flowOut(t)}})}}function r(t){var e=this.id,i=t.states[e],n=this.next;if(!t.error&&i!==u.WORKING&&i!==u.ERROR)if(i===u.COMPLETE)if(n)n.flowIn(t);else this.pipeline.flowOut(t);else{t.states[e]=u.WORKING;var r=this.handle(t);if(r instanceof Error)t.error=r,t.states[e]=u.ERROR,this.pipeline.flowOut(t);else{if(r)t.content=r;if(t.states[e]=u.COMPLETE,n)n.flowIn(t);else this.pipeline.flowOut(t)}}}function o(t){var e=t.id||t;return"string"==typeof e}function s(t){var e;if("object"==typeof t&&t.id){if(!t.type)t.type=h.extname(t.id).toLowerCase().substr(1);e={url:t.url||t.id,error:null,content:null,complete:!1,states:{}},a.mixin(e,t)}else if("string"==typeof t)e={id:t,url:t,type:h.extname(t).toLowerCase().substr(1),error:null,content:null,complete:!1,states:{}};if(e.skips)for(var i=0,n=e.skips.length;n>i;i++){var r=e.skips[i];e.states[r]=u.COMPLETE}return e}function c(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")}var a=t("../platform/js"),h=t("../utils/CCPath"),l=t("./loading-items"),u={WORKING:1,COMPLETE:2,ERROR:3},f=function(t){this._pipes=t,this._items=new l,this._errorUrls=[],this._flowing=!1;for(var e=0;e<t.length;++e){var i=t[e];if(i.handle&&i.id)i.pipeline=this,i.next=e<t.length-1?t[e+1]:null,i.flowIn=i.async?n:r;else;}};f.ItemState=new cc.Enum(u),f.getXMLHttpRequest=c,a.mixin(f.prototype,{insertPipe:function(t,e){if(t.handle&&t.id)if(t.pipeline=this,t.flowIn=t.async?n:r,e<this._pipes.length)t.next=this._pipes[e],this._pipes.splice(e,0,t);else t.next=null,this._pipes.push(t)},appendPipe:function(t){if(t.handle&&t.id)t.pipeline=this,t.next=null,t.flowIn=t.async?n:r,this._pipes.push(t)},flowIn:function(t){var e,i,n,r=[];for(e=0;e<t.length;++e)if(i=t[e],o(i))n=s(i),r.push(n);else throw new Error("Pipeline flowIn: Invalid url: "+(i.id||i));var c=this._items.append(r);if(0===this._pipes.length||0===c.length)return this.complete(),c;this._flowing=!0;var a=this._pipes[0];if(a)for(e=0;e<c.length;e++)a.flowIn(c[e]);return c},flowInDeps:function(t,e){function i(t){n[t.id]=t;for(var i in n)if(!n[i])return;e&&e.call(this,n),e=null}for(var n={},r=0,o=this._items,s=0;s<t.length;++s){var c=t[s].id||t[s];if("string"==typeof c&&!n[c]){var a=o.map[c];if(!a)o.addListener(c,i),n[c]=null,r++;else n[c]=a}else;}if(0===r)e&&e.call(this,n),e=null;return this.flowIn(t)},complete:function(){if(this._items.isCompleted()){this._flowing=!1;var t=0===this._errorUrls.length?null:this._errorUrls;if(this.onComplete)this.onComplete(t,this._items);for(var e=0;e<this._errorUrls.length;++e){var i=this._errorUrls[e];this._items.removeItem(i)}this._errorUrls=[]}},flowOut:function(t){var e=t.id,i=this._items,n=i.map[e];if(n&&!n.complete){var r=this._errorUrls.indexOf(e);if(t.error&&-1===r)this._errorUrls.push(e);else if(!t.error&&-1!==r)this._errorUrls.splice(r,1);i.complete(t.id),this.onProgress&&this.onProgress(i.completedCount,i.totalCount,t),this.complete(),i.invokeAndRemove(e,t)}},copyItemStates:function(t,e){if(!(e instanceof Array))return void(e.states=t.states);for(var i=0;i<e.length;++i)e[i].states=t.states},isFlowing:function(){return this._flowing},getItems:function(){return this._items},getItem:function(t){return this._items.map[t]},removeItem:function(t){var e=this._items.map[t];if(e){if(!e.complete)e.error=new Error("Canceled manually"),this.flowOut(e);this._items.removeItem(t)}else return!1},clear:function(){if(this._flowing){var t=this._items.map;for(var e in t){var i=t[e];if(!i.complete)i.error=new Error("Canceled manually"),this.flowOut(i)}}this._items=new l,this._errorUrls=[],this._flowing=!1},onProgress:null,onComplete:null}),cc.Pipeline=e.exports=f},{"../platform/js":80,"../utils/CCPath":88,"./loading-items":64}],66:[function(t,e,i){function n(t,e,i,n,r){for(var s=e.id,c=e.url,a=o.array.copy(n.uuidList),h=o.array.copy(n.uuidObjList),l=o.array.copy(n.uuidPropList),u=new Array(a.length),f=0;f<a.length;f++){var d=a[f];u[f]={id:d,type:"uuid",uuid:d}}if(n.rawProp)a.push(c),h.push(i),l.push(n.rawProp),u.push(c);if(u.length>0)t.flowInDeps(u,function(e){var n;for(var o in e)if(n=e[o],n.uuid&&n.content)n.content._uuid=n.uuid;for(var c=0;c<a.length;c++){var u=a[c],f=h[c],d=l[c];if(n=e[u])if(n.complete){var p=n.isRawAsset?n.url:n.content;f[d]=p}else{var _=function(t){var e=t.isRawAsset?t.url:t.content;this.obj[this.prop]=e},g={obj:f,prop:d},v=t.getItems()._callbackTable[u];if(v)v.unshift(_,g);else t.getItems().add(u,_,g)}}i._uuid=s,r(null,i)});else i._uuid=s,r(null,i);n.reset()}function r(t,e){var i;if("string"==typeof t.content)try{i=JSON.parse(t.content)}catch(r){return void e(new Error("Uuid Loader: Parse asset ["+t.id+"] failed : "+r.stack))}else if("object"==typeof t.content)i=t.content;else return void e(new Error("JSON Loader: Input item doesn't contain string content"));var h,l=i&&(i[0]&&i[0].__type__===c||i[1]&&i[1].__type__===c||i[0]&&i[0].__type__===a),u=l?cc._MissingScript.safeFindClass:function(t){var e=o._getClassById(t);if(e)return e;else return cc.warn('Can not get class "%s"',t),Object},f=cc.sys.isNative?new cc.deserialize.Details:t.deserializeInfo||s;try{h=cc.deserialize(i,f,{classFinder:u,target:t.existingAsset})}catch(r){return void e(new Error("Uuid Loader: Deserialize asset ["+t.id+"] failed : "+r.stack))}n(this.pipeline,t,h,f,e)}var o=t("../platform/js");t("../platform/deserialize");var s=new cc.deserialize.Details,c="cc.Scene",a="cc.Prefab";e.exports=r},{"../platform/deserialize":76,"../platform/js":80}],67:[function(t,e,i){function n(t){return t&&(t.constructor===cc.SceneAsset||t instanceof cc.Scene)}var r,o=t("../assets/CCAsset"),s=t("./utils").callInNextTick,c=t("../load-pipeline/CCLoader"),a="",h="",l={loadAsset:function(t,e,i){var n={id:t,type:"uuid"};if(i&&i.deserializeInfo)n.deserializeInfo=i.deserializeInfo;if(i&&i.existingAsset)n.existingAsset=i.existingAsset;this._loadAssetByUuid(n,e)},getImportedDir:function(t){return a+t.slice(0,2)},_queryAssetInfoInEditor:function(t,e){if(!1)Editor.sendRequestToCore("scene:query-asset-info-by-uuid",t,function(i){if(i){Editor.UuidCache.cache(i.url,t);var n=Editor.assets[i.type];if(n){var r=!cc.isChildClassOf(n,o);e(null,i.url,r,n)}else e(new Error("Can not find asset type "+i.type))}else e(new Error("Can not get asset url by uuid "+t))})},_getAssetInfoInRuntime:function(t){var e=r[t];if(e&&e.raw)return{url:h+e.url,raw:!0};else{var i=this.getImportedDir(t)+"/"+t+".json";return{url:i,raw:!1}}},queryAssetInfo:function(t,e){if(false)this._queryAssetInfoInEditor(t,e);else{var i=this._getAssetInfoInRuntime(t);e(null,i.url,i.raw)}},parseUuidInEditor:function(t){if(!1){var e="",i=t.startsWith(a);if(i){var n=cc.path.dirname(t),r=cc.path.basename(n),o=2===r.length;if(o){e=cc.path.basename(t);var s=e.indexOf(".");if(-1!==s)e=e.slice(0,s)}else e=r}return e}},_loadAssetByUuid:function(t,e){var i=t.id,r=!0;if("string"!=typeof i)return s(e,new Error("[AssetLibrary] uuid must be string"),null);else return c.load(t,function(t,o){if(t||!o)t=new Error("[AssetLibrary] loading JSON or dependencies failed: "+t.message);if(r)s(function(){if(n(o))c.removeItem(i);e(t,o)});else{if(n(o))c.removeItem(i);e(t,o)}}),void(r=!1)},loadJson:function(t,e){var i=""+((new Date).getTime()+Math.random()),r=!0,o={id:i,type:"uuid",content:t,skips:[c.downloader.id]};c.load(o,function(t,o){if(t)t=new Error("[AssetLibrary] loading JSON or dependencies failed: "+t.message);if(r)s(function(){if(n(o))c.removeItem(i);o._uuid="",e(t,o)});else{if(n(o))c.removeItem(i);o._uuid="",e(t,o)}}),r=!1},getAssetByUuid:function(t){return l._uuidToAsset[t]||null},init:function(t){if(false)return void cc.error("AssetLibrary has already been initialized!");var e=t.libraryPath;e=e.replace(/\\/g,"/"),a=cc.path._setEndWithSep(e,"/"),h=t.rawAssetsBase,r={};var i=t.rawAssets;if(i){var n="resources/";for(var o in i){var s=i[o];for(var l in s){var u=s[l],f=u.url,d=u.raw;if(r[l]={url:o+"/"+f,raw:!!d},"assets"===o&&f.startsWith(n)){if(!d){var p=cc.path.extname(f);if(p)f=f.slice(n.length,-p.length);else f=f.slice(n.length)}else f=f.slice(n.length);c._resources.add(f,l)}}}}var _=t.mountPaths;if(!_)_={assets:h+"assets",internal:h+"internal"};cc.url._init(_)}};l._uuidToAsset={},cc.AssetLibrary=l},{"../assets/CCAsset":22,"../load-pipeline/CCLoader":59,"./utils":86}],68:[function(require,module,exports){function appendProp(t,e){if(!1)if(-1!==e.indexOf("."))return void cc.error('Disallow to use "." in property name');var i=t.__props__.indexOf(e);if(0>i)t.__props__.push(e)}function defineProp(t,e,i,n,r){if(!1){if("object"==typeof n&&n)if(Array.isArray(n)){if(n.length>0)return void cc.error('Default array must be empty, set default value of %s.%s to [], and initialize in "onLoad" or "ctor" please. (just like "this.%s = [...];")',e,i,i)}else if(!_isPlainEmptyObj_DEV(n))if(!_cloneable_DEV(n))return void cc.error('Do not set default value to non-empty object, unless the object defines its own "clone" function. Set default value of %s.%s to null or {}, and initialize in "onLoad" or "ctor" please. (just like "this.%s = {foo: bar};")',e,i,i);for(var o=t.$super;o;o=o.$super)if(o.prototype.hasOwnProperty(i))return void cc.error("Can not declare %s.%s, it is already defined in the prototype of %s",e,i,e)}if(Attr.attr(t,i,{"default":n}),appendProp(t,i),r){for(var s=null,c=0;c<r.length;c++){var a=r[c];if(Attr.attr(t,i,a),a._onAfterProp)s=s||[],s.push(a._onAfterProp)}if(s)for(var h=0;h<s.length;h++)s[h](t,i)}}function defineGetSet(t,e,i,n,r){var o=n.get,s=n.set,c=t.prototype,a=Object.getOwnPropertyDescriptor(c,i);if(o){if(a&&a.get,!1)return void cc.error('"%s": the getter of "%s" is already defined!',e,i);if(r)for(var h=0;h<r.length;++h){var l=r[h];if(l._canUsedInGetter===!1,1){if(Attr.attr(t,i,l),l.serializable===!1||l.editorOnly===!0,!1)cc.warn('No need to use "serializable: false" or "editorOnly: true" for the getter of "%s.%s", every getter is actually non-serialized.',e,i)}else cc.error('Can not apply the specified attribute to the getter of "%s.%s", attribute index: %s',e,i,h)}var u=!1;if(!u)Attr.attr(t,i,Attr.NonSerialized);if(u)appendProp(t,i);if(a)Object.defineProperty(c,i,{get:o});else Object.defineProperty(c,i,{get:o,configurable:!0,enumerable:!0});if(!1)Attr.attr(t,i,{hasGetter:!0})}if(s)if(!1){if(a&&a.set)return cc.error('"%s": the setter of "%s" is already defined!',e,i);Object.defineProperty(c,i,{set:s,configurable:!0,enumerable:!0}),Attr.attr(t,i,{hasSetter:!0})}else if(a)Object.defineProperty(c,i,{set:s});else Object.defineProperty(c,i,{set:s,configurable:!0,enumerable:!0})}function getDefault(t){if("function"==typeof t)if(!1)try{return t()}catch(e){return void cc._throw(e)}else return t();return t}function instantiateProps(t,e){var i=e.__props__;if(null===i)deferredInitializer.init(),i=e.__props__;for(var n=0;n<i.length;n++){var r=i[n],o=Attr.attr(e,r);if(o&&o.hasOwnProperty("default")){var s=o["default"];if(s)if("object"==typeof s&&s)if("function"==typeof s.clone)s=s.clone();else if(Array.isArray(s))s=[];else s={};else if("function"==typeof s)s=getDefault(s);t[r]=s}}}function doDefine(t,e,i,n,r){var o=_createCtor(n,e,i,t,r);if(Object.defineProperty(o,"extend",{value:function(t){return t["extends"]=this,CCClass(t)},writable:!0,configurable:!0}),e)JS.extend(o,e),o.$super=e;if(i){for(var s=0;s<i.length;++s){var c=i[s];JS.mixin(o.prototype,c.prototype);for(var a in c)if(c.hasOwnProperty(a)&&INVALID_STATICS.indexOf(a)<0)o[a]=c[a]}o.prototype.constructor=o}return JS.setClassName(t,o),o}function define(t,e,i,n,r){if(cc.isChildClassOf(e,cc.Component)){var o=cc._RFpeek();if(o){if(false)cc.warn("cc.Class: Should not define constructor for cc.Component.");if(o.beh)return void cc.error("Each script can have at most one Component.");var s=o.uuid;if(s)if(false)cc.warn("Should not specify class name for Component which defines in project.");t=t||o.script;var c=doDefine(t,e,i,n,r);if(s)if(JS._setClassId(s,c),!1)cc.Component._addMenuItem(c,"i18n:MAIN_MENU.component.scripts/"+t,-1),c.prototype.__scriptUuid=Editor.UuidUtils.decompressUuid(s);return o.beh=c,c}}return doDefine(t,e,i,n,r)}function _checkCtor(t){if(!1){if(CCClass._isCCClass(t))return void cc.error("Constructor can not be another CCClass");if("function"!=typeof t)return void cc.error("Constructor of CCClass must be function type");if(t.length>0)return void cc.warn("Can not instantiate CCClass with arguments.")}}function normalizeClassName(className){if(!1){var DefaultName="CCClass";if(className){if(className=className.replace(/\./g,"_"),className=className.split("").filter(function(t){return/^[a-zA-Z0-9_$]/.test(t)}).join(""),/^[0-9]/.test(className[0]))className="_"+className;try{eval("function "+className+"(){}")}catch(e){className="FireClass_"+className;try{eval("function "+className+"(){}")}catch(e){return DefaultName}}return className}return DefaultName}}function _createCtor(ctor,baseClass,mixins,className,options){var useTryCatch=!(className&&className.startsWith("cc.")),shouldAddProtoCtor;if(false){var originCtor=ctor;if(SuperCallReg.test(ctor))cc.warn(cc._LogInfos.Editor.Class.callSuperCtor,className),ctor=function(){this._super=function(){};var t=originCtor.apply(this,arguments);return this._super=null,t};if(/\bprototype.ctor\b/.test(originCtor))cc.warn(cc._LogInfos.Editor.Class.callSuperCtor,className),shouldAddProtoCtor=!0}var superCallBounded=options&&baseClass&&boundSuperCalls(baseClass,options);if(false)_checkCtor(ctor);for(var ctors=[],baseOrMixins=[baseClass].concat(mixins),b=0;b<baseOrMixins.length;b++){var baseOrMixin=baseOrMixins[b];if(baseOrMixin)if(CCClass._isCCClass(baseOrMixin)){var baseCtors=baseOrMixin.__ctors__;if(baseCtors)ctors=ctors.concat(baseCtors)}else if(baseOrMixin)ctors.push(baseOrMixin)}if(ctor)ctors.push(ctor);var body;if(!1)body="(function "+normalizeClassName(className)+"(){\n";else body="(function(){\n";if(superCallBounded)body+="this._super=null;\n";if(body+="instantiateProps(this,fireClass);\n",ctors.length>0){if(body+="var cs=fireClass.__ctors__;\n",useTryCatch)body+="try{\n";if(ctors.length<=5)for(var i=0;i<ctors.length;i++)body+="(cs["+i+"]).apply(this,arguments);\n";else body+="for(var i=0,l=cs.length;i<l;++i){\n",body+="(cs[i]).apply(this,arguments);\n}\n";if(useTryCatch)body+="}catch(e){\ncc._throw(e);\n}\n"}body+="})";var fireClass=eval(body);if(Object.defineProperty(fireClass,"__ctors__",{value:ctors.length>0?ctors:null}),false)fireClass.prototype.ctor=function(){};return fireClass}function _boundSuperCall(t,e,i){var n=null,r=JS.getPropertyDescriptor(i.prototype,e);if(r)if(n=r.value,"function"==typeof n){var o=SuperCallReg.test(t);if(o)return function(){var e=this._super;this._super=n;var i=t.apply(this,arguments);return this._super=e,i}}return null}function boundSuperCalls(t,e){var i=!1;for(var n in e)if(BUILTIN_ENTRIES.indexOf(n)<0){var r=e[n];if("function"==typeof r){var o=_boundSuperCall(r,n,t);if(o)i=!0,e[n]=o}}return i}function declareProperties(t,e,i,n,r){if(t.__props__=[],n&&n.__props__)t.__props__=n.__props__.slice();if(r)for(var o=0;o<r.length;++o){var s=r[o];if(s.__props__)t.__props__=t.__props__.concat(s.__props__.filter(function(e){return t.__props__.indexOf(e)<0}))}if(i){preprocessAttrs(i,e,t);for(var c in i){var a=i[c],h=parseAttributes(a,e,c);if("default"in a)defineProp(t,e,c,a["default"],h);else defineGetSet(t,e,c,a,h)}}}function CCClass(t){if(0===arguments.length)return define();if(!t)return cc.error("cc.Class: Option must be non-nil"),define();var e,i=t.name,n=t["extends"],r=t.mixins;if(e=define(i,n,r,t.ctor,t),!i)i=cc.js.getClassName(e);var o=t.properties;if("function"==typeof o||n&&null===n.__props__||r&&r.some(function(t){return null===t.__props__}))deferredInitializer.push({cls:e,props:o,mixins:r}),e.__props__=null;else declareProperties(e,i,o,n,t.mixins);var s=t.statics;if(s){var c;if(!1)for(c in s)if(-1===INVALID_STATICS.indexOf(c));else cc.error('Cannot define %s.%s because static member name can not be "%s".',i,c,c);for(c in s)e[c]=s[c]}for(var a in t)if(!(BUILTIN_ENTRIES.indexOf(a)>=0))if(!0){var h=t[a];if("function"==typeof h||null===h)Object.defineProperty(e.prototype,a,{value:h,enumerable:!0,configurable:!0,writable:!0});else if(!1){var l=TYPO_TO_CORRECT[a];if(l)cc.warn('Unknown type of %s.%s, maybe you want is "%s".',i,a,l);else if(h)cc.error('Unknown type of %s.%s, property should be defined in "properties" or "ctor"',i,a)}}else cc.error('Can not define a member called "constructor" in the class "%s", please use "ctor" instead.',i);else;if(!1){var u=t.editor;if(u)if(cc.isChildClassOf(n,cc.Component))cc.Component._registerEditorProps(e,u);else cc.warn('Can not use "editor" attribute, "%s" not inherits from Components.',i)}return e}function parseAttributes(t,e,i){function n(n,r,s){var c=t[n];if(c)if(typeof c===r)if("undefined"==typeof s){var a={};a[n]=c,o.push(a)}else o.push("function"==typeof s?s(c):s);else if(!1)cc.error("The %s of %s.%s must be type %s",n,e,i,r)}var r=!1?"The %s of %s must be type %s":"";tmpAttrs.length=0;var o=tmpAttrs,s=t.type;if(s)switch(s){case"Integer":o.push({type:"Integer"});break;case"Float":o.push({type:"Float"});break;case"Boolean":o.push({type:"Boolean",_onAfterProp:getTypeChecker("Boolean","Boolean")});break;case"String":o.push({type:"String",_onAfterProp:getTypeChecker("String","String")});break;case"Object":if(!1)cc.error('Please define "type" parameter of %s.%s as the actual constructor.',e,i);break;default:if(s===Attr.ScriptUuid){var c=Attr.ObjectType(cc.ScriptAsset);c.type="Script",o.push(c)}else if("object"==typeof s){if(Enum.isEnum(s))o.push({type:"Enum",enumList:Enum.getList(s)});else if(!1)cc.error('Please define "type" parameter of %s.%s as the constructor of %s.',e,i,s)}else if("function"==typeof s)o.push(Attr.ObjectType(s));else if(!1)cc.error('Unknown "type" parameter of %s.%s：%s',e,i,s)}if(n("rawType","string",Attr.RawType),n("editorOnly","boolean",Attr.EditorOnly),
!1)n("displayName","string"),n("multiline","boolean",{multiline:!0}),n("readonly","boolean",{readonly:!0}),n("tooltip","string");if(t.url)o.push({saveUrlAsAsset:!0});if(t.serializable===!1)o.push(Attr.NonSerialized);if(!1)if("animatable"in t&&!t.animatable)o.push({animatable:!1});if(!1){var a=t.visible;if("undefined"!=typeof a){if(!t.visible)o.push({visible:!1})}else{var h=95===i.charCodeAt(0);if(h)o.push({visible:!1})}}var l=t.range;if(l)if(Array.isArray(l)){if(l.length>=2)o.push(Attr.Range(l[0],l[1]));else if(!1)cc.error("The length of range array must be 2")}else if(!1)cc.error(r,'"range"',e+"."+i,"array");return o}var JS=require("./js"),Enum=require("../value-types/CCEnum"),Utils=require("./utils"),_isPlainEmptyObj_DEV=Utils.isPlainEmptyObj_DEV,_cloneable_DEV=Utils.cloneable_DEV,Attr=require("./attribute"),getTypeChecker=Attr.getTypeChecker,preprocessAttrs=require("./preprocess-attrs"),BUILTIN_ENTRIES=["name","extends","mixins","ctor","properties","statics","editor"],TYPO_TO_CORRECT=!1,INVALID_STATICS=!1,deferredInitializer={datas:null,push:function(t){if(this.datas)this.datas.push(t);else{this.datas=[t];var e=this;setTimeout(function(){e.init()},0)}},init:function(){var t=this.datas;if(t){for(var e=0;e<t.length;++e){var i=t[e],n=i.cls,r=i.props;if("function"==typeof r)r=r();var o=JS.getClassName(n);if(r)declareProperties(n,o,r,n.$super,i.mixins);else cc.error('Properties function of "%s" should return an object!',o)}this.datas=null}}};cc.isChildClassOf=function(t,e){if(t&&e){if("function"!=typeof t)return!1;if("function"!=typeof e){if(!1)cc.warn("[isChildClassOf] superclass should be function type, not",e);return!1}for(;t&&t.$super;t=t.$super)if(t===e)return!0;if(t===e)return!0;for(var i=Object.getPrototypeOf(t.prototype);i;){if(t=i.constructor,t===e)return!0;i=Object.getPrototypeOf(t.prototype)}}return!1};var SuperCallReg=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;CCClass._isCCClass=function(t){return!!t&&"undefined"!=typeof t.__ctors__},CCClass._fastDefine=function(t,e,i){JS.setClassName(t,e),e.__props__=i;for(var n=0;n<i.length;n++)Attr.attr(e,i[n],{visible:!1})},CCClass.attr=Attr.attr;var tmpAttrs=[];if(cc.Class=CCClass,module.exports={instantiateProps:instantiateProps,isArray:function(t){return t=getDefault(t),Array.isArray(t)},fastDefine:CCClass._fastDefine},!1)module.exports.getDefault=getDefault},{"../value-types/CCEnum":95,"./attribute":74,"./js":80,"./preprocess-attrs":83,"./utils":86}],69:[function(t,e,i){t("./_CCClass"),cc._tmp=cc._tmp||{},cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10}),cc.getImageFormatByData=function(t){if(t.length>8&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7])return cc.ImageFormat.PNG;if(t.length>2&&(73===t[0]&&73===t[1]||77===t[0]&&77===t[1]||255===t[0]&&216===t[1]))return cc.ImageFormat.TIFF;else return cc.ImageFormat.UNKNOWN},cc.macro={INVALID_INDEX:-1,NODE_TAG_INVALID:-1,PI:Math.PI,PI2:2*Math.PI,FLT_MAX:parseFloat("3.402823466e+38F"),FLT_MIN:parseFloat("1.175494351e-38F"),RAD:Math.PI/180,DEG:180/Math.PI,UINT_MAX:4294967295,REPEAT_FOREVER:cc.sys.isNative?4294967295:Number.MAX_VALUE-1,FLT_EPSILON:1.192092896e-7,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,LINEAR:9729,BLEND_DST:771,WEB_ORIENTATION_PORTRAIT:0,WEB_ORIENTATION_LANDSCAPE_LEFT:-90,WEB_ORIENTATION_PORTRAIT_UPSIDE_DOWN:180,WEB_ORIENTATION_LANDSCAPE_RIGHT:90,DEVICE_ORIENTATION_PORTRAIT:0,DEVICE_ORIENTATION_LANDSCAPE_LEFT:1,DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN:2,DEVICE_ORIENTATION_LANDSCAPE_RIGHT:3,DEVICE_MAX_ORIENTATIONS:2,DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",VERTEX_ATTRIB_FLAG_NONE:0,VERTEX_ATTRIB_FLAG_POSITION:1,VERTEX_ATTRIB_FLAG_COLOR:2,VERTEX_ATTRIB_FLAG_TEX_COORDS:4,VERTEX_ATTRIB_FLAG_POS_COLOR_TEX:7,GL_ALL:0,VERTEX_ATTRIB_POSITION:0,VERTEX_ATTRIB_COLOR:1,VERTEX_ATTRIB_TEX_COORDS:2,VERTEX_ATTRIB_MAX:3,UNIFORM_PMATRIX:0,UNIFORM_MVMATRIX:1,UNIFORM_MVPMATRIX:2,UNIFORM_TIME:3,UNIFORM_SINTIME:4,UNIFORM_COSTIME:5,UNIFORM_RANDOM01:6,UNIFORM_SAMPLER:7,UNIFORM_MAX:8,SHADER_POSITION_TEXTURECOLOR:"ShaderPositionTextureColor",SHADER_POSITION_TEXTURECOLORALPHATEST:"ShaderPositionTextureColorAlphaTest",SHADER_POSITION_COLOR:"ShaderPositionColor",SHADER_POSITION_TEXTURE:"ShaderPositionTexture",SHADER_POSITION_TEXTURE_UCOLOR:"ShaderPositionTexture_uColor",SHADER_POSITION_TEXTUREA8COLOR:"ShaderPositionTextureA8Color",SHADER_POSITION_UCOLOR:"ShaderPosition_uColor",SHADER_POSITION_LENGTHTEXTURECOLOR:"ShaderPositionLengthTextureColor",UNIFORM_PMATRIX_S:"CC_PMatrix",UNIFORM_MVMATRIX_S:"CC_MVMatrix",UNIFORM_MVPMATRIX_S:"CC_MVPMatrix",UNIFORM_TIME_S:"CC_Time",UNIFORM_SINTIME_S:"CC_SinTime",UNIFORM_COSTIME_S:"CC_CosTime",UNIFORM_RANDOM01_S:"CC_Random01",UNIFORM_SAMPLER_S:"CC_Texture0",UNIFORM_ALPHA_TEST_VALUE_S:"CC_alpha_value",ATTRIBUTE_NAME_COLOR:"a_color",ATTRIBUTE_NAME_POSITION:"a_position",ATTRIBUTE_NAME_TEX_COORD:"a_texCoord",ITEM_SIZE:32,CURRENT_ITEM:3233828865,ZOOM_ACTION_TAG:3233828866,NORMAL_TAG:8801,SELECTED_TAG:8802,DISABLE_TAG:8803,FIX_ARTIFACTS_BY_STRECHING_TEXEL:0,DIRECTOR_STATS_POSITION:cc.p(0,0),DIRECTOR_FPS_INTERVAL:.5,COCOSNODE_RENDER_SUBPIXEL:1,SPRITEBATCHNODE_RENDER_SUBPIXEL:1,AUTO_PREMULTIPLIED_ALPHA_FOR_PNG:0,OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA:0,TEXTURE_ATLAS_USE_TRIANGLE_STRIP:0,TEXTURE_ATLAS_USE_VAO:0,TEXTURE_NPOT_SUPPORT:0,USE_LA88_LABELS:1,SPRITE_DEBUG_DRAW:0,LABELBMFONT_DEBUG_DRAW:0,LABELATLAS_DEBUG_DRAW:0,ENABLE_STACKABLE_ACTIONS:1,ENABLE_GL_STATE_CACHE:1},cc.defineGetterSetter(cc.macro,"BLEND_SRC",function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.macro.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA)return cc.macro.ONE;else return cc.macro.SRC_ALPHA}),cc.lerp=function(t,e,i){return t+(e-t)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(t){return t*cc.macro.RAD},cc.radiansToDegrees=function(t){return t*cc.macro.DEG},cc.nodeDrawSetup=function(t){if(t._shaderProgram)t._shaderProgram.use(),t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4()},cc.incrementGLDraws=function(t){cc.g_NumberOfDraws+=t},cc.checkGLErrorDebug=function(){if(cc.renderMode===cc.game.RENDER_TYPE_WEBGL){var t=cc._renderContext.getError();if(t)cc.log(cc._LogInfos.checkGLErrorDebug,t)}}},{"./_CCClass":73}],70:[function(t,e,i){function n(){this._name="",this._objFlags=0}function r(){for(var t=x.length,e=0;t>e;++e){var i=x[e];if(!(i._objFlags&s))i._destroyImmediate()}if(t===x.length)x.length=0;else x.splice(0,t);if(!1)N=null}var o=t("./js"),s=1,c=2,a=4,h=8,l=16,u=32,f=64,d=512,p=1024,_=4096,g=8192,v=16384,m=32768,y=65536,b=1<<17,T=1<<18,C=1<<19,A=1<<20,S=d|p,E=~(c|l|f|u|_|v|g|m);n.Flags={Destroyed:s,DontSave:a,EditorOnly:h,Dirty:l,DontDestroy:u,PersistentMask:E,Destroying:f,HideInGame:d,HideInEditor:p,Hide:S,IsOnLoadCalled:g,IsOnLoadStarted:v,IsOnEnableCalled:_,IsOnStartCalled:m,IsPositionLocked:A,IsRotationLocked:y,IsScaleLocked:b,IsAnchorLocked:T,IsSizeLocked:C},t("./CCClass").fastDefine("cc.Object",n,["_name","_objFlags"]);var x=[];if(Object.defineProperty(n,"_deferredDestroy",{value:r}),!1)Object.defineProperty(n,"_clearDeferredDestroyTimer",{value:function(){if(null!==N)clearImmediate(N),N=null},enumerable:!1});var O=n.prototype;o.getset(O,"name",function(){return this._name},function(t){this._name=t}),o.get(O,"isValid",function(){return!(this._objFlags&s)});var N=null;if(O.destroy=function(){if(this._objFlags&s)return cc.warn("object already destroyed"),!1;if(this._objFlags&c)return!1;if(this._objFlags|=c,x.push(this),null===N&&cc.engine&&!cc.engine._isUpdating,!1)N=setImmediate(r);return!0},!1)O.realDestroyInEditor=function(){if(this._objFlags&s)return cc.warn("object already destroyed"),!1;if(this._objFlags&c)return!1;if(this._objFlags|=c,x.push(this),null===N&&cc.engine&&!cc.engine._isUpdating,!1)N=setImmediate(r);return!0};if(O._destruct=function(){if(false)return cc.error("object not yet destroyed");for(var t in this)if(this.hasOwnProperty(t))switch(typeof this[t]){case"string":this[t]="";break;case"object":case"function":this[t]=null}},O._onPreDestroy=null,O._destroyImmediate=function(){if(this._objFlags&s)return void cc.error("object already destroyed");if(this._onPreDestroy)this._onPreDestroy();if(true)this._destruct();this._objFlags|=s},!1)O._serialize=null;if(O._deserialize=null,cc.isValid=function(t){if("object"==typeof t)return!(!t||t._objFlags&s);else return"undefined"!=typeof t},!1)Object.defineProperty(n,"_willDestroy",{value:function(t){return!(t._objFlags&s)&&(t._objFlags&c)>0}}),Object.defineProperty(n,"_cancelDestroy",{value:function(t){t._objFlags&=~c;var e=x.indexOf(t);if(-1!==e)x.splice(e,1)}});cc.Object=n,e.exports=n},{"./CCClass":68,"./js":80}],71:[function(t,e,i){if(!cc.sys){cc.sys={};var n=cc.sys;if(n.LANGUAGE_ENGLISH="en",n.LANGUAGE_CHINESE="zh",n.LANGUAGE_FRENCH="fr",n.LANGUAGE_ITALIAN="it",n.LANGUAGE_GERMAN="de",n.LANGUAGE_SPANISH="es",n.LANGUAGE_DUTCH="du",n.LANGUAGE_RUSSIAN="ru",n.LANGUAGE_KOREAN="ko",n.LANGUAGE_JAPANESE="ja",n.LANGUAGE_HUNGARIAN="hu",n.LANGUAGE_PORTUGUESE="pt",n.LANGUAGE_ARABIC="ar",n.LANGUAGE_NORWEGIAN="no",n.LANGUAGE_POLISH="pl",n.LANGUAGE_UNKNOWN="unkonwn",n.OS_IOS="iOS",n.OS_ANDROID="Android",n.OS_WINDOWS="Windows",n.OS_MARMALADE="Marmalade",n.OS_LINUX="Linux",n.OS_BADA="Bada",n.OS_BLACKBERRY="Blackberry",n.OS_OSX="OS X",n.OS_WP8="WP8",n.OS_WINRT="WINRT",n.OS_UNKNOWN="Unknown",n.UNKNOWN=-1,n.WIN32=0,n.LINUX=1,n.MACOS=2,n.ANDROID=3,n.IPHONE=4,n.IPAD=5,n.BLACKBERRY=6,n.NACL=7,n.EMSCRIPTEN=8,n.TIZEN=9,n.WINRT=10,n.WP8=11,n.MOBILE_BROWSER=100,n.DESKTOP_BROWSER=101,n.EDITOR_PAGE=102,n.EDITOR_CORE=103,n.BROWSER_TYPE_WECHAT="wechat",n.BROWSER_TYPE_ANDROID="androidbrowser",n.BROWSER_TYPE_IE="ie",n.BROWSER_TYPE_QQ="qqbrowser",n.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",n.BROWSER_TYPE_UC="ucbrowser",n.BROWSER_TYPE_360="360browser",n.BROWSER_TYPE_BAIDU_APP="baiduboxapp",n.BROWSER_TYPE_BAIDU="baidubrowser",n.BROWSER_TYPE_MAXTHON="maxthon",n.BROWSER_TYPE_OPERA="opera",n.BROWSER_TYPE_OUPENG="oupeng",n.BROWSER_TYPE_MIUI="miuibrowser",n.BROWSER_TYPE_FIREFOX="firefox",n.BROWSER_TYPE_SAFARI="safari",n.BROWSER_TYPE_CHROME="chrome",n.BROWSER_TYPE_LIEBAO="liebao",n.BROWSER_TYPE_QZONE="qzone",n.BROWSER_TYPE_SOUGOU="sogou",n.BROWSER_TYPE_UNKNOWN="unknown",n.isNative=!1,n.isBrowser="object"==typeof window&&"object"==typeof document,"undefined"!=typeof Editor&&Editor.isCoreLevel)n.isMobile=!1,n.platform=n.EDITOR_CORE,n.language=n.LANGUAGE_UNKNOWN,n.os={darwin:n.OS_OSX,win32:n.OS_WINDOWS,linux:n.OS_LINUX}[process.platform]||n.OS_UNKNOWN,n.browserType=null,n.browserVersion=null,n.windowPixelResolution={width:0,height:0},n.__audioSupport={};else{var r=window,o=r.navigator,s=document,c=s.documentElement,a=o.userAgent.toLowerCase();if(cc.isEditor)n.isMobile=!1,n.platform=n.EDITOR_PAGE;else n.isMobile=-1!==a.indexOf("mobile")||-1!==a.indexOf("android"),n.platform=n.isMobile?n.MOBILE_BROWSER:n.DESKTOP_BROWSER;var h=o.language;h=h?h:o.browserLanguage,h=h?h.split("-")[0]:n.LANGUAGE_ENGLISH,n.language=h;var l=a.match(/(iPad|iPhone|iPod)/i)?!0:!1,u=a.match(/android/i)||o.platform.match(/android/i)?!0:!1,f=n.OS_UNKNOWN;if(-1!==o.appVersion.indexOf("Win"))f=n.OS_WINDOWS;else if(l)f=n.OS_IOS;else if(-1!==o.appVersion.indexOf("Mac"))f=n.OS_OSX;else if(-1!==o.appVersion.indexOf("X11")&&-1===o.appVersion.indexOf("Linux"))f=n.OS_UNIX;else if(u)f=n.OS_ANDROID;else if(-1!==o.appVersion.indexOf("Linux"))f=n.OS_LINUX;n.os=f,n.browserType=n.BROWSER_TYPE_UNKNOWN,function(){var t=/mqqbrowser|sogou|qzone|liebao|micromessenger|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i,e=/qqbrowser|chrome|safari|firefox|opr|oupeng|opera/i,i=t.exec(a);if(!i)i=e.exec(a);var r=i?i[0]:n.BROWSER_TYPE_UNKNOWN;if("micromessenger"===r)r=n.BROWSER_TYPE_WECHAT;else if("safari"===r&&a.match(/android.*applewebkit/))r=n.BROWSER_TYPE_ANDROID;else if("trident"===r)r=n.BROWSER_TYPE_IE;else if("360 aphone"===r)r=n.BROWSER_TYPE_360;else if("mxbrowser"===r)r=n.BROWSER_TYPE_MAXTHON;else if("opr"===r)r=n.BROWSER_TYPE_OPERA;n.browserType=r}(),n.browserVersion="",function(){var t=/(micromessenger|qq|mx|maxthon|baidu|sogou)(mobile)?(browser)?\/?([\d.]+)/i,e=/(msie |rv:|firefox|chrome|ucbrowser|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i,i=a.match(t);if(!i)i=a.match(e);n.browserVersion=i?i[4]:""}();var d=window.innerWidth||document.documentElement.clientWidth,p=window.innerHeight||document.documentElement.clientHeight,_=window.devicePixelRatio||1;n.windowPixelResolution={width:_*d,height:_*p},n._checkWebGLRenderMode=function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")};var g=document.createElement("canvas"),v=document.createElement("canvas");if(cc.create3DContext=function(t,e){for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,r=0;r<i.length;++r){try{n=t.getContext(i[r],e)}catch(o){}if(n)break}return n},n._supportCanvasNewBlendModes=function(){var t,e,i=g;i.width=1,i.height=1;var n=i.getContext("2d");n.fillStyle="#000",n.fillRect(0,0,1,1),n.globalCompositeOperation="multiply";var r=v;r.width=1,r.height=1;var o=r.getContext("2d");o.fillStyle="#fff",o.fillRect(0,0,1,1),n.drawImage(r,0,0,1,1),t=n.getImageData(0,0,1,1).data[0],i=g,i.width=1,i.height=1;var n=i.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,1,1),n.globalCompositeOperation="destination-atop",r=v,r.width=1,r.height=1;var o=r.getContext("2d");return o.fillStyle="#000",o.fillRect(0,0,1,1),n.drawImage(r,0,0,1,1),e=n.getImageData(0,0,1,1).data[0],0===t&&0===e}(),cc.sys.isMobile){var m=document.createElement("style");m.type="text/css",document.body.appendChild(m),m.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var y=n.localStorage=r.localStorage;y.setItem("storage",""),y.removeItem("storage"),y=null}catch(b){var T=function(){cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")};n.localStorage={getItem:T,setItem:T,removeItem:T,clear:T}}var C=!!g.getContext("2d"),A=!1,S=document.createElement("CANVAS");if(r.WebGLRenderingContext)try{var E=cc.create3DContext(S,{stencil:!0,preserveDrawingBuffer:!0});if(E)A=!0;if(n.os===n.OS_ANDROID){A=!1;var x=parseFloat(n.browserVersion);if(n.browserType===n.BROWSER_TYPE_MOBILE_QQ&&x>=6.2)A=!0;else if(n.osMainVersion&&n.osMainVersion>=5&&n.browserType===n.BROWSER_TYPE_ANDROID)A=!0}}catch(b){}var O=n.capabilities={canvas:C,opengl:A};if(void 0!==c.ontouchstart||void 0!==s.ontouchstart||o.msPointerEnabled)O.touches=!0;if(void 0!==c.onmouseup)O.mouse=!0;if(void 0!==c.onkeyup)O.keyboard=!0;if(r.DeviceMotionEvent||r.DeviceOrientationEvent)O.accelerometer=!0;delete g,delete v;var N;!function(){var t=!1,e=n.browserVersion,i=!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),r={common:{MULTI_CHANNEL:!0,WEB_AUDIO:i,AUTOPLAY:!0}};if(r[n.BROWSER_TYPE_IE]={MULTI_CHANNEL:!0,WEB_AUDIO:i,AUTOPLAY:!0,USE_EMPTIED_EVENT:!0},r[n.BROWSER_TYPE_ANDROID]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!1},r[n.BROWSER_TYPE_CHROME]={MULTI_CHANNEL:!0,WEB_AUDIO:!0,AUTOPLAY:!1},r[n.BROWSER_TYPE_FIREFOX]={MULTI_CHANNEL:!0,WEB_AUDIO:!0,AUTOPLAY:!0,DELAY_CREATE_CTX:!0},r[n.BROWSER_TYPE_UC]={MULTI_CHANNEL:!0,WEB_AUDIO:!1,AUTOPLAY:!1},r[n.BROWSER_TYPE_QQ]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!0},r[n.BROWSER_TYPE_OUPENG]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!1,REPLAY_AFTER_TOUCH:!0,USE_EMPTIED_EVENT:!0},r[n.BROWSER_TYPE_WECHAT]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!1,REPLAY_AFTER_TOUCH:!0,USE_EMPTIED_EVENT:!0},r[n.BROWSER_TYPE_360]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!0},r[n.BROWSER_TYPE_MIUI]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!0},r[n.BROWSER_TYPE_LIEBAO]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!1,REPLAY_AFTER_TOUCH:!0,USE_EMPTIED_EVENT:!0},r[n.BROWSER_TYPE_SOUGOU]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!1,REPLAY_AFTER_TOUCH:!0,USE_EMPTIED_EVENT:!0},r[n.BROWSER_TYPE_BAIDU]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!1,REPLAY_AFTER_TOUCH:!0,USE_EMPTIED_EVENT:!0},r[n.BROWSER_TYPE_BAIDU_APP]={MULTI_CHANNEL:!1,WEB_AUDIO:!1,AUTOPLAY:!1,REPLAY_AFTER_TOUCH:!0,USE_EMPTIED_EVENT:!0},r[n.BROWSER_TYPE_SAFARI]={MULTI_CHANNEL:!0,WEB_AUDIO:!0,AUTOPLAY:!1,webAudioCallback:function(t){document.createElement("audio").src=t}},n.isMobile)if(n.os!==n.OS_IOS)N=r[n.browserType]||r.common;else N=r[n.BROWSER_TYPE_SAFARI];else switch(n.browserType){case n.BROWSER_TYPE_IE:N=r[n.BROWSER_TYPE_IE];break;case n.BROWSER_TYPE_FIREFOX:N=r[n.BROWSER_TYPE_FIREFOX];break;default:N=r.common}if(e)switch(n.browserType){case n.BROWSER_TYPE_CHROME:if(e=parseInt(e),30>e)N={MULTI_CHANNEL:!1,WEB_AUDIO:!0,AUTOPLAY:!1};else if(42===e)N.NEED_MANUAL_LOOP=!0;break;case n.BROWSER_TYPE_MIUI:if(n.isMobile)if(e=e.match(/\d+/g),e[0]<2||2===e[0]&&0===e[1]&&e[2]<=1)N.AUTOPLAY=!1}if(t)setTimeout(function(){cc.log("browse type: "+n.browserType),cc.log("browse version: "+e),cc.log("MULTI_CHANNEL: "+N.MULTI_CHANNEL),cc.log("WEB_AUDIO: "+N.WEB_AUDIO),cc.log("AUTOPLAY: "+N.AUTOPLAY)},0)}();try{if(N.WEB_AUDIO)if(N.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),N.DELAY_CREATE_CTX)setTimeout(function(){N.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)},0)}catch(I){N.WEB_AUDIO=!1,cc.log("browser don't support web audio")}var w=[];!function(){var t=document.createElement("audio");if(t.canPlayType){var e=t.canPlayType('audio/ogg; codecs="vorbis"');if(e)w.push(".ogg");var i=t.canPlayType("audio/mpeg");if(i)w.push(".mp3");var n=t.canPlayType('audio/wav; codecs="1"');if(n)w.push(".wav");var r=t.canPlayType("audio/mp4");if(r)w.push(".mp4");var o=t.canPlayType("audio/x-m4a");if(o)w.push(".m4a")}}(),N.format=w,n.__audioSupport=N}n.garbageCollect=function(){},n.dumpRoot=function(){},n.restartVM=function(){},n.cleanScript=function(t){},n.isObjectValid=function(t){if(t)return!0;else return!1},n.dump=function(){var t=this,e="";e+="isMobile : "+t.isMobile+"\r\n",e+="language : "+t.language+"\r\n",e+="browserType : "+t.browserType+"\r\n",e+="browserVersion : "+t.browserVersion+"\r\n",e+="capabilities : "+JSON.stringify(t.capabilities)+"\r\n",e+="os : "+t.os+"\r\n",e+="osVersion : "+t.osVersion+"\r\n",e+="platform : "+t.platform+"\r\n",e+="Using "+(cc._renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(e)},n.openURL=function(t){window.open(t)},e.exports=n}},{}],72:[function(t,e,i){cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(t){var e=this.width=t.width,i=this.height=t.height,n=t.x,r=t.y,o=r+i,s=n+e;this.topLeft.x=n,this.topLeft.y=o,this.topRight.x=s,this.topRight.y=o,this.top.x=n+e/2,this.top.y=o,this.bottomLeft.x=n,this.bottomLeft.y=r,this.bottomRight.x=s,this.bottomRight.y=r,this.bottom.x=n+e/2,this.bottom.y=r,this.center.x=n+e/2,this.center.y=r+i/2,this.left.x=n,this.left.y=r+i/2,this.right.x=s,this.right.y=r+i/2}}},{}],73:[function(t,e,i){var n=cc.ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}},r=/\b_super\b/,o=function(){};o.extend=function(t){function e(){if(this.__instanceId=n.getNewInstanceId(),this.ctor)this.ctor.apply(this,arguments)}var i=this.prototype,s=Object.create(i),c=n.getNewID();n[c]=i;var a={writable:!0,enumerable:!1,configurable:!0};s.__instanceId=null,e.id=c,a.value=c,Object.defineProperty(s,"__cid__",a),e.prototype=s,a.value=e,Object.defineProperty(e.prototype,"constructor",a);for(var h=0,l=arguments.length;l>h;++h){var u=arguments[h];for(var f in u){var d="function"==typeof u[f],p="function"==typeof i[f],_=r.test(u[f]);if(d&&p&&_)a.value=function(t,e){return function(){var n=this._super;this._super=i[t];var r=e.apply(this,arguments);return this._super=n,r}}(f,u[f]),Object.defineProperty(s,f,a);else if(d)a.value=u[f],Object.defineProperty(s,f,a);else s[f]=u[f]}}return e.extend=o.extend,e.implement=function(t){for(var e in t)s[e]=t[e]},e},cc.defineGetterSetter=function(t,e,i,n,r,o){if(t.__defineGetter__)i&&t.__defineGetter__(e,i),n&&t.__defineSetter__(e,n);else if(Object.defineProperty){var s={enumerable:!1,configurable:!0};i&&(s.get=i),n&&(s.set=n),Object.defineProperty(t,e,s)}else throw new Error("browser does not support getters")},cc.clone=function(t){var e=t.constructor?new t.constructor:{};for(var i in t){var n=t[i];if("object"==typeof n&&n&&!(n instanceof _ccsg.Node)&&!(n instanceof HTMLElement))e[i]=cc.clone(n);else e[i]=n}return e},cc._Class=e.exports=o},{}],74:[function(t,e,i){function n(t,e,i){var n,r,o,s="_attr$"+e;if("function"==typeof t){if(n=t.prototype,r=n[s],"undefined"!=typeof i)if("object"==typeof i){if(!r)n[s]=r={};for(o in i)if("_"!==o[0])r[o]=i[o]}else return n[s]=i,i;return r}else if(n=t,"undefined"!=typeof i)if("object"==typeof i){if(n.hasOwnProperty(s))r=n[s];if(!r)n[s]=r={};for(o in i)if("_"!==o[0])r[o]=i[o];return a.addon({},r,n.constructor.prototype[s])}else return n[s]=i,i;else if(r=n[s],"object"==typeof r)return a.addon({},r,n.constructor.prototype[s]);else return r}function r(t,e,i){if(!1)return function(n,r){var o=cc.Class.attr(n,r)||{};if(o.type!==t)return void cc.warn("Can only indicate one type attribute for %s.%s.",a.getClassName(n),r);if(o.hasOwnProperty("default")){var s=o["default"];if("undefined"!=typeof s){var c=Array.isArray(s)||h(s);if(!c){var l=typeof s,u=t.toLowerCase();if(l===u)if("object"===u)if(s&&!(s instanceof i))cc.warn("The default value of %s.%s is not instance of %s.",a.getClassName(n),r,a.getClassName(i));else return;else cc.warn('No needs to indicate the "%s" attribute for %s.%s, which its default value is type of %s.',e,a.getClassName(n),r,t);else if("function"!==l)cc.warn('Can not indicate the "%s" attribute for %s.%s, which its default value is type of %s.',e,a.getClassName(n),r,l);delete o.type}}}};else;}function o(t){return{type:"Object",ctor:t}}function s(t){return{rawType:t,serializable:!1,_canUsedInGetter:!1,_onAfterProp:function(t,e){}}}function c(t,e){return{min:t,max:e}}var a=t("./js"),h=t("./utils").isPlainEmptyObj_DEV;if(cc.Integer="Integer",cc.Float="Float",!1)a.get(cc,"Number",function(){return cc.warn('Use "cc.Float" or "cc.Integer" instead of "cc.Number" please. 😂'),cc.Float});cc.Boolean="Boolean",cc.String="String";var l={serializable:!1,_canUsedInGetter:!1},u={editorOnly:!0,_canUsedInGetter:!1};e.exports={attr:n,getTypeChecker:r,NonSerialized:l,EditorOnly:u,ObjectType:o,RawType:s,ScriptUuid:{},Range:c}},{"./js":80,"./utils":86}],75:[function(t,e,i){var n=t("./js"),r=function(){this._callbackTable={}};r.prototype.add=function(t,e,i){var n=this._callbackTable[t];if("undefined"!=typeof n){if(n.push(e),"object"==typeof i)n.push(i);return!1}else{if("object"==typeof i)n=[e,i];else n=[e];return this._callbackTable[t]=n,!0}},r.prototype.has=function(t,e,i){var n,r,o=this._callbackTable[t];if(o&&o.length>0){if(!e)return!0;else if("function"!=typeof e)return!1;for(r=o.indexOf(e);-1!==r;){if(n=o[r+1],"object"!=typeof n)n=void 0;if(n===i)return!0;r=cc.js.array.indexOf.call(o,e,r+1)}return!1}return!1},r.prototype.removeAll=function(t){if(this._invoking[t])return void(this._toRemoveAll=t);if("object"==typeof t){var e,i,n,r=t;for(t in this._callbackTable)for(e=this._callbackTable[t],i=e.lastIndexOf(r);-1!==i;){if(n=e[i-1],"function"==typeof n)e.splice(i-1,2);else e.splice(i,1);i=e.lastIndexOf(r)}}else delete this._callbackTable[t]},r.prototype.remove=function(t,e,i){var n,r,o,s=this._callbackTable[t];if(s){if(this._invoking[t]){if(o=this._toRemove[t])o.push([e,i]);else this._toRemove[t]=[[e,i]];return!0}for(n=s.indexOf(e);-1!==n;){if(r=s[n+1],"object"!=typeof r)r=void 0;if(r===i){s.splice(n,r?2:1);break}n=cc.js.array.indexOf.call(s,e,n+1)}return!0}return!1};var o=function(){r.call(this),this._invoking={},this._toRemove={},this._toRemoveAll=null};if(n.extend(o,r),!1)cc._Test.CallbacksInvoker=o;o.prototype.invoke=function(t,e,i,n,r,o){this._invoking[t]=!0;var s,c=this._callbackTable[t];if(c){var a=c.length-1;for(s=0;a>=s;){var h,l=c[s],u=c[s+1],f=u&&"object"==typeof u;if(f)c[s].call(u,e,i,n,r,o),h=2;else l(e,i,n,r,o),h=1;s+=h}}this._invoking[t]=!1;var d=this._toRemove[t];if(d){for(s=0;s<d.length;++s){var p=d[s];this.remove(t,p[0],p[1])}delete this._toRemove[t]}if(this._toRemoveAll)this.removeAll(this._toRemoveAll),this._toRemoveAll=null},o.prototype.invokeAndRemove=function(t,e,i,n,r,o){this._invoking[t]=!0;var s,c,a,h=this._callbackTable[t];if(h)for(s=0,c=h.length;c>s;)if(a=h[s+1],a&&"object"==typeof a)h[s].call(a,e,i,n,r,o),s+=2;else h[s](e,i,n,r,o),++s;this._invoking[t]=!1,delete this._toRemove[t],this.removeAll(t)},o.prototype.bindKey=function(t,e){var i=this;return function(n,r,o,s,c){var a,h,l,u=i._callbackTable[t];if(u)for(a=0,h=u.length;h>a;)if(l=u[a+1],l&&"object"==typeof l)u[a].call(l,n,r,o,s,c),a+=2;else u[a](n,r,o,s,c),++a;if(e)i.removeAll(t)}},o.CallbacksHandler=r,e.exports=o},{"./js":80}],76:[function(t,e,i){var n=t("./js"),r=(t("./CCObject"),!1),o=r,s=function(){if(this.uuidList=[],this.uuidObjList=[],this.uuidPropList=[],this.rawProp="",r)this.visitorInEditor=null,this.visitObjList=[],this.visitPropList=[]};if(s.prototype.reset=function(){if(this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.rawProp="",r)this.visitorInEditor=null,this.visitObjList.length=0,this.visitPropList.length=0},r)s.prototype.visitLater=function(t,e){this.visitObjList.push(t),this.visitPropList.push(e)};s.prototype.getUuidOf=function(t,e){for(var i=0;i<this.uuidObjList.length;i++)if(this.uuidObjList[i]===t&&this.uuidPropList[i]===e)return this.uuidList[i];return""},s.prototype.assignAssetsBy=function(t){for(var e=!0,i=0,n=this.uuidList.length;n>i;i++){var r=this.uuidList[i],o=t(r);if(o){var s=this.uuidObjList[i],c=this.uuidPropList[i];s[c]=o}else cc.error("Failed to assign asset: "+r),e=!1}return e},s.prototype.push=function(t,e,i){this.uuidList.push(i),this.uuidObjList.push(t),this.uuidPropList.push(e)};var c=function(){function t(t,e,i,n){if(this._classFinder=n,o)this._target=i;if(this._idList=[],this._idObjList=[],this._idPropList=[],this.result=e||new s,Array.isArray(t)){var c=t,l=c.length;this.deserializedList=new Array(l);for(var u=0;l>u;u++)if(c[u]){var f;if(o)f=0===u&&i;this.deserializedList[u]=h(this,c[u],f)}this.deserializedData=l>0?this.deserializedList[0]:[]}else this.deserializedList=[null],this.deserializedData=t?h(this,t,i):null,this.deserializedList[0]=this.deserializedData;if(a(this),r)this._callVisitorInEditor()}function e(t,e,i){for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];if("object"!=typeof s){if("__type__"!==n)if(e[n]=s,t.result.visitorInEditor&&r)t.result.visitLater(e,n)}else if(s)if(o)t._deserializeObjField(e,s,n,t._target&&e);else t._deserializeObjField(e,s,n);else e[n]=null}}function i(t,e,i){for(var n in e){var r=i[n];if("undefined"!=typeof r&&i.hasOwnProperty(n))if("object"!=typeof r)e[n]=r;else if(r)if(o)t._deserializeObjField(e,r,n,t._target&&e);else t._deserializeObjField(e,r,n);else e[n]=null}}function c(t,i,n,s,c){for(var a=s.__props__,h=0;h<a.length;h++){var l=a[h],u=cc.Class.attr(s,l),f=u.rawType;if(!f){if(!r&&u.editorOnly){var d=i instanceof cc.Node&&"_id"===l;if(!d)continue}if(u.serializable===!1)continue;var p=n[l];if("undefined"==typeof p)continue;if("object"!=typeof p)i[l]=p;else if(p)if(o)t._deserializeObjField(i,p,l,c&&i);else t._deserializeObjField(i,p,l);else i[l]=null}else{if(t.result.rawProp)cc.error("not support multi raw object in a file");t.result.rawProp=l}}if("_$erialized"===a[a.length-1])i._$erialized=n,e(t,i._$erialized,n)}var a=function(t){for(var e=t.deserializedList,i=0,n=t._idList.length;n>i;i++){var r=t._idPropList[i],o=t._idList[i];t._idObjList[i][r]=e[o]}};if(r)t.prototype._callVisitorInEditor=function(){var t=this.result;if(t.visitorInEditor)t.visitorInEditor(t.visitObjList,t.visitPropList,this)};t.prototype._deserializeObjField=function(t,e,i,n){var s=e.__id__;if("undefined"==typeof s){var c=e.__uuid__;if(c)this.result.uuidList.push(c),this.result.uuidObjList.push(t),this.result.uuidPropList.push(i);else{if(o)t[i]=h(this,e,n&&n[i]);else t[i]=h(this,e);if(this.result.visitorInEditor&&r)this.result.visitLater(t,i)}}else{var a=this.deserializedList[s];if(a)t[i]=a;else this._idList.push(s),this._idObjList.push(t),this._idPropList.push(i);if(this.result.visitorInEditor&&r)this.result.visitLater(t,i)}};var h=function(t,s,a){var h,l=null,u=null;if(s.__type__){var f=s.__type__;if(u=t._classFinder(f),!u)if(false)return f=Editor.UuidUtils.decompressUuid(f),cc.warn('Can not find script "%s"',f),null;else return cc.warn('Can not find class "%s"',f),null;if(o&&a){if(!(a instanceof u))cc.warn("Type of target to deserialize not matched with data: target is %s, data is %s",n.getClassName(a),u);l=a}else if(l=new u,cc.sys.isNative&&u===cc.SpriteFrame)l.retain();if(l._deserialize)return l._deserialize(s.content,t),l;if(cc.Class._isCCClass(u))c(t,l,s,u,a);else i(t,l,s)}else if(!Array.isArray(s))l=o&&a||{},e(t,l,s);else{if(o&&a)a.length=s.length,l=a;else l=new Array(s.length);for(var d=0;d<s.length;d++)if(h=s[d],"object"==typeof h&&h)if(o)t._deserializeObjField(l,h,""+d,a&&l);else t._deserializeObjField(l,h,""+d);else if(l[d]=h,t.result.visitorInEditor&&r)t.result.visitLater(l,""+d)}return l};return t}();cc.deserialize=function(t,e,i){var r=i&&i.classFinder||n._getClassById,a=i&&i.createAssetRefs||cc.sys.platform===cc.sys.EDITOR_CORE,h=o&&i&&i.target;if(false)t=t.toString();if("string"==typeof t)t=JSON.parse(t);if(a&&!e)e=new s;cc.game._isCloning=!0;var l=new c(t,e,h,r);if(cc.game._isCloning=!1,a)e.assignAssetsBy(Editor.serialize.asAsset);return l.deserializedData},cc.deserialize.Details=s},{"./CCObject":70,"./js":80}],77:[function(t,e,i){function n(t){this.id=0|998*Math.random(),this.prefix=t?""+t+r:""}var r=".";n.prototype.getNewId=function(){return this.prefix+ ++this.id},n.global=new n("global"),e.exports=n},{}],78:[function(t,e,i){if(t("./js"),t("./CCClass"),t("./CCObject"),t("./callbacks-invoker"),t("./url"),t("./deserialize"),t("./instantiate"),t("./prefab-info"),t("./requiring-frame"),t("./CCSys"),t("./CCMacro"),cc.sys.isBrowser||cc.sys.isNative)t("./CCAssetLibrary");if(false)t("./miniFramework"),t("./CCVisibleRect")},{"./CCAssetLibrary":67,"./CCClass":68,"./CCMacro":69,"./CCObject":70,"./CCSys":71,"./CCVisibleRect":72,"./callbacks-invoker":75,"./deserialize":76,"./instantiate":79,"./js":80,"./miniFramework":81,"./prefab-info":82,"./requiring-frame":84,"./url":85}],79:[function(t,e,i){function n(t){if("object"!=typeof t||Array.isArray(t))return cc.error("The thing you want to instantiate must be an object"),
null;if(!t)return cc.error("The thing you want to instantiate is nil"),null;if(t instanceof s&&!t.isValid)return cc.error("The thing you want to instantiate is destroyed"),null;var e;if(t instanceof s)if(t._instantiate)return cc.game._isCloning=!0,e=t._instantiate(),cc.game._isCloning=!1,e;else if(t instanceof cc.Asset)return cc.error("The instantiate method for given asset do not implemented"),null;return cc.game._isCloning=!0,e=r(t),cc.game._isCloning=!1,e}function r(t,e){if(Array.isArray(t))return cc.error("Can not instantiate array"),null;if(a&&a(t))return cc.error("Can not instantiate DOM element"),null;for(var i=l(t,e),n=0,r=h.length;r>n;++n)h[n]._iN$t=null;return h.length=0,i}function o(t,e,i,n){var r=t._iN$t;if(r)return r;if(!cc.isValid(t))return null;if(t instanceof cc.Asset)return t;else if(Array.isArray(t)){var s=t.length;r=new Array(s),t._iN$t=r;for(var c=0;s>c;++c){var a=t[c],u=typeof a;if("object"===u)r[c]=a?o(a,e,r,""+c):a;else r[c]="function"!==u?a:null}return h.push(t),r}else if(t instanceof cc.ValueType)return t.clone();else{var f=t.constructor;if(cc.Class._isCCClass(f)){if(e)if(e instanceof cc.Component){if(t instanceof cc._BaseNode||t instanceof cc.Component)return t}else if(e instanceof cc._BaseNode)if(t instanceof cc._BaseNode){if(!t.isChildOf(e))return t}else if(t instanceof cc.Component)if(!t.node.isChildOf(e))return t}else if(f!==Object)return t;return l(t,e)}}var s=t("./CCObject"),c=s.Flags.PersistentMask,a=t("./utils").isDomNode,h=[],l=function(t,e){var i,n,r,a=t.constructor,l=new a;if(t._iN$t=l,h.push(t),cc.Class._isCCClass(a)){for(var u=a.__props__,f=0;f<u.length;f++){r=u[f];var d=cc.Class.attr(a,r);if(d.serializable!==!1)if(i=t[r],n=typeof i,"object"===n)l[r]=i?o(i,e,l,r):i;else l[r]="function"!==n?i:null}if(l instanceof cc._BaseNode||l instanceof cc.Component,!1)l._id=""}else for(r in t)if(t.hasOwnProperty(r)&&(95!==r.charCodeAt(0)||95!==r.charCodeAt(1)||"__type__"===r))if(i=t[r],i!==l)if(n=typeof i,"object"===n)l[r]=i?o(i,e,l,r):i;else l[r]="function"!==n?i:null;else;else;if(t instanceof s)l._objFlags&=c;return l};n._clone=r,cc.instantiate=n,e.exports=n},{"./CCObject":70,"./utils":86}],80:[function(t,e,i){function n(t,e){var i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;var r=Object.getPrototypeOf(t);if(r)return n(r,e);else return null}function r(t,e,i){var r=n(e,t);Object.defineProperty(i,t,r)}function o(){return c+a++}var s={isFunction:function(t){return"function"==typeof t},isNumber:function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},isString:function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},isArray:function(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)},isUndefined:function(t){return"undefined"==typeof t},isObject:function(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)},addon:function(t){"use strict";t=t||{};for(var e=1,i=arguments.length;i>e;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.error("cc.js.addon called on non-object:",n);continue}for(var o in n)if(!(o in t))r(o,n,t)}}return t},mixin:function(t){"use strict";t=t||{};for(var e=1,i=arguments.length;i>e;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.error("cc.js.mixin: arguments must be type object:",n);continue}for(var o in n)r(o,n,t)}}return t},extend:function(t,e){if(!1){if(!e)return void cc.error("The base class to extend from must be non-nil");if(!t)return void cc.error("The class to extend must be non-nil")}for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t},clear:function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)delete t[e[i]]},getPropertyDescriptor:n};s.getClassName=function(t){if("function"==typeof t){if(t.prototype.__classname__)return t.prototype.__classname__}else if(t&&t.constructor){if(t.constructor.prototype&&t.constructor.prototype.hasOwnProperty("__classname__"))return t.__classname__;var e;if(t.constructor.name)e=t.constructor.name;if(t.constructor.toString){var i,n=t.constructor.toString();if("["===n.charAt(0))i=n.match(/\[\w+\s*(\w+)\]/);else i=n.match(/function\s*(\w+)/);if(i&&2===i.length)e=i[1]}return"Object"!==e?e:""}return""};var c="cc.TmpCId.",a=0;s._isTempClassId=function(t){return!1},function(){function t(t,e){return function(i,n){if(n.prototype.hasOwnProperty(t))delete e[n.prototype[t]];if(n.prototype[t]=i,i){var r=e[i];if(r&&r!==n){var o="A Class already exists with the same "+t+' : "'+i+'".';if(!1)o+=' (This may be caused by error of unit test.) If you dont need serialization, you can set class id to "". You can also call cc.js.unregisterClass to remove the id of unused class';cc.error(o)}else e[i]=n}}}var e={},i={};s._setClassId=t("__cid__",e);var n=t("__classname__",i);if(s.setClassName=function(t,e){if(n(t,e),!e.prototype.hasOwnProperty("__cid__")){var i=t||o();if(i)s._setClassId(i,e)}},s.unregisterClass=function(t){"use strict";for(var n=0;n<arguments.length;n++){var r=arguments[n].prototype,o=r.__cid__;if(o)delete e[o];var s=r.__classname__;if(s)delete i[s]}},s._getClassById=function(t){return e[t]},s.getClassByName=function(t){return i[t]},s._getClassId=function(t,e){e="undefined"!=typeof e?e:!0;var i;if("function"==typeof t&&t.prototype.hasOwnProperty("__cid__"))if(i=t.prototype.__cid__,!e&&s._isTempClassId(i))return"";else return i;if(t&&t.constructor){var n=t.constructor.prototype;if(n&&n.hasOwnProperty("__cid__"))if(i=t.__cid__,!e&&s._isTempClassId(i))return"";else return i}return""},!1)Object.defineProperty(s,"_registeredClassIds",{get:function(){var t={};for(var i in e)t[i]=e[i];return t},set:function(t){s.clear(e);for(var i in t)e[i]=t[i]}}),Object.defineProperty(s,"_registeredClassNames",{get:function(){var t={};for(var e in i)t[e]=i[e];return t},set:function(t){s.clear(i);for(var e in t)i[e]=t[e]}})}(),s.getset=function(t,e,i,n,r){if("function"!=typeof n)r=n,n=void 0;Object.defineProperty(t,e,{get:i,set:n,enumerable:!!r})},s.get=function(t,e,i,n){Object.defineProperty(t,e,{get:i,enumerable:!!n})},s.set=function(t,e,i,n){Object.defineProperty(t,e,{set:i,enumerable:!!n})},s.obsolete=function(t,e,i,n){var r=e.split(".").slice(-1);if(s.get(t,r,function(){if(!1)cc.warn('"%s" is deprecated, use "%s" instead please.',e,i);return t[i]}),n)s.set(t,r,function(n){if(!1)cc.warn('"%s" is deprecated, use "%s" instead please.',e,i);t[i]=n})},s.obsoletes=function(t,e,i,n){for(var r in i){var o=i[r];s.obsolete(t,e+"."+r,o,n)}},s.formatStr=function(){var t=arguments,e=t.length;if(1>e)return"";var i=/(%d)|(%s)/,n=1,r=t[0],o="string"==typeof r&&i.test(r);if(o)for(var s=/%s/;e>n;++n){var c=t[n],a="number"==typeof c?i:s;if(a.test(r))r=r.replace(a,c);else r+=" "+c}else if(e>1)for(;e>n;++n)r+=" "+t[n];else r=""+r;return r},s.array={remove:function(t,e){var i=t.indexOf(e);if(-1!==i)return t.splice(i,1),!0;else return!1},removeAt:function(t,e){t.splice(e,1)},contains:function(t,e){return-1!==t.indexOf(e)},verifyType:function(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return cc.log(cc._LogInfos.Array.verifyType),!1;return!0},removeArray:function(t,e){for(var i=0,n=e.length;n>i;i++)remove(t,e[i])},appendObjectsAt:function(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t},copy:function(t){var e,i=t.length,n=new Array(i);for(e=0;i>e;e+=1)n[e]=t[e];return n},indexOf:Array.prototype.indexOf},cc.js=s,e.exports=s},{}],81:[function(t,e,i){switch(cc.$=function(t){var e=this===cc?document:this,i=t instanceof HTMLElement?t:e.querySelector(t);if(i)i.find=i.find||cc.$,i.hasClass=i.hasClass||function(t){return this.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},i.addClass=i.addClass||function(t){if(!this.hasClass(t)){if(this.className)this.className+=" ";this.className+=t}return this},i.removeClass=i.removeClass||function(t){if(this.hasClass(t))this.className=this.className.replace(t,"");return this},i.remove=i.remove||function(){if(this.parentNode)this.parentNode.removeChild(this);return this},i.appendTo=i.appendTo||function(t){return t.appendChild(this),this},i.prependTo=i.prependTo||function(t){return t.childNodes[0]?t.insertBefore(this,t.childNodes[0]):t.appendChild(this),this},i.transforms=i.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(t,e){return this.position.x=t,this.position.y=e,this.transforms(),this},i.rotate=function(t){return this.rotation=t,this.transforms(),this},i.resize=function(t,e){return this.scale.x=t,this.scale.y=e,this.transforms(),this},i.setSkew=function(t,e){return this.skew.x=t,this.skew.y=e,this.transforms(),this};return i},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O",cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms",cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}cc.$.trans=cc.$.pfx+"Transform",cc.$.translate=cc.$.hd?function(t){return"translate3d("+t.x+"px, "+t.y+"px, 0) "}:function(t){return"translate("+t.x+"px, "+t.y+"px) "},cc.$.rotate=cc.$.hd?function(t){return"rotateZ("+t+"deg) "}:function(t){return"rotate("+t+"deg) "},cc.$.scale=function(t){return"scale("+t.x+", "+t.y+") "},cc.$.skew=function(t){return"skewX("+-t.x+"deg) skewY("+t.y+"deg)"},cc.$new=function(t){return cc.$(document.createElement(t))},cc.$.findpos=function(t){var e=0,i=0;do e+=t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return{x:e,y:i}}},{}],82:[function(t,e,i){var n=cc.Class({name:"cc.PrefabInfo",properties:{root:{"default":null},asset:{"default":null},fileId:{"default":""}}});cc._PrefabInfo=e.exports=n},{}],83:[function(t,e,i){function n(t,e,i,n){if(!t.get&&!t.set){if(t.hasOwnProperty("default")){var r="_N$"+e;t.get=function(){return this[r]},t.set=function(t){var e=this[r];this[r]=t,i.call(this,e)};var o={};n[r]=o;for(var s in a){var c=a[s];if(t.hasOwnProperty(s))if(o[s]=t[s],!c.canUsedInGet)delete t[s]}}else if(!1)cc.warn('"notify" must work with "default" !')}else if(!1)cc.warn('"notify" can\'t work with "get/set" !')}function r(t,e,i,n){if(Array.isArray(n))if(n.length>0)n=n[0];else if(!1)return cc.error("Invalid url of %s.%s",e,i);if(!1){if(null==n)return cc.warn('The "url" attribute of "%s.%s" is undefined when loading script.',e,i);if("function"!=typeof n||!cc.isChildClassOf(n,cc.RawAsset))return cc.error('The "url" type of "%s.%s" must be child class of cc.RawAsset.',e,i);if(cc.isChildClassOf(n,cc.Asset))return cc.error('The "url" type of "%s.%s" must not be child class of cc.Asset, otherwise you should use "type: %s" instead.',e,i,cc.js.getClassName(n));if(t.type)return cc.warn('Can not specify "type" attribute for "%s.%s", because its "url" is already defined.',e,i)}t.type=n}function o(e,i,n,r){if(Array.isArray(i)){if(!1){var o=t("./CCClass").isArray;if(!o(e["default"]))cc.warn('The "default" attribute of "%s.%s" must be an array',n,r)}if(i.length>0)e.type=i=i[0];else return cc.error("Invalid type of %s.%s",n,r)}if(!1)if("function"==typeof i){if(cc.RawAsset.isRawAssetType(i))cc.warn('The "type" attribute of "%s.%s" must be child class of cc.Asset, otherwise you should use "url: %s" instead',n,r,cc.js.getClassName(i))}else if("Number"===i)cc.warn('The "type" attribute of "%s.%s" can not be "Number", use "Float" or "Integer" instead please.',n,r);else if(null==i)cc.warn('The "type" attribute of "%s.%s" is undefined when loading script.',n,r)}function s(t,e,i,n){if(false)if(cc.Class._isCCClass(e)&&t.serializable!==!1&&!cc.js._getClassId(e,!1))cc.warn('Can not serialize "%s.%s" because the specified type is anonymous, please provide a class name or set the "serializable" attribute of "%s.%s" to "false".',i,n,i,n)}function c(t,e){if(!1){for(var i;e&&e.__props__&&-1!==e.__props__.indexOf(t);e=e.$super)i=e;if(!i)cc.error("unknown error");return i}}var a={url:{canUsedInGet:!0},"default":{},serializable:{},editorOnly:{},rawType:{}};e.exports=function(t,e,i){for(var a in t){var h=t[a],l=h&&h.constructor===Object;if(!l){if(Array.isArray(h)&&h.length>0)h={"default":[],type:h};else if("function"==typeof h){var u=h;if(cc.RawAsset.isRawAssetType(u))h={"default":"",url:u};else h={"default":cc.isChildClassOf(u,cc.ValueType)?new u:null,type:h}}else h={"default":h};t[a]=h}if(h){if(!1)if("default"in h){if(h.get)cc.error('The "default" value of "%s.%s" should not be used with a "get" function.',e,a);else if(h.set)cc.error('The "default" value of "%s.%s" should not be used with a "set" function.',e,a)}else if(!h.get&&!h.set)cc.error('Property "%s.%s" must define at least one of "default", "get" or "set".',e,a);if(!h.override&&-1!==i.__props__.indexOf(a),!1){var f=cc.js.getClassName(c(a,i));cc.warn('"%s.%s" hides inherited property "%s.%s". To make the current property override that implementation, add the `override: true` attribute please.',e,a,f,a)}var d=h.notify;if(d)n(h,a,d,t);if("type"in h)o(h,h.type,e,a);if("url"in h)r(h,e,a,h.url);if("type"in h)s(h,h.type,e,a)}}}},{"./CCClass":68}],84:[function(t,e,i){var n=[];if(cc._RFpush=function(t,e,i){if(2===arguments.length)i=e,e="";n.push({uuid:e,script:i,module:t,exports:t.exports,beh:null})},cc._RFpop=function(){var t=n.pop(),e=t.module,i=e.exports;if(i===t.exports){for(var r in i)return;e.exports=i=t.beh}},cc._RFpeek=function(){return n[n.length-1]},!1)cc._RFreset=function(){n=[]}},{}],85:[function(t,e,i){var n={};cc.url={_rawAssets:"",_builtinRawAssets:"",normalize:function(t){if(46===t.charCodeAt(0)&&47===t.charCodeAt(1))t=t.slice(2);else if(47===t.charCodeAt(0))t=t.slice(1);return t},raw:function(t){if(!this._rawAssets,!1)return cc.error("Failed to init asset's raw path."),"";if(t=this.normalize(t),!t.startsWith("resources/"))if(!1)cc.error('Should not load "%s" from script dynamically, unless it is placed in the "resources" folder.',t);else cc.error('Sorry can not load "%s" because it is not placed in the "resources" folder.',t);return this._rawAssets+t},builtinRaw:!1,_init:function(t){for(var e in t){var i=t[e];i=cc.path._setEndWithSep(i,"/"),n[e]=i}this._rawAssets=n.assets,this._builtinRawAssets=n.internal}},e.exports=cc.url},{}],86:[function(t,e,i){if(e.exports={isDomNode:"object"==typeof window&&function(t){return"object"==typeof Node?t instanceof Node:t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},callInNextTick:!1?function(t,e,i){if(t)process.nextTick(function(){t(e,i)})}:function(t,e,i){if(t)setTimeout(function(){t(e,i)},0)}},!1)cc.js.mixin(e.exports,{isPlainEmptyObj_DEV:function(t){if(!t||t.constructor!==Object)return!1;for(var e in t)return!1;return!0},cloneable_DEV:function(t){return t&&"function"==typeof t.clone&&(t.constructor.prototype.hasOwnProperty("clone")||t.hasOwnProperty("clone"))}});if(!1)if("undefined"==typeof Editor)Editor={UuidUtils:{NonUuidMark:".",uuid:function(){return""+((new Date).getTime()+Math.random())}}}},{}],87:[function(t,e,i){t("./CCSpriteFrame"),cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(t){var e=this._CCNS_REG2.exec(t);if(!e)return cc.rect(0,0,0,0);else return cc.rect(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4]))},_pointFromString:function(t){var e=this._CCNS_REG1.exec(t);if(!e)return cc.p(0,0);else return cc.p(parseFloat(e[1]),parseFloat(e[2]))},_sizeFromString:function(t){var e=this._CCNS_REG1.exec(t);if(!e)return cc.size(0,0);else return cc.size(parseFloat(e[1]),parseFloat(e[2]))},_getFrameConfig:function(t){var e=cc.loader.getRes(t);if(cc.assert(e,cc._LogInfos.spriteFrameCache._getFrameConfig_2,t),cc.loader.release(t),e._inited)return this._frameConfigCache[t]=e,e;else return this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t]},_getFrameConfigByJsonObject:function(t,e){return cc.assert(e,cc._LogInfos.spriteFrameCache._getFrameConfig_2,t),this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t]},_parseFrameConfig:function(t){var e=t.frames,i=t.metadata||t.meta,n={},r={},o=0;if(i){var s=i.format;o=s.length<=1?parseInt(s):s,r.image=i.textureFileName||i.textureFileName||i.image}for(var c in e){var a=e[c];if(a){var h={};if(0==o){h.rect=cc.rect(a.x,a.y,a.width,a.height),h.rotated=!1,h.offset=cc.p(a.offsetX,a.offsetY);var l=a.originalWidth,u=a.originalHeight;if(!l||!u)cc.log(cc._LogInfos.spriteFrameCache._getFrameConfig);l=Math.abs(l),u=Math.abs(u),h.size=cc.size(l,u)}else if(1==o||2==o)h.rect=this._rectFromString(a.frame),h.rotated=a.rotated||!1,h.offset=this._pointFromString(a.offset),h.size=this._sizeFromString(a.sourceSize);else if(3==o){var f=this._sizeFromString(a.spriteSize),d=this._rectFromString(a.textureRect);if(f)d=cc.rect(d.x,d.y,f.width,f.height);h.rect=d,h.rotated=a.textureRotated||!1,h.offset=this._pointFromString(a.spriteOffset),h.size=this._sizeFromString(a.spriteSourceSize),h.aliases=a.aliases}else{var p=a.frame,_=a.sourceSize;c=a.filename||c,h.rect=cc.rect(p.x,p.y,p.w,p.h),h.rotated=a.rotated||!1,h.offset=cc.p(0,0),h.size=cc.size(_.w,_.h)}n[c]=h}else;}return{_inited:!0,frames:n,meta:r}},_addSpriteFramesByObject:function(t,e,i){if(cc.assert(t,cc._LogInfos.spriteFrameCache.addSpriteFrames_2),e&&e.frames){var n=this._frameConfigCache[t]||this._getFrameConfigByJsonObject(t,e);this._createSpriteFrames(t,n,i)}},_createSpriteFrames:function(t,e,i){var n=e.frames,r=e.meta;if(!i){var o=cc.path.changeBasename(t,r.image||".png");i=cc.textureCache.addImage(o)}else if(i instanceof cc.Texture2D);else if(cc.js.isString(i))i=cc.textureCache.addImage(i);else cc.assert(0,cc._LogInfos.spriteFrameCache.addSpriteFrames_3);var s=this._spriteFramesAliases,c=this._spriteFrames;for(var a in n){var h=n[a],l=c[a];if(!l){l=new cc.SpriteFrame(i,h.rect,h.rotated,h.offset,h.size);var u=h.aliases;if(u)for(var f=0,d=u.length;d>f;f++){var p=u[f];if(s[p])cc.log(cc._LogInfos.spriteFrameCache.addSpriteFrames,p);s[p]=a}if(cc._renderType===cc.game.RENDER_TYPE_CANVAS&&l.isRotated()){var _=l.getTexture();if(_.isLoaded()){var g=l.getTexture().getHtmlElementObj();g=_ccsg.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(g,l.getRect());var v=new cc.Texture2D;v.initWithElement(g),v.handleLoadedTexture(),l.setTexture(v);var m=l._rect;l.setRect(cc.rect(0,0,m.width,m.height))}}c[a]=l}}},addSpriteFrames:function(t,e){cc.assert(t,cc._LogInfos.spriteFrameCache.addSpriteFrames_2);var i=this._frameConfigCache[t]||cc.loader.getRes(t);if(i&&i.frames){var n=this._frameConfigCache[t]||this._getFrameConfig(t);this._createSpriteFrames(t,n,e)}},_checkConflict:function(t){var e=t.frames;for(var i in e)if(this._spriteFrames[i])cc.log(cc._LogInfos.spriteFrameCache._checkConflict,i)},addSpriteFrame:function(t,e){this._spriteFrames[e]=t},removeSpriteFrames:function(){this._spriteFrames={},this._spriteFramesAliases={}},removeSpriteFrameByName:function(t){if(t){if(this._spriteFramesAliases[t])delete this._spriteFramesAliases[t];if(this._spriteFrames[t])delete this._spriteFrames[t]}},removeSpriteFramesFromFile:function(t){var e=this,i=e._spriteFrames,n=e._spriteFramesAliases,r=e._frameConfigCache[t];if(r){var o=r.frames;for(var s in o)if(i[s]){delete i[s];for(var c in n)if(n[c]===s)delete n[c]}}},removeSpriteFramesFromTexture:function(t){var e=this,i=e._spriteFrames,n=e._spriteFramesAliases;for(var r in i){var o=i[r];if(o&&o.getTexture()===t){delete i[r];for(var s in n)if(n[s]===r)delete n[s]}}},getSpriteFrame:function(t){var e=this,i=e._spriteFrames[t];if(!i){var n=e._spriteFramesAliases[t];if(n)if(i=e._spriteFrames[n.toString()],!i)delete e._spriteFramesAliases[t]}return i},_clear:function(){this._spriteFrames={},this._spriteFramesAliases={},this._frameConfigCache={}}}},{"./CCSpriteFrame":134}],88:[function(t,e,i){t("../platform/CCSys");var n=/(\.[^\.\/\?\\]*)(\?.*)?$/,r=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var t=arguments.length,e="",i=0;t>i;i++)e=(e+(""===e?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return e},extname:function(t){var e=n.exec(t);return e?e[1]:""},mainFileName:function(t){if(t){var e=t.lastIndexOf(".");if(-1!==e)return t.substring(0,e)}return t},basename:function(t,e){var i=t.indexOf("?");if(i>0)t=t.substring(0,i);var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g,r=n.exec(t.replace(/(\/|\\\\)$/,""));if(!r)return null;var o=r[2];if(e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase())return o.substring(0,o.length-e.length);else return o},dirname:function(t){return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";if(i>0)n=t.substring(i),t=t.substring(0,i);if(i=t.lastIndexOf("."),0>i)return t+e+n;else return t.substring(0,i)+e+n},changeBasename:function(t,e,i){if(0===e.indexOf("."))return this.changeExtname(t,e);var n=t.indexOf("?"),r="",o=i?this.extname(t):"";if(n>0)r=t.substring(n),t=t.substring(0,n);return n=t.lastIndexOf("/"),n=0>=n?0:n+1,t.substring(0,n)+e+o+r},_normalize:function(t){var e=t=String(t);do e=t,t=t.replace(r,"");while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",_setEndWithSep:function(t,e){var i=cc.path.sep;if("undefined"==typeof e)e=!0;else if("string"==typeof e)i=e,e=!!e;var n=t[t.length-1],r="\\"===n||"/"===n;if(!r&&e)t+=i;else if(r&&!e)t=t.slice(0,-1);return t}},e.exports=cc.path},{"../platform/CCSys":71}],89:[function(t,e,i){function n(t){var e=t.parent.getChildren(),i=0;if(e.length>=2){var n=e[e.length-2];i=n.getOrderOfArrival()+1}return t.setOrderOfArrival(i),i}var r=cc.js,o=t("./scene-graph-helper"),s=t("../platform/CCObject").Flags.Destroying,c=t("./misc").DirtyFlags,a=t("../platform/id-generater"),h="position-changed",l="rotation-changed",u="scale-changed",f="size-changed",d="anchor-changed",p="color-changed",_="opacity-changed",g="child-added",v="child-removed",m="child-reorder",y=!1,b=new a("Node"),T=cc.Class({"extends":cc.Object,mixins:[cc.EventTarget],properties:{_opacity:255,_color:cc.Color.WHITE,_cascadeOpacityEnabled:!0,_parent:null,_anchorPoint:cc.p(.5,.5),_contentSize:cc.size(0,0),_children:[],_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:cc.p(0,0),_skewX:0,_skewY:0,_localZOrder:0,_globalZOrder:0,_tag:cc.macro.NODE_TAG_INVALID,_opacityModifyRGB:!1,_reorderChildDirty:!1,name:{get:function(){return this._name},set:function(t){this._name=t}},parent:{get:function(){return this._parent},set:function(t){if(this._parent!==t){if(false)if(_Scene.DetectConflict.beforeAddChild(this))return;var e=this._sgNode;if(e.parent)e.parent.removeChild(e,!1);if(t){var i=t._sgNode;i.addChild(e),n(e),t._children.push(this),t.emit(g,this)}var r=this._parent;if(this._parent=t||null,r){if(!(r._objFlags&s)){var o=r._children.indexOf(this);if(false)return cc.error("Internal error, should not remove unknown node from parent.");r._children.splice(o,1),r.emit(v,this),this._onHierarchyChanged(r)}}else if(t)this._onHierarchyChanged(null)}}},_id:{"default":"",editorOnly:!0},uuid:{get:function(){var t=this._id;if(!t)t=this._id=!1?Editor.UuidUtils.uuid():b.getNewId();return t}},skewX:{get:function(){return this._skewX},set:function(t){this._skewX=t,this._sgNode.skewX=t}},skewY:{get:function(){return this._skewY},set:function(t){this._skewY=t,this._sgNode.skewY=t}},zIndex:{get:function(){return this._localZOrder},set:function(t){if(this._localZOrder=t,this._sgNode.zIndex=t,false)this._parent._reorderChildDirty=!0,this._parent._delaySort(),cc.eventManager._setDirtyForNode(this)}},rotation:{get:function(){if(this._rotationX!==this._rotationY)cc.log(cc._LogInfos.Node.getRotation);return this._rotationX},set:function(t){if(this._rotationX!==t||this._rotationY!==t){var e=this._rotationX;this._rotationX=this._rotationY=t,this._sgNode.rotation=t,this.emit(l,e)}}},rotationX:{get:function(){return this._rotationX},set:function(t){if(this._rotationX!==t){var e=this._rotationX;this._rotationX=t,this._sgNode.rotationX=t,this.emit(l,e)}}},rotationY:{get:function(){return this._rotationY},set:function(t){if(this._rotationY!==t){var e=this._rotationX;this._rotationY=t,this._sgNode.rotationY=t,this.emit(l,e)}}},scaleX:{get:function(){return this._scaleX},set:function(t){if(this._scaleX!==t){var e=this._scaleX;this._scaleX=t,this._sgNode.scaleX=t,this.emit(u,new cc.Vec2(e,this._scaleY))}}},scaleY:{get:function(){return this._scaleY},set:function(t){if(this._scaleY!==t){var e=this._scaleY;this._scaleY=t,this._sgNode.scaleY=t,this.emit(u,new cc.Vec2(this._scaleX,e))}}},x:{get:function(){return this._position.x},set:function(t){var e=this._position;if(t!==e.x)if(isFinite(t),!0){var i=e.x;if(e.x=t,this._sgNode.x=t,this.emit)this.emit(h,new cc.Vec2(i,e.y))}else cc.error(y,"new x")}},y:{get:function(){return this._position.y},set:function(t){var e=this._position;if(t!==e.y)if(isFinite(t),!0){var i=e.y;if(e.y=t,this._sgNode.y=t,this.emit)this.emit(h,new cc.Vec2(e.x,i))}else cc.error(y,"new y")}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},anchorX:{get:function(){return this._anchorPoint.x},set:function(t){if(this._anchorPoint.x!==t){var e=cc.v2(this._anchorPoint);this._anchorPoint.x=t,this._onAnchorChanged(),this.emit(d,e)}}},anchorY:{get:function(){return this._anchorPoint.y},set:function(t){if(this._anchorPoint.y!==t){var e=cc.v2(this._anchorPoint);this._anchorPoint.y=t,this._onAnchorChanged(),this.emit(d,e)}}},width:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getWidth();return this._contentSize.width=t,t}else return this._contentSize.width},set:function(t){if(t!==this._contentSize.width){if(this._sizeProvider)this._sizeProvider.setContentSize(t,this._sizeProvider._getHeight());var e=cc.size(this._contentSize);this._contentSize.width=t,this.emit(f,e)}}},height:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getHeight();return this._contentSize.height=t,t}else return this._contentSize.height},set:function(t){if(t!==this._contentSize.height){if(this._sizeProvider)this._sizeProvider.setContentSize(this._sizeProvider._getWidth(),t);var e=cc.size(this._contentSize);this._contentSize.height=t,this.emit(f,e)}}},_ignoreAnchor:{get:function(){return this.__ignoreAnchor},set:function(t){if(this.__ignoreAnchor!==t)this.__ignoreAnchor=t,this._sgNode.ignoreAnchor=t,this._onAnchorChanged(),this.emit(d,this._anchorPoint)}},tag:{get:function(){return this._tag},set:function(t){this._tag=t,this._sgNode.tag=t}},opacity:{get:function(){return this._opacity},set:function(t){if(this._opacity!==t){var e=this._opacity;this._opacity=t,this._sgNode.opacity=t,this._onColorChanged(),this.emit(_,e)}},range:[0,255]},cascadeOpacity:{get:function(){return this._cascadeOpacityEnabled},set:function(t){if(this._cascadeOpacityEnabled!==t)this._cascadeOpacityEnabled=t,this._sgNode.cascadeOpacity=t,this._onCascadeChanged()}},color:{get:function(){var t=this._color;return new cc.Color(t.r,t.g,t.b,t.a)},set:function(t){if(!this._color.equals(t)){var e=this._color,i=cc.color(e);if(e.r=t.r,e.g=t.g,e.b=t.b,false)cc.warn('Should not set alpha via "color", use "opacity" please.');this._onColorChanged(),this.emit(p,i)}}}},ctor:function(){Object.defineProperty(this,"_id",{value:"",enumerable:!1});var t=this._sgNode=new _ccsg.Node;if(cc.sys.isNative){t.retain();var e=this;t.onEnter=function(){if(_ccsg.Node.prototype.onEnter.call(this),!e._active)cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this)}}if(!cc.game._isCloning)t.cascadeOpacity=!0;this._dirtyFlags=c.ALL,this._sizeProvider=null,this.__ignoreAnchor=!1},_onPreDestroy:function(){this._sgNode.release()},_onHierarchyChanged:null,_onColorChanged:null,_onAnchorChanged:null,_onCascadeChanged:null,_onOpacityModifyRGBChanged:null,init:function(){return!0},attr:function(t){for(var e in t)this[e]=t[e]},setGlobalZOrder:function(t){this._globalZOrder=t,this._sgNode.setGlobalZOrder(t)},getGlobalZOrder:function(){return this._globalZOrder=this._sgNode.getGlobalZOrder(),this._globalZOrder},getScale:function(){if(this._scaleX!==this._scaleY)cc.log(cc._LogInfos.Node.getScale);return this._scaleX},setScale:function(t,e){if(t instanceof cc.Vec2)e=t.y,t=t.x;else e=e||0===e?e:t;if(this._scaleX!==t||this._scaleY!==e){var i=new cc.Vec2(this._scaleX,this._scaleY);this._scaleX=t,this._scaleY=e,this._sgNode.setScale(t,e),this.emit(u,i)}},getPosition:function(){return cc.p(this._position)},setPosition:function(t,e){var i;if(void 0===e)i=t.x,e=t.y;else i=t,e=e;var n=this._position;if(n.x!==i||n.y!==e){var r=new cc.Vec2(n);if(isFinite(i),!0)n.x=i;else return cc.error(y,"x of new position");if(isFinite(e),!0)n.y=e;else return cc.error(y,"y of new position");if(this._sgNode.setPosition(n),this.emit)this.emit(h,r)}},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i,n=this._anchorPoint;if(void 0===e){if(t.x===n.x&&t.y===n.y)return;i=cc.v2(n),n.x=t.x,n.y=t.y}else{if(t===n.x&&e===n.y)return;i=cc.v2(n),n.x=t,n.y=e}this._onAnchorChanged(),this.emit(d,i)},getAnchorPointInPoints:function(){return this._sgNode.getAnchorPointInPoints()},getContentSize:function(t){if(this._sizeProvider&&!t){var e=this._sizeProvider.getContentSize();return this._contentSize=e,e}else return cc.size(this._contentSize)},setContentSize:function(t,e){var i,n=this._contentSize;if(void 0===e){if(t.width===n.width&&t.height===n.height)return;i=cc.size(n),n.width=t.width,n.height=t.height}else{if(t===n.width&&e===n.height)return;i=cc.size(n),n.width=t,n.height=e}if(this._sizeProvider)this._sizeProvider.setContentSize(n);this.emit(f,i)},getBoundingBox:function(){var t=this.getContentSize(),e=cc.rect(0,0,t.width,t.height);return cc._rectApplyAffineTransformIn(e,this.getNodeToParentTransform())},cleanup:function(){cc.director.getActionManager().removeAllActionsFromTarget(this),cc.eventManager.removeListeners(this);var t,e,i=this._children.length;for(t=0;i>t;++t)if(e=this._children[t])e.cleanup()},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];if(n&&n.tag===t)return n}return null},getChildByUuid:function(t){if(!t)return cc.log("Invalid uuid"),null;for(var e=this._children,i=0,n=e.length;n>i;i++)if(e[i]._id===t)return e[i];return null},getChildByName:function(t){if(!t)return cc.log("Invalid name"),null;for(var e=this._children,i=0,n=e.length;n>i;i++)if(e[i]._name===t)return e[i];return null},addChild:function(t,e,i){e=void 0===e?t._localZOrder:e;var n,r=!1;if(cc.js.isUndefined(i))i=void 0,n=t._name;else if(cc.js.isString(i))n=i,i=void 0;else if(cc.js.isNumber(i))r=!0,n="";cc.assert(t,cc._LogInfos.Node.addChild_3),cc.assert(null===t._parent,"child already added. It can't be added again"),this._addChildHelper(t,e,i,n,r)},_addChildHelper:function(t,e,i,n,r){if(this._insertChild(t,e),r)t.setTag(i);else t.setName(n)},_insertChild:function(t,e){t.parent=this,t.zIndex=e},removeFromParent:function(t){if(this._parent){if(void 0===t)t=!0;this._parent.removeChild(this,t)}},removeChild:function(t,e){if(0!==this._children.length){if(void 0===e)e=!0;if(this._children.indexOf(t)>-1)this._detachChild(t,e)}},removeChildByTag:function(t,e){if(t===cc.macro.NODE_TAG_INVALID)cc.log(cc._LogInfos.Node.removeChildByTag);var i=this.getChildByTag(t);if(!i)cc.log(cc._LogInfos.Node.removeChildByTag_2,t);else this.removeChild(i,e)},removeAllChildren:function(t){var e=this._children;if(void 0===t)t=!0;for(var i=e.length-1;i>=0;i--){var n=e[i];if(n){if(t)n.cleanup();n.parent=null}}this._children.length=0},_detachChild:function(t,e){if(e)t.cleanup();t.parent=null},setNodeDirty:function(){this._sgNode.setNodeDirty()},getParentToNodeTransform:function(){return this._sgNode.getParentToNodeTransform();
},_isSgTransformArToMe:function(t){var e=this._sgNode.getContentSize();if(0===e.width&&0===e.height&&(0!==t.width||0!==t.height))return!0;if(this._sgNode.isIgnoreAnchorPointForPosition())return!0;else return!1},getNodeToWorldTransform:function(){var t=this.getContentSize();if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getNodeToWorldTransformAR:function(){var t=this.getContentSize();if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getWorldToNodeTransform:function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)cc.director._visitScene();return this._sgNode.getWorldToNodeTransform()},convertToNodeSpace:function(t){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)cc.director._visitScene();var e=this._sgNode.convertToNodeSpace(t);return cc.pAdd(e,cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},convertToWorldSpace:function(t){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)cc.director._visitScene();var e=this._sgNode.convertToWorldSpace(t);return cc.pSub(e,cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},convertToNodeSpaceAR:function(t){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)cc.director._visitScene();if(this._sgNode.isIgnoreAnchorPointForPosition())return cc.v2(this._sgNode.convertToNodeSpace(t));else return this._sgNode.convertToNodeSpaceAR(t)},convertToWorldSpaceAR:function(t){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)cc.director._visitScene();if(this._sgNode.isIgnoreAnchorPointForPosition())return cc.v2(this._sgNode.convertToWorldSpace(t));else return cc.v2(this._sgNode.convertToWorldSpaceAR(t))},convertTouchToNodeSpace:function(t){return this.convertToNodeSpace(t.getLocation())},convertTouchToNodeSpaceAR:function(t){return this.convertToNodeSpaceAR(t.getLocation())},getNodeToParentTransform:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getNodeToParentTransformAR:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getBoundingBoxToWorld:function(){var t;if(this.parent)t=this.parent.getNodeToWorldTransformAR();return this._getBoundingBoxTo(t)},_getBoundingBoxTo:function(t){var e=this.getContentSize(),i=e.width,n=e.height,r=cc.rect(-this._anchorPoint.x*i,-this._anchorPoint.y*n,i,n),o=cc.affineTransformConcat(this.getNodeToParentTransformAR(),t);if(cc._rectApplyAffineTransformIn(r,o),!this._children)return r;for(var s=this._children,c=0;c<s.length;c++){var a=s[c];if(a&&a.active){var h=a._getBoundingBoxTo(o);if(h)r=cc.rectUnion(r,h)}}return r},getDisplayedOpacity:function(){return this._sgNode.getDisplayedOpacity()},_updateDisplayedOpacity:function(t){this._sgNode.updateDisplayedOpacity(t)},getDisplayedColor:function(){return this._sgNode.getDisplayedColor()},setOpacityModifyRGB:function(t){if(this._opacityModifyRGB!==t)this._opacityModifyRGB=t,this._sgNode.setOpacityModifyRGB(t),this._onOpacityModifyRGBChanged()},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getSiblingIndex:function(){if(this._parent)return this._parent._children.indexOf(this);else return 0},setSiblingIndex:function(t){if(this._parent){var e=this._parent._children;t=-1!==t?t:e.length-1;var i=e.indexOf(this);if(t!==i){if(e.splice(i,1),t<e.length)e.splice(t,0,this);else e.push(this);for(var n=this._parent._children,r=0,o=n.length;o>r;r++){var s=n[r];s._sgNode.arrivalOrder=r}if(0)cc.renderer.childrenOrderDirty=!0,this._parent._sgNode._reorderChildDirty=!0,this._parent._reorderChildDirty=!0,this._parent._delaySort()}}},isChildOf:function(t){var e=this;do{if(e===t)return!0;e=e._parent}while(e);return!1},sortAllChildren:function(){if(this._reorderChildDirty){var t=this._children;if(!t)return void(this._reorderChildDirty=!1);var e,i,n,r=t.length;for(e=1;r>e;e++){for(n=t[e],i=e-1;i>=0;){if(n._localZOrder<t[i]._localZOrder)t[i+1]=t[i];else if(n._localZOrder===t[i]._localZOrder&&n._sgNode.arrivalOrder<t[i]._sgNode.arrivalOrder)t[i+1]=t[i];else break;i--}t[i+1]=n}this._reorderChildDirty=!1,this.emit(m)}cc.director.off(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_delaySort:function(){cc.director.on(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_updateDummySgNode:function(){var t=this._sgNode;t.setPosition(this._position),t.setRotationX(this._rotationX),t.setRotationY(this._rotationY),t.setScale(this._scaleX,this._scaleY),t.setSkewX(this._skewX),t.setSkewY(this._skewY),t.ignoreAnchorPointForPosition(this.__ignoreAnchor);var e=t.arrivalOrder;t.setLocalZOrder(this._localZOrder),t.arrivalOrder=e,t.setGlobalZOrder(this._globalZOrder),t.setOpacity(this._opacity),t.setOpacityModifyRGB(this._opacityModifyRGB),t.setCascadeOpacityEnabled(this._cascadeOpacityEnabled),t.setTag(this._tag)},_updateSgNode:function(){this._updateDummySgNode();var t=this._sgNode;if(t.setAnchorPoint(this._anchorPoint),t.setVisible(this._active),t.setColor(this._color),this._activeInHierarchy)cc.director.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this);else cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this)},_onBatchCreated:function(){if(this._updateDummySgNode(),this._parent)this._parent._sgNode.addChild(this._sgNode);if(!this._activeInHierarchy)cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this);for(var t=this._children,e=0,i=t.length;i>e;e++)t[e]._onBatchCreated()},_removeSgNode:o.removeSgNode});!function(){for(var t,e=["name","skewX","skewY","position","rotation","rotationX","rotationY","scale","scaleX","scaleY","children","childrenCount","parent","running","scheduler","opacity","color","tag"],i={x:["getPositionX","setPositionX"],y:["getPositionY","setPositionY"],zIndex:["getLocalZOrder","setLocalZOrder"],opacityModifyRGB:["isOpacityModifyRGB"],cascadeOpacity:["isCascadeOpacityEnabled","setCascadeOpacityEnabled"],cascadeColor:["isCascadeColorEnabled","setCascadeColorEnabled"]},n=T.prototype,o=0;o<e.length;o++){t=e[o];var s=t[0].toUpperCase()+t.slice(1),c=Object.getOwnPropertyDescriptor(n,t);if(c){if(c.get)n["get"+s]=c.get;if(c.set)n["set"+s]=c.set}else r.getset(n,t,n["get"+s],n["set"+s])}for(t in i){var a=i[t],c=Object.getOwnPropertyDescriptor(n,t);if(c){if(n[a[0]]=c.get,a[1])n[a[1]]=c.set}else r.getset(n,t,n[a[0]],n[a[1]])}}(),cc._BaseNode=e.exports=T},{"../platform/CCObject":70,"../platform/id-generater":77,"./misc":91,"./scene-graph-helper":92}],90:[function(t,e,i){cc.find=e.exports=function(t,e){if(null==t)return cc.error("Argument must be non-nil"),null;if(!e){var i=cc.director.getScene();if(!i)return cc.warn("Can not get current scene."),null;e=i}for(var n=e,r="/"!==t[0]?0:1,o=t.split("/"),s=r;s<o.length;s++){var c=o[s],a=n._children;n=null;for(var h=0,l=a.length;l>h;++h){var u=a[h];if(u.name===c){n=u;break}}if(!n)return null}return n}},{}],91:[function(t,e,i){var n=cc.js,r={};r.propertyDefine=function(t,e,i){for(var r,o=t.prototype,s=0;s<e.length;s++){r=e[s];var c=r[0].toUpperCase()+r.slice(1),a=Object.getOwnPropertyDescriptor(o,r);if(a){if(a.get)o["get"+c]=a.get;if(a.set)o["set"+c]=a.set}else n.getset(o,r,o["get"+c],o["set"+c])}for(r in i){var h=i[r],a=Object.getOwnPropertyDescriptor(o,r);if(a){if(o[h[0]]=a.get,h[1])o[h[1]]=a.set}else n.getset(o,r,o[h[0]],o[h[1]])}},r.NextPOT=function(t){return t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1};var o=r.DirtyFlags={TRANSFORM:1,SIZE:2,ALL:3};o.WIDGET=o.TRANSFORM|o.SIZE,e.exports=r},{}],92:[function(t,e,i){var n={removeSgNode:function(){var t=this._sgNode;if(t){var e=t._parent;if(e)e.removeChild(t);t.release()}}};if(!1)n._getChildrenOffset=function(t){if(t){var e=t._sgNode,i=t._children[0];if(i){var n=i._sgNode,r=e._children.indexOf(n);if(-1!==r)return r;else return cc.error("%s's scene graph node not contains in the parent's children",i.name),-1}else return e._children.length}else return 0},n.checkMatchCurrentScene=function(){function t(e,i){if(e._sgNode!==i)throw new Error("scene graph node not equal: "+e.name);var r=e._children.length,o=n._getChildrenOffset(e);if(i._children.length!==r+o)throw new Error("Mismatched child scene graphs: "+e.name);for(var s=0;r>s;s++)t(e._children[s],i._children[o+s])}var e=cc.director.getScene(),i=cc.director.getRunningScene();t(e,i)},cc._Test.SceneGraphUtils=n;e.exports=n},{}],93:[function(t,e,i){cc.AffineTransform=function(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o},cc.affineTransformMake=function(t,e,i,n,r,o){return{a:t,b:e,c:i,d:n,tx:r,ty:o}},cc.affineTransformClone=function(t){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx,ty:t.ty}},cc.pointApplyAffineTransform=function(t,e,i){var n,r;if(void 0===i)i=e,n=t.x,r=t.y;else n=t,r=e;return{x:i.a*n+i.c*r+i.tx,y:i.b*n+i.d*r+i.ty}},cc._pointApplyAffineTransform=function(t,e,i){return cc.pointApplyAffineTransform(t,e,i)},cc.sizeApplyAffineTransform=function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(t,e){var i=cc.rectGetMinY(t),n=cc.rectGetMinX(t),r=cc.rectGetMaxX(t),o=cc.rectGetMaxY(t),s=cc.pointApplyAffineTransform(n,i,e),c=cc.pointApplyAffineTransform(r,i,e),a=cc.pointApplyAffineTransform(n,o,e),h=cc.pointApplyAffineTransform(r,o,e),l=Math.min(s.x,c.x,a.x,h.x),u=Math.max(s.x,c.x,a.x,h.x),f=Math.min(s.y,c.y,a.y,h.y),d=Math.max(s.y,c.y,a.y,h.y);return cc.rect(l,f,u-l,d-f)},cc._rectApplyAffineTransformIn=function(t,e){var i=cc.rectGetMinY(t),n=cc.rectGetMinX(t),r=cc.rectGetMaxX(t),o=cc.rectGetMaxY(t),s=cc.pointApplyAffineTransform(n,i,e),c=cc.pointApplyAffineTransform(r,i,e),a=cc.pointApplyAffineTransform(n,o,e),h=cc.pointApplyAffineTransform(r,o,e),l=Math.min(s.x,c.x,a.x,h.x),u=Math.max(s.x,c.x,a.x,h.x),f=Math.min(s.y,c.y,a.y,h.y),d=Math.max(s.y,c.y,a.y,h.y);return t.x=l,t.y=f,t.width=u-l,t.height=d-f,t},cc.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},cc.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},cc.affineTransformRotate=function(t,e){var i=Math.sin(e),n=Math.cos(e);return{a:t.a*n+t.c*i,b:t.b*n+t.d*i,c:t.c*n-t.a*i,d:t.d*n-t.b*i,tx:t.tx,ty:t.ty}},cc.affineTransformConcat=function(t,e){return{a:t.a*e.a+t.b*e.c,b:t.a*e.b+t.b*e.d,c:t.c*e.a+t.d*e.c,d:t.c*e.b+t.d*e.d,tx:t.tx*e.a+t.ty*e.c+e.tx,ty:t.tx*e.b+t.ty*e.d+e.ty}},cc.affineTransformConcatIn=function(t,e){var i=t.a,n=t.b,r=t.c,o=t.d,s=t.tx,c=t.ty;return t.a=i*e.a+n*e.c,t.b=i*e.b+n*e.d,t.c=r*e.a+o*e.c,t.d=r*e.b+o*e.d,t.tx=s*e.a+c*e.c+e.tx,t.ty=s*e.b+c*e.d+e.ty,t},cc.affineTransformEqualToTransform=function(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty},cc.affineTransformInvert=function(t){var e=1/(t.a*t.d-t.b*t.c);return{a:e*t.d,b:-e*t.b,c:-e*t.c,d:e*t.a,tx:e*(t.c*t.ty-t.d*t.tx),ty:e*(t.b*t.tx-t.a*t.ty)}}},{}],94:[function(t,e,i){var n=t("./CCValueType"),r=t("../platform/js"),o=function(){function e(t,e,i,n){if("object"==typeof t)e=t.g,i=t.b,n=t.a,t=t.r;this.r="number"==typeof t?t:0,this.g="number"==typeof e?e:0,this.b="number"==typeof i?i:0,this.a="number"==typeof n?n:255}r.extend(e,n),t("../platform/CCClass").fastDefine("cc.Color",e,["r","g","b","a"]);var i={WHITE:[255,255,255,255],BLACK:[0,0,0,255],TRANSPARENT:[0,0,0,0],GRAY:[127.5,127.5,127.5],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,235,4],ORANGE:[255,127,0],CYAN:[0,255,255],MAGENTA:[255,0,255]};for(var o in i){var s=function(t,i,n,r){return function(){return new e(t,i,n,r)}}.apply(null,i[o]);Object.defineProperty(e,o,{get:s})}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.a)},e.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},e.prototype.lerp=function(t,i,n){n=n||new e;var r=this.r,o=this.g,s=this.b,c=this.a;return n.r=r+(t.r-r)*i,n.g=o+(t.g-o)*i,n.b=s+(t.b-s)*i,n.a=c+(t.a-c)*i,n},e.prototype.toString=function(){return"rgba("+this.r.toFixed()+", "+this.g.toFixed()+", "+this.b.toFixed()+", "+this.a.toFixed()+")"},e.prototype.setR=function(t){return this.r=t,this},e.prototype.setG=function(t){return this.g=t,this},e.prototype.setB=function(t){return this.b=t,this},e.prototype.setA=function(t){return this.a=t,this},e.prototype.toCSS=function(t){if("rgba"===t)return"rgba("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+","+(this.a/255).toFixed(2)+")";else if("rgb"===t)return"rgb("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+")";else return"#"+this.toHEX(t)},e.prototype.clamp=function(){this.r=cc.clampf(this.r,0,255),this.g=cc.clampf(this.g,0,255),this.b=cc.clampf(this.b,0,255),this.a=cc.clampf(this.a,0,255)},e.prototype.fromHEX=function(t){var e=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return this.r=e>>16,this.g=(65280&e)>>8,this.b=255&e,this},e.prototype.toHEX=function(t){var e=[(0|this.r).toString(16),(0|this.g).toString(16),(0|this.b).toString(16)],i=-1;if("#rgb"===t){for(i=0;i<e.length;++i)if(e[i].length>1)e[i]=e[i][0]}else if("#rrggbb"===t)for(i=0;i<e.length;++i)if(1===e[i].length)e[i]="0"+e[i];return e.join("")},e.prototype.toRGBValue=function(){return(cc.clampf(this.r,0,255)<<16)+(cc.clampf(this.g,0,255)<<8)+cc.clampf(this.b,0,255)},e.prototype.fromHSV=function(t,i,n){var r=e.hsv2rgb(t,i,n);return this.r=r.r,this.g=r.g,this.b=r.b,this},e.prototype.toHSV=function(){return e.rgb2hsv(this.r,this.g,this.b)},e}();o.rgb2hsv=function(t,e,i){t/=255,e/=255,i/=255;var n={h:0,s:0,v:0},r=Math.max(t,e,i),o=Math.min(t,e,i),s=0;if(n.v=r,n.s=r?(r-o)/r:0,!n.s)n.h=0;else{if(s=r-o,t===r)n.h=(e-i)/s;else if(e===r)n.h=2+(i-t)/s;else n.h=4+(t-e)/s;if(n.h/=6,n.h<0)n.h+=1}return n},o.hsv2rgb=function(t,e,i){var n={r:0,g:0,b:0};if(0===e)n.r=n.g=n.b=i;else if(0===i)n.r=n.g=n.b=0;else{if(1===t)t=0;t*=6,e=e,i=i;var r=Math.floor(t),o=t-r,s=i*(1-e),c=i*(1-e*o),a=i*(1-e*(1-o));switch(r){case 0:n.r=i,n.g=a,n.b=s;break;case 1:n.r=c,n.g=i,n.b=s;break;case 2:n.r=s,n.g=i,n.b=a;break;case 3:n.r=s,n.g=c,n.b=i;break;case 4:n.r=a,n.g=s,n.b=i;break;case 5:n.r=i,n.g=s,n.b=c}}return n.r*=255,n.g*=255,n.b*=255,n},cc.Color=o,cc.color=function(t,e,i,n){if(r.isString(t)){var o=new cc.Color;return o.fromHEX(t)}if(cc.js.isObject(t))return new cc.Color(t.r,t.g,t.b,t.a);else return new cc.Color(t,e,i,n)},cc.colorEqual=function(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b},cc.hexToColor=function(t){t=t.replace(/^#?/,"0x");var e=parseInt(t),i=e>>16,n=(65280&e)>>8,r=255&e;return cc.color(i,n,r)},cc.colorToHex=function(t){var e=t.r.toString(16),i=t.g.toString(16),n=t.b.toString(16);return"#"+(t.r<16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},e.exports=cc.Color},{"../platform/CCClass":68,"../platform/js":80,"./CCValueType":101}],95:[function(t,e,i){if(cc.Enum=function(t){var e={};Object.defineProperty(e,"__enums__",{value:void 0,writable:!0});var i=-1;for(var n in t){var r=t[n];if(-1===r)r=++i;else i=r;e[n]=r;var o=""+r;if(n!==o)Object.defineProperty(e,o,{value:n,enumerable:!1})}return e},cc.Enum.isEnum=function(t){return t&&t.hasOwnProperty("__enums__")},cc.Enum.getList=function(t){if(void 0!==t.__enums__)return t.__enums__;var e=[];for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],r="number"==typeof n&&(0|n)===n;if(r)e.push({name:i,value:n})}return e.sort(function(t,e){return t.value-e.value}),t.__enums__=e,e},!1){var n=cc.Enum({ZERO:-1,ONE:-1,TWO:-1,THREE:-1});if(0!==n.ZERO||1!==n.ONE||2!==n.TWO||3!==n.THREE)cc.error('Sorry, "cc.Enum" not available on this platform, please report this error here: https://github.com/fireball-x/fireball/issues/new')}e.exports=cc.Enum},{}],96:[function(t,e,i){var n=parseFloat("1.192092896e-07F");cc.pNeg=function(t){return cc.p(-t.x,-t.y)},cc.pAdd=function(t,e){return cc.p(t.x+e.x,t.y+e.y)},cc.pSub=function(t,e){return cc.p(t.x-e.x,t.y-e.y)},cc.pMult=function(t,e){return cc.p(t.x*e,t.y*e)},cc.pMidpoint=function(t,e){return cc.pMult(cc.pAdd(t,e),.5)},cc.pDot=function(t,e){return t.x*e.x+t.y*e.y},cc.pCross=function(t,e){return t.x*e.y-t.y*e.x},cc.pPerp=function(t){return cc.p(-t.y,t.x)},cc.pRPerp=function(t){return cc.p(t.y,-t.x)},cc.pProject=function(t,e){return cc.pMult(e,cc.pDot(t,e)/cc.pDot(e,e))},cc.pLengthSQ=function(t){return cc.pDot(t,t)},cc.pDistanceSQ=function(t,e){return cc.pLengthSQ(cc.pSub(t,e))},cc.pLength=function(t){return Math.sqrt(cc.pLengthSQ(t))},cc.pDistance=function(t,e){return cc.pLength(cc.pSub(t,e))},cc.pNormalize=function(t){var e=cc.pLength(t);return 0===e?cc.p(t):cc.pMult(t,1/e)},cc.pForAngle=function(t){return cc.p(Math.cos(t),Math.sin(t))},cc.pToAngle=function(t){return Math.atan2(t.y,t.x)},cc.clampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return e>t?e:i>t?t:i},cc.clamp01=function(t){return 0>t?0:1>t?t:1},cc.pClamp=function(t,e,i){return cc.p(cc.clampf(t.x,e.x,i.x),cc.clampf(t.y,e.y,i.y))},cc.pFromSize=function(t){return cc.p(t.width,t.height)},cc.pCompOp=function(t,e){return cc.p(e(t.x),e(t.y))},cc.pLerp=function(t,e,i){return cc.pAdd(cc.pMult(t,1-i),cc.pMult(e,i))},cc.pFuzzyEqual=function(t,e,i){if(t.x-i<=e.x&&e.x<=t.x+i)if(t.y-i<=e.y&&e.y<=t.y+i)return!0;return!1},cc.pCompMult=function(t,e){return cc.p(t.x*e.x,t.y*e.y)},cc.pAngleSigned=function(t,e){var i=cc.pNormalize(t),r=cc.pNormalize(e),o=Math.atan2(i.x*r.y-i.y*r.x,cc.pDot(i,r));if(Math.abs(o)<n)return 0;else return o},cc.pAngle=function(t,e){var i=Math.acos(cc.pDot(cc.pNormalize(t),cc.pNormalize(e)));if(Math.abs(i)<n)return 0;else return i},cc.pRotateByAngle=function(t,e,i){var n=cc.pSub(t,e),r=Math.cos(i),o=Math.sin(i),s=n.x;return n.x=s*r-n.y*o+e.x,n.y=s*o+n.y*r+e.y,n},cc.pLineIntersect=function(t,e,i,n,r){if(t.x===e.x&&t.y===e.y||i.x===n.x&&i.y===n.y)return!1;var o=e.x-t.x,s=e.y-t.y,c=n.x-i.x,a=n.y-i.y,h=t.x-i.x,l=t.y-i.y,u=a*o-c*s;if(r.x=c*l-a*h,r.y=o*l-s*h,0===u)if(0===r.x||0===r.y)return!0;else return!1;return r.x=r.x/u,r.y=r.y/u,!0},cc.pSegmentIntersect=function(t,e,i,n){var r=cc.p(0,0);if(cc.pLineIntersect(t,e,i,n,r))if(r.x>=0&&r.x<=1&&r.y>=0&&r.y<=1)return!0;return!1},cc.pIntersectPoint=function(t,e,i,n){var r=cc.p(0,0);if(cc.pLineIntersect(t,e,i,n,r)){var o=cc.p(0,0);return o.x=t.x+r.x*(e.x-t.x),o.y=t.y+r.x*(e.y-t.y),o}return cc.p(0,0)},cc.pSameAs=function(t,e){if(null!=t&&null!=e)return t.x===e.x&&t.y===e.y;else return!1},cc.pZeroIn=function(t){t.x=0,t.y=0},cc.pIn=function(t,e){t.x=e.x,t.y=e.y},cc.pMultIn=function(t,e){t.x*=e,t.y*=e},cc.pSubIn=function(t,e){t.x-=e.x,t.y-=e.y},cc.pAddIn=function(t,e){t.x+=e.x,t.y+=e.y},cc.pNormalizeIn=function(t){cc.pMultIn(t,1/Math.sqrt(t.x*t.x+t.y*t.y))}},{}],97:[function(t,e,i){function n(t,e,i,n){if(t&&"object"==typeof t)e=t.y,i=t.width,n=t.height,t=t.x;this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0,this.width="number"==typeof i?i:0,this.height="number"==typeof n?n:0}var r=t("./CCValueType"),o=t("../platform/js");o.extend(n,r),t("../platform/CCClass").fastDefine("cc.Rect",n,["x","y","width","height"]),n.fromMinMax=function(t,e){var i=Math.min(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.x,e.x),s=Math.max(t.y,e.y);return new n(i,r,o-i,s-r)},n.contain=function(t,e){if(t.x<e.x&&t.x+t.width>e.x+e.width&&t.y<e.y&&t.y+t.height>e.y+e.height)return 1;if(e.x<t.x&&e.x+e.width>t.x+t.width&&e.y<t.y&&e.y+e.height>t.y+t.height)return-1;else return 0};var s=n.prototype;s.clone=function(){return new n(this.x,this.y,this.width,this.height)},s.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},s.lerp=function(t,e,i){i=i||new n;var r=this.x,o=this.y,s=this.width,c=this.height;return i.x=r+(t.x-r)*e,i.y=o+(t.y-o)*e,i.width=s+(t.width-s)*e,i.height=c+(t.height-c)*e,i},s.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},Object.defineProperty(s,"xMin",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t}}),Object.defineProperty(s,"yMin",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t}}),Object.defineProperty(s,"xMax",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x}}),Object.defineProperty(s,"yMax",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y}}),Object.defineProperty(s,"center",{get:function(){return new cc.Vec2(this.x+.5*this.width,this.y+.5*this.height)},set:function(t){this.x=t.x-.5*this.width,this.y=t.y-.5*this.height}}),Object.defineProperty(s,"size",{get:function(){return new cc.Size(this.width,this.height)},set:function(t){this.width=t.width,this.height=t.height}}),s.intersects=function(t){return cc.rectIntersectsRect(this,t)},s.contains=function(t){return this.x<t.x&&this.x+this.width>t.x&&this.y<t.y&&this.y+this.height>t.y},s.containsRect=function(t){return this.x<t.x&&this.x+this.width>t.x+t.width&&this.y<t.y&&this.y+this.height>t.y+t.height},cc.Rect=n,cc.rect=function(t,e,i,r){return new n(t,e,i,r)},cc.rectEqualToRect=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},cc._rectEqualToZero=function(t){return t&&0===t.x&&0===t.y&&0===t.width&&0===t.height},cc.rectContainsRect=function(t,e){if(!t||!e)return!1;else return!(t.x>=e.x||t.y>=e.y||t.x+t.width<=e.x+e.width||t.y+t.height<=e.y+e.height)},cc.rectGetMaxX=function(t){return t.x+t.width},cc.rectGetMidX=function(t){return t.x+t.width/2},cc.rectGetMinX=function(t){return t.x},cc.rectGetMaxY=function(t){return t.y+t.height},cc.rectGetMidY=function(t){return t.y+t.height/2},cc.rectGetMinY=function(t){return t.y},cc.rectContainsPoint=function(t,e){return e.x>=cc.rectGetMinX(t)&&e.x<=cc.rectGetMaxX(t)&&e.y>=cc.rectGetMinY(t)&&e.y<=cc.rectGetMaxY(t)},cc.rectIntersectsRect=function(t,e){var i=t.x+t.width,n=t.y+t.height,r=e.x+e.width,o=e.y+e.height;return!(i<e.x||r<t.x||n<e.y||o<t.y)},cc.rectOverlapsRect=function(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},cc.rectUnion=function(t,e){var i=cc.rect(0,0,0,0);return i.x=Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i},cc.rectIntersection=function(t,e){var i=cc.rect(Math.max(cc.rectGetMinX(t),cc.rectGetMinX(e)),Math.max(cc.rectGetMinY(t),cc.rectGetMinY(e)),0,0);return i.width=Math.min(cc.rectGetMaxX(t),cc.rectGetMaxX(e))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(t),cc.rectGetMaxY(e))-cc.rectGetMinY(i),i},e.exports=cc.Rect},{"../platform/CCClass":68,"../platform/js":80,"./CCValueType":101}],98:[function(t,e,i){function n(t,e){if(t&&"object"==typeof t)e=t.height,t=t.width;this.width="number"==typeof t?t:0,this.height="number"==typeof e?e:0}var r=t("./CCValueType"),o=t("../platform/js");o.extend(n,r),t("../platform/CCClass").fastDefine("cc.Size",n,["width","height"]),o.get(n,"ZERO",function(){return new n(0,0)});var s=n.prototype;s.clone=function(){return new n(this.width,this.height)},s.equals=function(t){return t&&this.width===t.width&&this.height===t.height},s.lerp=function(t,e,i){i=i||new n;var r=this.width,o=this.height;return i.width=r+(t.width-r)*e,i.height=o+(t.height-o)*e,i},s.toString=function(){return"("+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},cc.size=function(t,e){return new n(t,e)},cc.sizeEqualToSize=function(t,e){return t&&e&&t.width===e.width&&t.height===e.height},cc.Size=e.exports=n},{"../platform/CCClass":68,"../platform/js":80,"./CCValueType":101}],99:[function(t,e,i){cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},cc.BlendFunc=function(t,e){this.src=t,this.dst=e};var n=cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775});cc.BlendFunc._disable=function(){return new cc.BlendFunc(n.ONE,n.ZERO)},cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._additive=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE)},cc.BlendFunc.BlendFactor=n,cc.BlendFunc.DISABLE,cc.js.get(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.BlendFunc.ADDITIVE,cc.js.get(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive),cc.blendFuncDisable=cc.BlendFunc._disable,cc.FontDefinition=function(t){var e=this;if(e.fontName="Arial",e.fontSize=12,e.textAlign=cc.TextAlignment.CENTER,e.verticalAlign=cc.VerticalTextAlignment.TOP,e.fillStyle=cc.color(255,255,255,255),e.boundingWidth=0,e.boundingHeight=0,e.strokeEnabled=!1,e.strokeStyle=cc.color(255,255,255,255),e.lineWidth=1,e.lineHeight="normal",e.fontStyle="normal",e.fontWeight="normal",e.shadowEnabled=!1,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowOpacity=1,t&&t instanceof Object)for(var i in t)e[i]=t[i]},cc.FontDefinition.prototype._getCanvasFontStr=function(){var t=!this.lineHeight.charAt?this.lineHeight+"px":this.lineHeight;return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+t+" '"+this.fontName+"'"},cc.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),cc._Dictionary=cc.Class({ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return this.__currId++,"key_"+this.__currId},setObject:function(t,e){if(null!=e){var i=this.__getKey();this._keyMapTb[i]=e,this._valueMapTb[i]=t}},objectForKey:function(t){if(null==t)return null;var e=this._keyMapTb;for(var i in e)if(e[i]===t)return this._valueMapTb[i];return null},valueForKey:function(t){return this.objectForKey(t)},removeObjectForKey:function(t){if(null!=t){var e=this._keyMapTb;for(var i in e)if(e[i]===t)return delete this._valueMapTb[i],void delete e[i]}},removeObjectsForKeys:function(t){if(null!=t)for(var e=0;e<t.length;e++)this.removeObjectForKey(t[e])},allKeys:function(){var t=[],e=this._keyMapTb;for(var i in e)t.push(e[i]);return t},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}})},{}],100:[function(t,e,i){cc.WebGLColor=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.WebGLColor.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,c=this._offset,a=Uint8Array.BYTES_PER_ELEMENT;if(this._rU8=new Uint8Array(s,c,1),this._gU8=new Uint8Array(s,c+a,1),this._bU8=new Uint8Array(s,c+2*a,1),this._aU8=new Uint8Array(s,c+3*a,1),this._rU8[0]=t||0,this._gU8[0]=e||0,this._bU8[0]=i||0,this._aU8[0]=null==n?255:n,void 0===n)this.a_undefined=!0},cc.WebGLColor.BYTES_PER_ELEMENT=4;var n=cc.WebGLColor.prototype;n._getR=function(){return this._rU8[0]},n._setR=function(t){this._rU8[0]=0>t?0:t},n._getG=function(){return this._gU8[0]},n._setG=function(t){this._gU8[0]=0>t?0:t},n._getB=function(){return this._bU8[0]},n._setB=function(t){this._bU8[0]=0>t?0:t},n._getA=function(){return this._aU8[0]},n._setA=function(t){this._aU8[0]=0>t?0:t},n.r,cc.js.getset(n,"r",n._getR,n._setR),n.g,cc.js.getset(n,"g",n._getG,n._setG),n.b,cc.js.getset(n,"b",n._getB,n._setB),n.a,cc.js.getset(n,"a",n._getA,n._setA),cc.Vertex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._xF32=new Float32Array(this._arrayBuffer,this._offset,1),this._yF32=new Float32Array(this._arrayBuffer,this._offset+4,1),this._xF32[0]=t||0,this._yF32[0]=e||0},cc.Vertex2F.BYTES_PER_ELEMENT=8,n=cc.Vertex2F.prototype,n._getX=function(){return this._xF32[0]},n._setX=function(t){this._xF32[0]=t},n._getY=function(){return this._yF32[0]},n._setY=function(t){this._yF32[0]=t},n.x,cc.js.getset(n,"x",n._getX,n._setX),n.y,cc.js.getset(n,"y",n._getY,n._setY),cc.Vertex3F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._xF32=new Float32Array(o,s,1),this._xF32[0]=t||0,this._yF32=new Float32Array(o,s+Float32Array.BYTES_PER_ELEMENT,1),this._yF32[0]=e||0,this._zF32=new Float32Array(o,s+2*Float32Array.BYTES_PER_ELEMENT,1),this._zF32[0]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,n=cc.Vertex3F.prototype,n._getX=function(){return this._xF32[0]},n._setX=function(t){this._xF32[0]=t},n._getY=function(){return this._yF32[0]},n._setY=function(t){this._yF32[0]=t},n._getZ=function(){return this._zF32[0]},n._setZ=function(t){this._zF32[0]=t},n.x,cc.js.getset(n,"x",n._getX,n._setX),n.y,cc.js.getset(n,"y",n._getY,n._setY),n.z,cc.js.getset(n,"z",n._getZ,n._setZ),cc.Tex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._uF32=new Float32Array(this._arrayBuffer,this._offset,1),this._vF32=new Float32Array(this._arrayBuffer,this._offset+4,1),this._uF32[0]=t||0,this._vF32[0]=e||0},cc.Tex2F.BYTES_PER_ELEMENT=8,n=cc.Tex2F.prototype,n._getU=function(){return this._uF32[0]},n._setU=function(t){this._uF32[0]=t},n._getV=function(){return this._vF32[0]},n._setV=function(t){this._vF32[0]=t},n.u,cc.js.getset(n,"u",n._getU,n._setU),n.v,cc.js.getset(n,"v",n._getV,n._setV),cc.Quad2=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,c=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=t?new cc.Vertex2F(t.x,t.y,s,0):new cc.Vertex2F(0,0,s,0),this._tr=e?new cc.Vertex2F(e.x,e.y,s,c):new cc.Vertex2F(0,0,s,c),this._bl=i?new cc.Vertex2F(i.x,i.y,s,2*c):new cc.Vertex2F(0,0,s,2*c),this._br=n?new cc.Vertex2F(n.x,n.y,s,3*c):new cc.Vertex2F(0,0,s,3*c)},cc.Quad2.BYTES_PER_ELEMENT=32,n=cc.Quad2.prototype,n._getTL=function(){return this._tl},n._setTL=function(t){this._tl.x=t.x,this._tl.y=t.y},n._getTR=function(){return this._tr},n._setTR=function(t){this._tr.x=t.x,this._tr.y=t.y},n._getBL=function(){return this._bl},n._setBL=function(t){this._bl.x=t.x,this._bl.y=t.y},n._getBR=function(){return this._br},n._setBR=function(t){this._br.x=t.x,this._br.y=t.y},n.tl,cc.js.getset(n,"tl",n._getTL,n._setTL),n.tr,cc.js.getset(n,"tr",n._getTR,n._setTR),n.bl,cc.js.getset(n,"bl",n._getBL,n._setBL),n.br,cc.js.getset(n,"br",n._getBR,n._setBR),cc.Quad3=function(t,e,i,n){this.bl=t||new cc.Vertex3F(0,0,0),this.br=e||new cc.Vertex3F(0,0,0),this.tl=i||new cc.Vertex3F(0,0,0),this.tr=n||new cc.Vertex3F(0,0,0)},cc.V3F_C4B_T2F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,c=cc.Vertex3F.BYTES_PER_ELEMENT;this._vertices=t?new cc.Vertex3F(t.x,t.y,t.z,o,s):new cc.Vertex3F(0,0,0,o,s),this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,o,s+c):new cc.WebGLColor(0,0,0,0,o,s+c),this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s+c+cc.WebGLColor.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,o,s+c+cc.WebGLColor.BYTES_PER_ELEMENT)},cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,n=cc.V3F_C4B_T2F.prototype,n._getVertices=function(){return this._vertices},n._setVertices=function(t){var e=this._vertices;e.x=t.x,e.y=t.y,e.z=t.z},n._getColor=function(){return this._colors},n._setColor=function(t){var e=this._colors;e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a},n._getTexCoords=function(){
return this._texCoords},n._setTexCoords=function(t){this._texCoords.u=t.u,this._texCoords.v=t.v},n.vertices,cc.js.getset(n,"vertices",n._getVertices,n._setVertices),n.colors,cc.js.getset(n,"colors",n._getColor,n._setColor),n.texCoords,cc.js.getset(n,"texCoords",n._getTexCoords,n._setTexCoords),cc.V3F_C4B_T2F_Quad=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,c=this._offset,a=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=t?new cc.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),this._bl=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,s,c+a):new cc.V3F_C4B_T2F(null,null,null,s,c+a),this._tr=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,s,c+2*a):new cc.V3F_C4B_T2F(null,null,null,s,c+2*a),this._br=n?new cc.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,s,c+3*a):new cc.V3F_C4B_T2F(null,null,null,s,c+3*a)},cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,n=cc.V3F_C4B_T2F_Quad.prototype,n._getTL=function(){return this._tl},n._setTL=function(t){var e=this._tl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getBL=function(){return this._bl},n._setBL=function(t){var e=this._bl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getTR=function(){return this._tr},n._setTR=function(t){var e=this._tr;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getBR=function(){return this._br},n._setBR=function(t){var e=this._br;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getArrayBuffer=function(){return this._arrayBuffer},n.tl,cc.js.getset(n,"tl",n._getTL,n._setTL),n.tr,cc.js.getset(n,"tr",n._getTR,n._setTR),n.bl,cc.js.getset(n,"bl",n._getBL,n._setBL),n.br,cc.js.getset(n,"br",n._getBR,n._setBR),n.arrayBuffer,cc.js.get(n,"arrayBuffer",n._getArrayBuffer),cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad},cc.V3F_C4B_T2F_QuadCopy=function(t){if(!t)return cc.V3F_C4B_T2F_QuadZero();var e=t.tl,i=t.bl,n=t.tr,r=t.br;return{tl:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:r.vertices.x,y:r.vertices.y,z:r.vertices.z},colors:{r:r.colors.r,g:r.colors.g,b:r.colors.b,a:r.colors.a},texCoords:{u:r.texCoords.u,v:r.texCoords.v}}}},cc.V3F_C4B_T2F_QuadsCopy=function(t){if(!t)return[];for(var e=[],i=0;i<t.length;i++)e.push(cc.V3F_C4B_T2F_QuadCopy(t[i]));return e},cc.V2F_C4B_T2F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,c=cc.Vertex2F.BYTES_PER_ELEMENT;this._vertices=t?new cc.Vertex2F(t.x,t.y,o,s):new cc.Vertex2F(0,0,o,s),this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,o,s+c):new cc.WebGLColor(0,0,0,0,o,s+c),this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s+c+cc.WebGLColor.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,o,s+c+cc.WebGLColor.BYTES_PER_ELEMENT)},cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,n=cc.V2F_C4B_T2F.prototype,n._getVertices=function(){return this._vertices},n._setVertices=function(t){this._vertices.x=t.x,this._vertices.y=t.y},n._getColor=function(){return this._colors},n._setColor=function(t){var e=this._colors;e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a},n._getTexCoords=function(){return this._texCoords},n._setTexCoords=function(t){this._texCoords.u=t.u,this._texCoords.v=t.v},n.vertices,cc.js.getset(n,"vertices",n._getVertices,n._setVertices),n.colors,cc.js.getset(n,"colors",n._getColor,n._setColor),n.texCoords,cc.js.getset(n,"texCoords",n._getTexCoords,n._setTexCoords),cc.V2F_C4B_T2F_Triangle=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,c=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=t?new cc.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s),this._b=e?new cc.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,o,s+c):new cc.V2F_C4B_T2F(null,null,null,o,s+c),this._c=i?new cc.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,o,s+2*c):new cc.V2F_C4B_T2F(null,null,null,o,s+2*c)},cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,n=cc.V2F_C4B_T2F_Triangle.prototype,n._getA=function(){return this._a},n._setA=function(t){var e=this._a;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getB=function(){return this._b},n._setB=function(t){var e=this._b;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getC=function(){return this._c},n._setC=function(t){var e=this._c;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n.a,cc.js.getset(n,"a",n._getA,n._setA),n.b,cc.js.getset(n,"b",n._getB,n._setB),n.c,cc.js.getset(n,"c",n._getC,n._setC)},{}],101:[function(t,e,i){function n(){}var r=t("../platform/js");r.setClassName("cc.ValueType",n),r.mixin(n.prototype,{clone:!1,equals:!1,toString:function(){return""+{}},lerp:!1}),cc.ValueType=n,e.exports=n},{"../platform/js":80}],102:[function(t,e,i){function n(t,e){if(t&&"object"==typeof t)e=t.y,t=t.x;this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0}var r=t("./CCValueType"),o=t("../platform/js"),s=t("../platform/CCClass");o.extend(n,r),s.fastDefine("cc.Vec2",n,["x","y"]),o.mixin(n.prototype,{clone:function(){return new n(this.x,this.y)},set:function(t){return this.x=t.x,this.y=t.y,this},equals:function(t){return t&&this.x===t.x&&this.y===t.y},toString:function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},lerp:function(t,e,i){i=i||new n;var r=this.x,o=this.y;return i.x=r+(t.x-r)*e,i.y=o+(t.y-o)*e,i},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this},add:function(t,e){return e=e||new n,e.x=this.x+t.x,e.y=this.y+t.y,e},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this},sub:function(t,e){return e=e||new n,e.x=this.x-t.x,e.y=this.y-t.y,e},mulSelf:function(t){return this.x*=t,this.y*=t,this},mul:function(t,e){return e=e||new n,e.x=this.x*t,e.y=this.y*t,e},scaleSelf:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t,e){return e=e||new n,e.x=this.x*t.x,e.y=this.y*t.y,e},divSelf:function(t){return this.x/=t,this.y/=t,this},div:function(t,e){return e=e||new n,e.x=this.x/t,e.y=this.y/t,e},negSelf:function(){return this.x=-this.x,this.y=-this.y,this},neg:function(t){return t=t||new n,t.x=-this.x,t.y=-this.y,t},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.y*t.x-this.x*t.y},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magSqr:function(){return this.x*this.x+this.y*this.y},normalizeSelf:function(){var t=this.x*this.x+this.y*this.y;if(1===t)return this;if(0===t)return console.warn("Can't normalize zero vector"),this;var e=1/Math.sqrt(t);return this.x*=e,this.y*=e,this},normalize:function(t){return t=t||new n,t.x=this.x,t.y=this.y,t.normalizeSelf(),t},angle:function(t){var e=this.magSqr(),i=t.magSqr();if(0===e||0===i)return console.warn("Can't get angle between zero vector"),0;var n=this.dot(t),r=n/Math.sqrt(e*i);return r=cc.clampf(r,-1,1),Math.acos(r)},signAngle:function(t){return Math.atan2(this.y,this.x)-Math.atan2(t.y,t.x)},rotate:function(t,e){return e=e||new n,e.x=this.x,e.y=this.y,e.rotateSelf(t)},rotateSelf:function(t){var e=Math.sin(t),i=Math.cos(t),n=this.x;return this.x=i*n-e*this.y,this.y=e*n+i*this.y,this}}),o.get(n,"ONE",function(){return new n(1,1)}),o.get(n,"ZERO",function(){return new n(0,0)}),o.get(n,"UP",function(){return new n(0,1)}),o.get(n,"RIGHT",function(){return new n(1,0)}),cc.Vec2=n,cc.v2=function(t,e){return new n(t,e)},cc.p=cc.v2,cc.pointEqualToPoint=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y},e.exports=cc.Vec2},{"../platform/CCClass":68,"../platform/js":80,"./CCValueType":101}],103:[function(t,e,i){t("./CCValueType"),t("./CCEnum"),t("./CCVec2"),t("./CCPointExtension"),t("./CCSize"),t("./CCRect"),t("./CCColor"),t("./CCTypes"),t("./CCAffineTransform"),t("./CCTypesWebGL")},{"./CCAffineTransform":93,"./CCColor":94,"./CCEnum":95,"./CCPointExtension":96,"./CCRect":97,"./CCSize":98,"./CCTypes":99,"./CCTypesWebGL":100,"./CCValueType":101,"./CCVec2":102}],104:[function(t,e,i){var n=cc.Class({name:"cc.MotionStreak","extends":cc.Component,editor:!1,ctor:function(){this._root=null,this._motionStreak=null},properties:{preview:{"default":!1,editorOnly:!0,notify:!1,animatable:!1},_fadeTime:1,fadeTime:{get:function(){return this._fadeTime},set:function(t){if(this._fadeTime=t,this._motionStreak)this._motionStreak.setFadeTime(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.fadeTime"},_minSeg:1,minSeg:{get:function(){return this._minSeg},set:function(t){if(this._minSeg=t,this._motionStreak)this._motionStreak.setMinSeg(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.minSeg"},_stroke:64,stroke:{get:function(){return this._stroke},set:function(t){if(this._stroke=t,this._motionStreak)this._motionStreak.setStroke(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.stroke"},_texture:{"default":"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){if(this._texture=t,this._motionStreak){if(cc.js.isString(t))t=cc.textureCache.addImage(t);this._motionStreak.setTexture(t)}},url:cc.Texture2D,animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.texture"},_fastMode:!1,fastMode:{get:function(){return this._fastMode},set:function(t){if(this._fastMode=t,this._motionStreak)this._motionStreak.setFastMode(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.fastMode"}},onFocusInEditor:!1,onLostFocusInEditor:!1,reset:function(){this._motionStreak.reset()},onLoad:function(){if(!this._root){this._root=new _ccsg.Node;var t=new _ccsg.MotionStreak;if(this._texture)t.initWithFade(this._fadeTime,this._minSeg,this._stroke,this.node.color,this._texture);t.setFastMode(this._fastMode),this._root.addChild(t);var e=this.node._sgNode;if(e)e.addChild(this._root,-10);this._motionStreak=t,this.node.on("color-changed",this._colorChanged,this)}},lateUpdate:function(t){if(!0)if(this._motionStreak){var e=this.node.getNodeToWorldTransform();this._root.setPosition(-e.tx,-e.ty),this._motionStreak.setPosition(e.tx,e.ty),this._motionStreak.update(t)}},onDestroy:function(){this.node.off("color-changed",this._colorChanged,this)},_colorChanged:function(){if(this._motionStreak)this._motionStreak.tintWithColor(this.node.color)}});cc.MotionStreak=e.exports=n},{}],105:[function(t,e,i){var n=cc.Class({name:"cc.ParticleAsset","extends":cc.RawAsset});cc.ParticleAsset=e.exports=n},{}],106:[function(t,e,i){var n=cc.BlendFunc.BlendFactor,r=cc.Enum({GRAVITY:0,RADIUS:1}),o=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),s={preview:{"default":!0,editorOnly:!0,notify:!1,animatable:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(t){if(false)return cc.warn("Custom should not be false if file is not specified.");if(this._custom!==t){if(this._custom=t,t)this._applyCustoms();else this._applyFile();if(!1)cc.engine.repaintInEditMode()}},animatable:!1},_file:{"default":"",url:cc.ParticleAsset},file:{get:function(){return this._file},set:function(t,e){if(this._file!==t)if(this._file=t,t){if(this._applyFile(),!1)cc.engine.repaintInEditMode()}else this.custom=!0},animatable:!1,url:cc.ParticleAsset},_texture:{"default":"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._sgNode.texture=t?cc.textureCache.addImage(t):null},url:cc.Texture2D},particleCount:{get:function(){return this._sgNode.particleCount},set:function(t){this._sgNode.particleCount=t},visible:!1},_srcBlendFactor:n.SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n},_dstBlendFactor:n.ONE_MINUS_SRC_ALPHA,dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n},playOnLoad:!0,_autoRemoveOnFinish:!1,autoRemoveOnFinish:{get:function(){return this._autoRemoveOnFinish},set:function(t){if(this._autoRemoveOnFinish!==t)if(this._autoRemoveOnFinish=t,true)this._applyAutoRemove()},animatable:!1},active:{get:function(){return this._sgNode?this._sgNode.isActive():!1},visible:!1}},c=function(){for(var t={totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,startColor:cc.Color.WHITE,startColorVar:cc.Color.BLACK,endColor:cc.color(255,255,255,0),endColorVar:cc.color(0,0,0,0),angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.p(0,0),posVar:cc.p(0,0),positionType:o.FREE,emitterMode:r.GRAVITY,gravity:cc.p(0,0),speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},e=Object.keys(t),i=0;i<e.length;++i){var n=e[i];!function(t,e){var i="_"+t;s[i]=e;var n=e.constructor,r=s[t]={};if(cc.isChildClassOf(n,cc.ValueType))r.get=function(){return new n(this[i])},r.type=n;else r.get=function(){return this[i]};if(cc.isChildClassOf(n,cc.ValueType))r.set=function(e){this[i]=new n(e),this._sgNode[t]=e};else if(false)r.set=function(e){if(this[i]=e,!isNaN(e))this._sgNode[t]=e;else cc.error("The new %s must not be NaN",t)};else r.set=function(e){this[i]=e,this._sgNode[t]=e}}(n,t[n])}return e}();s.positionType.type=o,s.emitterMode.type=r;var a=cc.Class({name:"cc.ParticleSystem","extends":cc._RendererUnderSG,editor:!1,ctor:function(){this._previewTimer=null,this._focused=!1,this._willStart=!1,this._blendFunc=new cc.BlendFunc(0,0)},properties:s,statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:r,PositionType:o},onLoad:function(){if(this._super(),true){if(this.playOnLoad)this.resetSystem();this._applyAutoRemove()}},onDestroy:function(){if(this._autoRemoveOnFinish)this.autoRemoveOnFinish=!1;this._super()},onFocusInEditor:!1,onLostFocusInEditor:!1,_createSgNode:function(){return new _ccsg.ParticleSystem},_initSgNode:function(){var t=this._sgNode;if(this._file)if(this._custom){var e=!this._texture;if(e)this._applyFile();else this._applyCustoms()}else this._applyFile();else if(this._custom)this._applyCustoms();t.stopSystem()},addParticle:function(){return this._sgNode.addParticle()},stopSystem:function(){this._sgNode.stopSystem()},resetSystem:function(){this._sgNode.resetSystem()},isFull:function(){return this.particleCount>=this._totalParticles},setDisplayFrame:function(t){if(t){var e=t.getTexture();if(e)this._texture=e.url;this._sgNode.setDisplayFrame(t)}},setTextureWithRect:function(t,e){if(t instanceof cc.Texture2D)this._texture=t.url;this._sgNode.setTextureWithRect(t,e)},_applyFile:function(){var t=this._sgNode,e=this._file;if(e){var i=this;cc.loader.load(e,function(n,r){if(n||!r)throw n||new Error("Unkown error");t.particleCount=0;var o=t.isActive();if(t.initWithFile(e),r.textureUuid)cc.AssetLibrary.queryAssetInfo(r.textureUuid,function(t,e,n){i.texture=e});if(r.emissionRate)i.emissionRate=r.emissionRate;if(t.setPosition(0,0),!o)t.stopSystem();if(true)i._applyAutoRemove();if(i._custom)i._applyCustoms()})}},_applyCustoms:function(){for(var t=this._sgNode,e=t.isActive(),i=0;i<c.length;i++){var n=c[i];t[n]=this["_"+n]}if(this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc),this._texture)t.texture=cc.textureCache.addImage(this._texture);if(!e)t.stopSystem();if(true)this._applyAutoRemove()},_applyAutoRemove:function(){var t=this._sgNode,e=this._autoRemoveOnFinish;if(t.autoRemoveOnFinish=e,e){cc.assert(!t.onExit);var i=this;t.onExit=function(){_ccsg.Node.prototype.onExit.call(this),i.node.destroy()}}else if(t.hasOwnProperty("onExit"))t.onExit=_ccsg.Node.prototype.onExit}});cc.ParticleSystem=e.exports=a},{}],107:[function(t,e,i){var n=cc.Class({name:"cc.TiledLayer","extends":cc._SGComponent,onEnable:function(){if(this._sgNode)this._sgNode.setVisible(!0)},onDisable:function(){if(this._sgNode)this._sgNode.setVisible(!1)},_initSgNode:function(){var t=this._sgNode;if(t){if(!this.enabledInHierarchy)t.setVisible(!1);if(!this.node._sizeProvider)this.node._sizeProvider=t;var e=this.node;t.setAnchorPoint(e.getAnchorPoint())}},_replaceSgNode:function(t){if(t!==this._sgNode){if(this._removeSgNode(),this.node._sizeProvider===this._sgNode)this.node._sizeProvider=null;if(t&&t instanceof _ccsg.TMXLayer)this._sgNode=t,this._sgNode.retain(),this._initSgNode();else this._sgNode=null}},getLayerName:function(){if(this._sgNode)return this._sgNode.getLayerName();else return""},setLayerName:function(t){if(this._sgNode)this._sgNode.setLayerName(t)},getProperty:function(t){if(this._sgNode)return this._sgNode.getProperty(t);else return null},getPositionAt:function(t,e){if(this._sgNode){if(void 0!==e)t=cc.p(t,e);return this._sgNode.getPositionAt(t)}return null},removeTileAt:function(t,e){if(this._sgNode){if(void 0!==e)t=cc.p(t,e);this._sgNode.removeTileAt(t)}},setTileGID:function(t,e,i,n){if(this._sgNode){if(!e)throw new Error("_ccsg.TMXLayer.setTileGID(): pos should be non-null");var r;if(void 0!==n)r=cc.p(e,i);else r=e,n=i;this._sgNode.setTileGID(t,r,n)}},getTileGIDAt:function(t,e){if(this._sgNode){if(void 0!==e)t=cc.p(t,e);return this._sgNode.getTileGIDAt(t)}return 0},getTileAt:function(t,e){if(this._sgNode){if(void 0!==e)t=cc.p(t,e);return this._sgNode.getTileAt(t)}return null},releaseMap:function(){if(this._sgNode)this._sgNode.releaseMap()},setContentSize:function(t,e){if(this._sgNode){if(void 0!==e)t=cc.size(t,e);this._sgNode.setContentSize(t)}},getTexture:function(){if(this._sgNode)return this._sgNode.getTexture();else return null},setTexture:function(t){if(this._sgNode)this._sgNode.setTexture(t)},getLayerSize:function(){if(this._sgNode)return this._sgNode.getLayerSize();else return cc.size(0,0)},setLayerSize:function(t){if(this._sgNode)this._sgNode.setLayerSize(t)},getMapTileSize:function(){if(this._sgNode)return this._sgNode.getMapTileSize();else return cc.size(0,0)},setMapTileSize:function(t){if(this._sgNode)this._sgNode.setMapTileSize(t)},getTiles:function(){if(this._sgNode)return this._sgNode.getTiles();else return null},setTiles:function(t){if(this._sgNode)this._sgNode.setTiles(t)},getTileset:function(){if(this._sgNode)return this._sgNode.getTileset();else return null},setTileset:function(t){if(this._sgNode)this._sgNode.setTileset(t)},getLayerOrientation:function(){if(this._sgNode)return this._sgNode.getLayerOrientation();else return 0},setLayerOrientation:function(t){if(this._sgNode)this._sgNode.setLayerOrientation(t)},getProperties:function(){if(this._sgNode)return this._sgNode.getProperties();else return null},setProperties:function(t){if(this._sgNode)this._sgNode.setProperties(t)}});cc.TiledLayer=e.exports=n},{}],108:[function(t,e,i){var n=cc.Enum({ORTHO:0,HEX:1,ISO:2}),r=cc.Enum({NONE:0,MAP:1,LAYER:2,OBJECTGROUP:3,OBJECT:4,TILE:5}),o=cc.Enum({HORIZONTAL:2147483648,VERTICAL:1073741824,DIAGONAL:536870912,FLIPPED_ALL:3758096384,FLIPPED_MASK:536870911}),s=cc.Class({name:"cc.TiledMap","extends":cc._RendererInSG,editor:!1,statics:{Orientation:n,Property:r,TileFlag:o},properties:{_isLoading:{"default":!1,serializable:!1},_detachedLayers:{"default":[],serializable:!1},_tmxFile:{"default":"",url:cc.TiledMapAsset},tmxFile:{get:function(){return this._tmxFile},set:function(t,e){if(this._tmxFile!==t)this._tmxFile=t,this._applyFile()},url:cc.TiledMapAsset},mapLoaded:{"default":[],type:cc.Component.EventHandler}},getMapSize:function(){return this._sgNode.getMapSize()},setMapSize:function(t){this._sgNode.setMapSize(t)},getTileSize:function(){return this._sgNode.getTileSize()},setTileSize:function(t){this._sgNode.setTileSize(t)},getMapOrientation:function(){return this._sgNode.getMapOrientation()},setMapOrientation:function(t){this._sgNode.setMapOrientation(t)},getObjectGroups:function(){return this._sgNode.getObjectGroups()},setObjectGroups:function(t){this._sgNode.setObjectGroups(t)},getProperties:function(){return this._sgNode.getProperties()},setProperties:function(t){this._sgNode.setProperties(t)},initWithTMXFile:function(t){this._tmxFile=t},initWithXML:function(t,e){this._tmxFile=null;var i=this,n=i._sgNode,r=new cc.TMXMapInfo(t,e);if(!r)return void i._onMapLoaded(new Error("Parse map info failed."));if(i._isLoading=!0,cc.sys.isNative)setTimeout(function(){n.initWithXML(t,e),i._onMapLoaded()},0);else this._preloadTextures(r,function(r,o){if(!r)n.initWithXML(t,e);i._onMapLoaded(r)})},allLayers:function(){for(var t=this.node.children,e=[],i=0,n=t.length;n>i;i++){var r=t[i],o=r.getComponent(cc.TiledLayer);if(o)e.push(o)}return e},getLayer:function(t){for(var e=this.node.children,i=0,n=e.length;n>i;i++){var r=e[i],o=r.getComponent(cc.TiledLayer);if(o&&o.getLayerName()===t)return o}return null},getObjectGroup:function(t){return this._sgNode.getObjectGroup(t)},getProperty:function(t){return this._sgNode.getProperty(t)},getPropertiesForGID:function(t){return this._sgNode.getPropertiesForGID(t)},onEnable:function(){if(this._super(),this._tmxFile&&!this._isLoading)this._refreshLayerEntities();this.node.on("anchor-changed",this._anchorChanged,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-reorder",this._reorderChildren,this)},onDisable:function(){this._super();for(var t=this.node.getChildren(),e=t.length-1;e>=0;e--){var i=t[e],n=i.getComponent(cc.TiledLayer);if(n)n.enabled=!1}var r=this._plainNode;this._moveLayersInSgNode(r),this.node.off("anchor-changed",this._anchorChanged,this),this.node.off("child-added",this._childAdded,this),this.node.off("child-reorder",this._reorderChildren,this)},onDestroy:function(){this._super(),this._removeLayerEntities()},_createSgNode:function(){return new _ccsg.TMXTiledMap},_initSgNode:function(){this._applyFile()},_preloadTextures:function(t,e){var i=t.getTilesets();if(i){var n=i.map(function(t){return t.sourceImage});cc.loader.load(n,function(t){e(t,n)})}else if(e)e()},_preloadTmx:function(t,e){var i=this;cc.loader.load(t,function(n){if(!n){var r=new cc.TMXMapInfo(t);if(!r)return void e(new Error("Parse map info failed."));else return void i._preloadTextures(r,e)}else if(e)e(n||new Error("Preload TMX failed: unknown error"))})},_resetSgSize:function(){this.node.setContentSize(this._sgNode.getContentSize()),this._sgNode.setContentSize(0,0)},_onMapLoaded:function(t){if(this._isLoading=!1,!t){if(this._enabled)this._refreshLayerEntities(),this._anchorChanged();else this._moveLayersInSgNode(this._sgNode);this._resetSgSize()}if(1)cc.Component.EventHandler.emitEvents(this.mapLoaded,t)},_moveLayersInSgNode:function(t){this._detachedLayers.length=0;for(var e=t.getChildren(),i=e.length-1;i>=0;i--){var n=e[i];if(n instanceof _ccsg.TMXLayer){t.removeChild(n);var r=n.getLocalZOrder();this._detachedLayers.push({sgNode:n,zorder:r})}}},_removeLayerEntities:function(){for(var t=this.node.getChildren(),e=t.length-1;e>=0;e--){var i=t[e];if(i.isValid){var n=i.getComponent(cc.TiledLayer);if(n)if(i.removeComponent(cc.TiledLayer),!1)if(1===i._components.length&&0===i.getChildren().length)this.node.removeChild(i)}else;}},_refreshLayerEntities:function(){var t,e,i=this.node.getChildren(),n=[],r=[],o=[];for(t=0;t<this._detachedLayers.length;t++){var s=this._detachedLayers[t];this._sgNode.addChild(s.sgNode,s.zorder,s.zorder)}this._detachedLayers.length=0;var c=this._sgNode.allLayers().map(function(t){return t.getLayerName()});for(t=0,e=i.length;e>t;t++){var a=i[t],h=a.getComponent(cc.TiledLayer);if(h){var l=h.getLayerName();if(!l)l=a._name;if(c.indexOf(l)<0){if(1===a._components.length)n.push(a)}else{r.push(a);var u=this._sgNode.getLayer(l);h._replaceSgNode(u),h.enabled=!0}}else o.push({child:a,index:a.getSiblingIndex()})}for(t=0,e=n.length;e>t;t++)this.node.removeChild(n[t]);var f=r.map(function(t){var e=t.getComponent(cc.TiledLayer);return e.getLayerName()});for(t=0,e=c.length;e>t;t++){var d=c[t],p=this._sgNode.getLayer(d),_=f.indexOf(d);if(0>_){var g=this.node.getChildByName(d),v=null;if(g&&!g.getComponent(cc._SGComponent))v=g.addComponent(cc.TiledLayer);else g=new cc.Node(d),this.node.addChild(g),v=g.addComponent(cc.TiledLayer);if(!g||!v)cc.error("Add component TiledLayer into node failed.");v._replaceSgNode(p),g.setSiblingIndex(p.getLocalZOrder()),g.setAnchorPoint(this.node.getAnchorPoint())}else r[_].setSiblingIndex(p.getLocalZOrder())}for(t=0,e=o.length;e>t;t++){var s=o[t];s.child.setSiblingIndex(s.index)}this._reorderChildren()},_anchorChanged:function(){for(var t=this.node.children,e=this.node.getAnchorPoint(),i=0,n=t.length;n>i;i++){var r=t[i],o=r.getComponent(cc.TiledLayer);if(o)r.setAnchorPoint(e)}},_childAdded:function(t){var e=t.detail;if(e){var i=e.getComponent(cc.TiledLayer);if(!i){var n=this.node.getChildrenCount();if(e.setSiblingIndex(n),e._sgNode)e._sgNode.setLocalZOrder(n)}}},_reorderChildren:function(){for(var t=this.node.children,e=0,i=t.length;i>e;e++){var n=t[e],r=n.getComponent(cc.TiledLayer),o=n.getSiblingIndex();if(r){if(r._sgNode)r._sgNode.setLocalZOrder(o)}else if(n._sgNode)n._sgNode.setLocalZOrder(o)}},_applyFile:function(){var t=this._sgNode,e=this._tmxFile,i=this;if(e)if(i._isLoading=!0,cc.sys.isNative)setTimeout(function(){if(t.initWithTMXFile(e))i._onMapLoaded();else i._onMapLoaded(new Error("Parse map info failed."))},0);else this._preloadTmx(e,function(n,r){if(!n)t.initWithTMXFile(e);i._onMapLoaded(n)});else{for(var n=t.allLayers(),r=0,o=n.length;o>r;r++)t.removeChild(n[r]);if(i._enabled)i._removeLayerEntities()}}});cc.TiledMap=e.exports=s},{}],109:[function(t,e,i){var n=cc.Class({name:"cc.TiledMapAsset","extends":cc.RawAsset});cc.TiledMapAsset=n,e.exports=n},{}],110:[function(t,e,i){if(t("./cocos2d/core"),t("./cocos2d/animation"),t("./cocos2d/particle/CCParticleAsset"),!0)t("./cocos2d/particle/CCParticleSystem");if(!0)t("./cocos2d/motion-streak/CCMotionStreak");if(t("./cocos2d/tilemap/CCTiledMapAsset"),!0)t("./cocos2d/tilemap/CCTiledMap"),t("./cocos2d/tilemap/CCTiledLayer");if(t("./extensions/spine"),!0){if(0)t("./cocos2d/actions"),t("./external/chipmunk/chipmunk.js");t("./extensions/ccpool/CCPool.js")}},{"./cocos2d/actions":6,"./cocos2d/animation":16,"./cocos2d/core":58,"./cocos2d/motion-streak/CCMotionStreak":104,"./cocos2d/particle/CCParticleAsset":105,"./cocos2d/particle/CCParticleSystem":106,"./cocos2d/tilemap/CCTiledLayer":107,"./cocos2d/tilemap/CCTiledMap":108,"./cocos2d/tilemap/CCTiledMapAsset":109,"./extensions/ccpool/CCPool.js":111,"./extensions/spine":114,"./external/chipmunk/chipmunk.js":115}],111:[function(t,e,i){cc.pool={_pool:{},_releaseCB:function(){this.release()},_autoRelease:function(t){var e=void 0===t._running?!1:!t._running;cc.director.getScheduler().schedule(this._releaseCB,t,0,0,0,e)},putInPool:function(t){var e=cc.js._getClassId(t.constructor);if(e){if(!this._pool[e])this._pool[e]=[];t.retain&&t.retain(),t.unuse&&t.unuse(),this._pool[e].push(t)}},hasObject:function(t){var e=cc.js._getClassId(t),i=this._pool[e];if(!i||0===i.length)return!1;else return!0},removeObject:function(t){var e=cc.js._getClassId(t.constructor);if(e){var i=this._pool[e];if(i)for(var n=0;n<i.length;n++)if(t===i[n])t.release&&t.release(),i.splice(n,1)}},getFromPool:function(t){if(this.hasObject(t)){var e=cc.js._getClassId(t),i=this._pool[e],n=Array.prototype.slice.call(arguments);n.shift();var r=i.pop();return r.reuse&&r.reuse.apply(r,n),cc.sys.isNative&&r.release&&this._autoRelease(r),r}},drainAllPools:function(){for(var t in this._pool)for(var e=0;e<this._pool[t].length;e++){var i=this._pool[t][e];i.release&&i.release()}this._pool={}}}},{}],112:[function(t,e,i){var n=cc.Enum({"default":-1}),r=cc.Enum({"<None>":0});sp.Skeleton=cc.Class({name:"sp.Skeleton","extends":cc._RendererUnderSG,editor:!1,properties:{skeletonData:{"default":null,type:sp.SkeletonData,notify:function(){this.defaultSkin="",this.defaultAnimation="",this._refresh()},tooltip:"i18n:COMPONENT.skeleton.skeleton_data"},defaultSkin:{"default":"",visible:!1},defaultAnimation:{"default":"",visible:!1},animation:{get:function(){var t=this.getCurrent(0);return t&&t.animation.name||""},set:function(t){if(this.defaultAnimation=t,t)this.setAnimation(0,t,this.loop);else this.clearTrack(0),this.setToSetupPose()},visible:!1},_defaultSkinIndex:{get:function(){if(this.skeletonData&&this.defaultSkin){var t=this.skeletonData.getSkinsEnum();if(t){var e=t[this.defaultSkin];if(void 0!==e)return e}}return 0},set:function(t){var e;if(this.skeletonData)e=this.skeletonData.getSkinsEnum();if(!e)return cc.error('Failed to set _defaultSkinIndex for "%s" because its skeletonData is invalid.',this.name);var i=e[t];if(void 0!==i){if(this.defaultSkin=i,false)this._refresh()}else cc.error('Failed to set _defaultSkinIndex for "%s" because the index is out of range.',this.name)},type:n,visible:!0,displayName:"Default Skin",tooltip:"i18n:COMPONENT.skeleton.default_skin"},_animationIndex:{get:function(){var t=true?this.animation:this.defaultAnimation;if(this.skeletonData&&t){var e=this.skeletonData.getAnimsEnum();if(e){var i=e[t];if(void 0!==i)return i}}return 0},set:function(t){if(0===t)return void(this.animation="");var e;if(this.skeletonData)e=this.skeletonData.getAnimsEnum();if(!e)return cc.error('Failed to set _animationIndex for "%s" because its skeletonData is invalid.',this.name);var i=e[t];if(void 0!==i)this.animation=i;else cc.error('Failed to set _animationIndex for "%s" because the index is out of range.',this.name)},type:r,visible:!0,displayName:"Animation",tooltip:"i18n:COMPONENT.skeleton.animation"},loop:{"default":!0,type:Boolean,tooltip:"i18n:COMPONENT.skeleton.loop"},timeScale:{"default":1,notify:function(){if(this._sgNode)this._sgNode.setTimeScale(this.timeScale)},tooltip:"i18n:COMPONENT.skeleton.time_scale"},debugSlots:{"default":!1,notify:function(){if(this._sgNode)this._sgNode.setDebugSlotsEnabled(this.debugSlots)},editorOnly:!0,tooltip:"i18n:COMPONENT.skeleton.debug_slots"},debugBones:{"default":!1,notify:function(){if(this._sgNode)this._sgNode.setDebugBonesEnabled(this.debugBones)},editorOnly:!0,tooltip:"i18n:COMPONENT.skeleton.debug_bones"}},onLoad:function(){var t=cc.Object.Flags;this._objFlags|=t.IsAnchorLocked|t.IsSizeLocked,this.node.setContentSize(0,0),this._refresh()},_createSgNode:function(){if(this.skeletonData)if(!0){var t=this.skeletonData._uuid;if(!t)return cc.error("Can not render dynamic created SkeletonData"),null;var e=this.skeletonData.rawUrl,i=this.skeletonData.atlasUrl;if(i)if("string"!=typeof i)return cc.error("Invalid type of atlasFile, atlas should be registered as raw asset."),null;else return new sp._SGSkeletonAnimation(e,i,this.skeletonData.scale)}else{var n=this.skeletonData.getRuntimeData();if(n)return new sp._SGSkeletonAnimation(n,null,this.skeletonData.scale)}return null},_initSgNode:function(){var t=this._sgNode;if(t.setTimeScale(this.timeScale),this.defaultSkin)try{t.setSkin(this.defaultSkin)}catch(e){cc._throw(e)}if(this.animation=this.defaultAnimation,!1)t.setDebugSlotsEnabled(this.debugSlots),t.setDebugBonesEnabled(this.debugBones)},_getLocalBounds:!1,setToSetupPose:function(){if(this._sgNode)this._sgNode.setToSetupPose()},setBonesToSetupPose:function(){if(this._sgNode)this._sgNode.setBonesToSetupPose()},setSlotsToSetupPose:function(){if(this._sgNode)this._sgNode.setSlotsToSetupPose()},findBone:function(t){if(this._sgNode)return this._sgNode.findBone(t);else return null},findSlot:function(t){if(this._sgNode)return this._sgNode.findSlot(t);else return null},setSkin:function(t){if(this._sgNode)return this._sgNode.setSkin(t);else return null},getAttachment:function(t,e){if(this._sgNode)return this._sgNode.getAttachment(t,e);else return null},setAttachment:function(t,e){if(this._sgNode)this._sgNode.setAttachment(t,e);
},setSkeletonData:function(t,e){if(this._sgNode)this._sgNode.setSkeletonData(t,e)},setAnimationStateData:function(t){if(this._sgNode)return this._sgNode.setAnimationStateData(t);else;},setMix:function(t,e,i){if(this._sgNode)this._sgNode.setMix(t,e,i)},setAnimationListener:function(t,e){if(this._sgNode)this._sgNode.setAnimationListener(t,e)},setAnimation:function(t,e,i){if(this._sgNode){var n=this._sgNode.setAnimation(t,e,i);if(false)this._sample(),this.clearTrack(t);return n}return null},_sample:function(){if(this._sgNode)this._sgNode.update(0)},addAnimation:function(t,e,i,n){if(this._sgNode)return this._sgNode.addAnimation(t,e,i,n);else return null},getCurrent:function(t){if(this._sgNode)return this._sgNode.getCurrent(t);else return null},clearTracks:function(){if(this._sgNode)this._sgNode.clearTracks()},clearTrack:function(t){if(this._sgNode)if(this._sgNode.clearTrack(t),false)this._sample()},_updateAnimEnum:!1,_updateSkinEnum:!1,_refreshInspector:!1,setStartListener:function(t){if(this._sgNode)this._sgNode.setStartListener(t)},setEndListener:function(t){if(this._sgNode)this._sgNode.setEndListener(t)},setCompleteListener:function(t){if(this._sgNode)this._sgNode.setCompleteListener(t)},setEventListener:function(t){if(this._sgNode)this._sgNode.setEventListener(t)},setTrackStartListener:function(t,e){if(this._sgNode)this._sgNode.setTrackStartListener(t,e)},setTrackEndListener:function(t,e){if(this._sgNode)this._sgNode.setTrackEndListener(t,e)},setTrackCompleteListener:function(t,e){if(this._sgNode)this._sgNode.setTrackCompleteListener(t,e)},setTrackEventListener:function(t,e){if(this._sgNode)this._sgNode.setTrackEventListener(t,e)},getState:function(){if(this._sgNode)return this._sgNode.getState();else;},_refresh:function(){var t=this;if(t._sgNode){if(t.node._sizeProvider===t._sgNode)t.node._sizeProvider=null;t._removeSgNode(),t._sgNode=null}var e=t._sgNode=t._createSgNode();if(e)if(e.retain(),e.setContentSize(0,0),t._initSgNode(),t._appendSgNode(e),!t.node._sizeProvider)t.node._sizeProvider=e;if(!1)t._updateAnimEnum(),t._updateSkinEnum(),t._refreshInspector()}})},{}],113:[function(t,e,i){var n=(cc.Class({ctor:function(){this.asset=arguments[0]},getTexture:function(t){for(var e=this.asset.textures,i=0;i<e.length;i++){var n=e[i];if(n.endsWith(t))return cc.textureCache.addImage(n)}return null},load:function(t,e,i){var n=this.getTexture(e);if(n)if(cc._renderType===cc.game.RENDER_TYPE_WEBGL)t.rendererObject=new cc.TextureAtlas(n,128),t.width=n.getPixelWidth(),t.height=n.getPixelHeight();else t._texture=n;else cc.error('Failed to load spine atlas "$s"',e)},unload:function(t){}}),cc.Class({name:"sp.SkeletonData","extends":cc.Asset,ctor:function(){this.reset()},properties:{_skeletonJson:null,skeletonJson:{get:function(){return this._skeletonJson},set:function(t){this._skeletonJson=t,this.reset()}},_atlasText:"",atlasText:{get:function(){return this._atlasText},set:function(t){this._atlasText=t,this.reset()}},atlasUrl:{"default":"",url:cc.RawAsset},textures:{"default":[],url:[cc.Texture2D]},scale:1},createNode:function(t){var e=new cc.Node(this.name),i=e.addComponent(sp.Skeleton);return i.skeletonData=this,t(null,e)},reset:function(){if(this._skeletonCache=null,this._atlasCache=null,!1)this._skinsEnum=null,this._animsEnum=null},getRuntimeData:!1,getSkinsEnum:!1,getAnimsEnum:!1,_getAtlas:!1}));sp.SkeletonData=e.exports=n},{}],114:[function(t,e,i){if(sp=!0?sp:{},sp.VERTEX_INDEX={X1:0,Y1:1,X2:2,Y2:3,X3:4,Y3:5,X4:6,Y4:7},sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.AnimationEventType=cc.Enum({START:0,END:1,COMPLETE:2,EVENT:3}),true){if(0)sp.spine=t("./lib/spine"),t("./SGSkeleton"),t("./SGSkeletonCanvasRenderCmd"),t("./SGSkeletonWebGLRenderCmd"),t("./SGSkeletonAnimation");t("./SkeletonData"),t("./Skeleton")}else t("./SkeletonData")},{"./SGSkeleton":134,"./SGSkeletonAnimation":134,"./SGSkeletonCanvasRenderCmd":134,"./SGSkeletonWebGLRenderCmd":134,"./Skeleton":112,"./SkeletonData":113,"./lib/spine":134}],115:[function(t,e,i){Object.create=Object.create||function(t){function e(){}return e.prototype=t,new e};var n,r,o=function(t,e){if(!t)throw new Error("Assertion failed: "+e)},s=function(t,e){if(!t&&console&&console.warn)if(console.warn("ASSERTION FAILED: "+e),console.trace)console.trace()},c=function(t,e){return e>t?t:e},a=function(t,e){return t>e?t:e};if("object"==typeof window&&window.navigator.userAgent.indexOf("Firefox")>-1)n=Math.min,r=Math.max;else n=c,r=a;var h=function(t,e){return e>t?t+" "+e:e+" "+t},l=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return t[i]=t[t.length-1],void t.length--},u=function(t,e,i){var n=x(e,i),r=m(T(n,x(t,i))/M(n));return E(i,N(n,r))},f=function(t,e,i,n,r,o){var s=i-r,c=n-o,a=m(C(s,c,t-r,e-o)/B(s,c));return new y(r+s*a,o+c*a)};cp.momentForCircle=function(t,e,i,n){return t*(.5*(e*e+i*i)+M(n))},cp.areaForCircle=function(t,e){return Math.PI*Math.abs(t*t-e*e)},cp.momentForSegment=function(t,e,i){var n=N(E(e,i),.5);return t*(U(i,e)/12+M(n))},cp.areaForSegment=function(t,e,i){return i*(Math.PI*i+2*k(t,e))},cp.momentForPoly=function(t,e,i){for(var n=0,r=0,o=e.length,s=0;o>s;s+=2){var c=e[s]+i.x,a=e[s+1]+i.y,h=e[(s+2)%o]+i.x,l=e[(s+3)%o]+i.y,u=w(h,l,c,a),f=C(c,a,c,a)+C(c,a,h,l)+C(h,l,h,l);n+=u*f,r+=u}return t*n/(6*r)},cp.areaForPoly=function(t){for(var e=0,i=0,n=t.length;n>i;i+=2)e+=I(new y(t[i],t[i+1]),new y(t[(i+2)%n],t[(i+3)%n]));return-e/2},cp.centroidForPoly=function(t){for(var e=0,i=new y(0,0),n=0,r=t.length;r>n;n+=2){var o=new y(t[n],t[n+1]),s=new y(t[(n+2)%r],t[(n+3)%r]),c=I(o,s);e+=c,i=E(i,N(E(o,s),c))}return N(i,1/(3*e))},cp.recenterPoly=function(t){for(var e=cp.centroidForPoly(t),i=0;i<t.length;i+=2)t[i]-=e.x,t[i+1]-=e.y},cp.momentForBox=function(t,e,i){return t*(e*e+i*i)/12},cp.momentForBox2=function(t,e){var i=e.r-e.l,n=e.t-e.b,r=N([e.l+e.r,e.b+e.t],.5);return cp.momentForBox(t,i,n)+t*M(r)};var d=cp.loopIndexes=function(t){var e,i,n,r,o=0,s=0;e=n=t[0],i=r=t[1];for(var c=t.length>>1,a=1;c>a;a++){var h=t[2*a],l=t[2*a+1];if(e>h||h==e&&i>l)e=h,i=l,o=a;else if(h>n||h==n&&l>r)n=h,r=l,s=a}return[o,s]},p=function(t,e,i){var n=t[2*e];t[2*e]=t[2*i],t[2*i]=n,n=t[2*e+1],t[2*e+1]=t[2*i+1],t[2*i+1]=n},_=function(t,e,i,n,r,o){if(0===i)return 0;for(var s=0,c=e,a=x(r,n),h=o*A(a),l=e,u=e+i-1;u>=l;){var f=new y(t[2*l],t[2*l+1]),d=I(a,x(f,n));if(d>h){if(d>s)s=d,c=l;l++}else p(t,l,u),u--}if(c!=e)p(t,e,c);return l-e},g=function(t,e,i,n,r,o,s,c){if(0>n)return 0;else if(0==n)return e[2*c]=o.x,e[2*c+1]=o.y,1;else{var a=_(e,i,n,r,o,t),h=new y(e[2*i],e[2*i+1]),l=g(t,e,i+1,a-1,r,h,o,c),u=c+l++;e[2*u]=o.x,e[2*u+1]=o.y;var f=_(e,i+a,n-a,o,s,t),d=new y(e[2*(i+a)],e[2*(i+a)+1]);return l+g(t,e,i+a+1,f-1,o,d,s,c+l)}};cp.convexHull=function(t,e,i){if(e)for(var n=0;n<t.length;n++)e[n]=t[n];else e=t;var r=d(t),o=r[0],c=r[1];if(o==c)return e.length=2,e;p(e,0,o),p(e,1,0==c?o:c);var a=new y(e[0],e[1]),h=new y(e[2],e[3]),l=t.length>>1,u=g(i,e,2,l-2,a,h,a,1)+1;return e.length=2*u,s(it(e),"Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can."),e};var v=function(t,e,i){return n(r(t,e),i)},m=function(t){return r(0,n(t,1))},y=cp.Vect=function(t,e){this.x=t,this.y=e};cp.v=function(t,e){return new y(t,e)};var b=cp.vzero=new y(0,0),T=cp.v.dot=function(t,e){return t.x*e.x+t.y*e.y},C=function(t,e,i,n){return t*i+e*n},A=cp.v.len=function(t){return Math.sqrt(T(t,t))},S=cp.v.len2=function(t,e){return Math.sqrt(t*t+e*e)},E=(cp.v.eql=function(t,e){return t.x===e.x&&t.y===e.y},cp.v.add=function(t,e){return new y(t.x+e.x,t.y+e.y)});y.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this};var x=cp.v.sub=function(t,e){return new y(t.x-e.x,t.y-e.y)};y.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this};var O=cp.v.neg=function(t){return new y(-t.x,-t.y)};y.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this};var N=cp.v.mult=function(t,e){return new y(t.x*e,t.y*e)};y.prototype.mult=function(t){return this.x*=t,this.y*=t,this};var I=cp.v.cross=function(t,e){return t.x*e.y-t.y*e.x},w=function(t,e,i,n){return t*n-e*i},P=cp.v.perp=function(t){return new y(-t.y,t.x)},L=(cp.v.pvrperp=function(t){return new y(t.y,-t.x)},cp.v.project=function(t,e){return N(e,T(t,e)/M(e))});y.prototype.project=function(t){return this.mult(T(this,t)/M(t)),this};var R=cp.v.rotate=function(t,e){return new y(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)};y.prototype.rotate=function(t){return this.x=this.x*t.x-this.y*t.y,this.y=this.x*t.y+this.y*t.x,this};var F=cp.v.unrotate=function(t,e){return new y(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)},M=cp.v.lengthsq=function(t){return T(t,t)},B=cp.v.lengthsq2=function(t,e){return t*t+e*e},D=cp.v.lerp=function(t,e,i){return E(N(t,1-i),N(e,i))},z=cp.v.normalize=function(t){return N(t,1/A(t))},j=cp.v.normalize_safe=function(t){return 0===t.x&&0===t.y?b:z(t)},W=cp.v.clamp=function(t,e){return T(t,t)>e*e?N(z(t),e):t},k=(cp.v.lerpconst=function(t,e,i){return E(t,W(x(e,t),i))},cp.v.dist=function(t,e){return A(x(t,e))}),U=cp.v.distsq=function(t,e){return M(x(t,e))},V=(cp.v.near=function(t,e,i){return U(t,e)<i*i},cp.v.slerp=function(t,e,i){var n=Math.acos(T(t,e));if(n){var r=1/Math.sin(n);return E(N(t,Math.sin((1-i)*n)*r),N(e,Math.sin(i*n)*r))}else return t}),H=(cp.v.slerpconst=function(t,e,i){var r=Math.acos(T(t,e));return V(t,e,n(i,r)/r)},cp.v.forangle=function(t){return new y(Math.cos(t),Math.sin(t))},cp.v.toangle=function(t){return Math.atan2(t.y,t.x)},cp.v.str=function(t){return"("+t.x.toFixed(3)+", "+t.y.toFixed(3)+")"},0),G=cp.BB=function(t,e,i,n){this.l=t,this.b=e,this.r=i,this.t=n,H++};cp.bb=function(t,e,i,n){return new G(t,e,i,n)};var Y=function(t,e){return new G(t.x-e,t.y-e,t.x+e,t.y+e)},X=function(t,e,i,n,r){return t.l<=n&&e<=t.r&&t.b<=r&&i<=t.t},Q=0,q=(cp.NO_GROUP=0,cp.ALL_LAYERS=-1);cp.resetShapeIdCounter=function(){Q=0};var Z=cp.Shape=function(t){this.body=t,this.bb_l=this.bb_b=this.bb_r=this.bb_t=0,this.hashid=Q++,this.sensor=!1,this.e=0,this.u=0,this.surface_v=b,this.collision_type=0,this.group=0,this.layers=q,this.space=null,this.collisionCode=this.collisionCode};Z.prototype.setElasticity=function(t){this.e=t},Z.prototype.setFriction=function(t){this.body.activate(),this.u=t},Z.prototype.setLayers=function(t){this.body.activate(),this.layers=t},Z.prototype.setSensor=function(t){this.body.activate(),this.sensor=t},Z.prototype.setCollisionType=function(t){this.body.activate(),this.collision_type=t},Z.prototype.getBody=function(){return this.body},Z.prototype.active=function(){return this.body&&-1!==this.body.shapeList.indexOf(this)},Z.prototype.setBody=function(t){o(!this.active(),"You cannot change the body on an active shape. You must remove the shape from the space before changing the body."),this.body=t},Z.prototype.cacheBB=function(){return this.update(this.body.p,this.body.rot)},Z.prototype.update=function(t,e){o(!isNaN(e.x),"Rotation is NaN"),o(!isNaN(t.x),"Position is NaN"),this.cacheData(t,e)},Z.prototype.pointQuery=function(t){var e=this.nearestPointQuery(t);if(e.d<0)return e;else return},Z.prototype.getBB=function(){return new G(this.bb_l,this.bb_b,this.bb_r,this.bb_t)};var J=function(t,e,i){this.shape=t,this.p=e,this.d=i},K=function(t,e,i){this.shape=t,this.t=e,this.n=i};K.prototype.hitPoint=function(t,e){return D(t,e,this.t)},K.prototype.hitDist=function(t,e){return k(t,e)*this.t};var $=cp.CircleShape=function(t,e,i){this.c=this.tc=i,this.r=e,this.type="circle",Z.call(this,t)};$.prototype=Object.create(Z.prototype),$.prototype.cacheData=function(t,e){var i=this.tc=R(this.c,e).add(t),n=this.r;this.bb_l=i.x-n,this.bb_b=i.y-n,this.bb_r=i.x+n,this.bb_t=i.y+n},$.prototype.nearestPointQuery=function(t){var e=t.x-this.tc.x,i=t.y-this.tc.y,n=S(e,i),r=this.r,o=new y(this.tc.x+e*r/n,this.tc.y+i*r/n);return new J(this,o,n-r)};var tt=function(t,e,i,n,r,o){n=x(n,e),r=x(r,e);var s=T(n,n)-2*T(n,r)+T(r,r),c=-2*T(n,n)+2*T(n,r),a=T(n,n)-i*i,h=c*c-4*s*a;if(h>=0){var l=(-c-Math.sqrt(h))/(2*s);if(l>=0&&1>=l)return new K(t,l,z(D(n,r,l)))}};$.prototype.segmentQuery=function(t,e){return tt(this,this.tc,this.r,t,e)};var et=cp.SegmentShape=function(t,e,i,n){this.a=e,this.b=i,this.n=P(z(x(i,e))),this.ta=this.tb=this.tn=null,this.r=n,this.a_tangent=b,this.b_tangent=b,this.type="segment",Z.call(this,t)};et.prototype=Object.create(Z.prototype),et.prototype.cacheData=function(t,e){this.ta=E(t,R(this.a,e)),this.tb=E(t,R(this.b,e)),this.tn=R(this.n,e);var i,n,r,o;if(this.ta.x<this.tb.x)i=this.ta.x,n=this.tb.x;else i=this.tb.x,n=this.ta.x;if(this.ta.y<this.tb.y)r=this.ta.y,o=this.tb.y;else r=this.tb.y,o=this.ta.y;var s=this.r;this.bb_l=i-s,this.bb_b=r-s,this.bb_r=n+s,this.bb_t=o+s},et.prototype.nearestPointQuery=function(t){var e=u(t,this.ta,this.tb),i=t.x-e.x,n=t.y-e.y,r=S(i,n),o=this.r,s=r?E(e,N(new y(i,n),o/r)):e;return new J(this,s,r-o)},et.prototype.segmentQuery=function(t,e){var i=this.tn,n=T(x(this.ta,t),i),r=this.r,o=n>0?O(i):i,s=x(N(o,r),t),c=E(this.ta,s),a=E(this.tb,s),h=x(e,t);if(I(h,c)*I(h,a)<=0){var l=n+(n>0?-r:r),u=-l,f=T(h,i)-l;if(0>u*f)return new K(this,u/(u-f),o)}else if(0!==r){var d=tt(this,this.ta,this.r,t,e),p=tt(this,this.tb,this.r,t,e);if(d)return p&&p.t<d.t?p:d;else return p}},et.prototype.setNeighbors=function(t,e){this.a_tangent=x(t,this.a),this.b_tangent=x(e,this.b)},et.prototype.setEndpoints=function(t,e){this.a=t,this.b=e,this.n=P(z(x(e,t)))};var it=function(t){for(var e=t.length,i=0;e>i;i+=2){var n=t[i],r=t[i+1],o=t[(i+2)%e],s=t[(i+3)%e],c=t[(i+4)%e],a=t[(i+5)%e];if(w(o-n,s-r,c-o,a-s)>0)return!1}return!0},nt=cp.PolyShape=function(t,e,i){this.setVerts(e,i),this.type="poly",Z.call(this,t)};nt.prototype=Object.create(Z.prototype);var rt=function(t,e){this.n=t,this.d=e};rt.prototype.compare=function(t){return T(this.n,t)-this.d},nt.prototype.setVerts=function(t,e){o(t.length>=4,"Polygons require some verts"),o("number"==typeof t[0],"Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])"),o(it(t),"Polygon is concave or has a reversed winding. Consider using cpConvexHull()");var i=t.length,n=i>>1;this.verts=new Array(i),this.tVerts=new Array(i),this.planes=new Array(n),this.tPlanes=new Array(n);for(var r=0;i>r;r+=2){var s=t[r]+e.x,c=t[r+1]+e.y,a=t[(r+2)%i]+e.x,h=t[(r+3)%i]+e.y,l=z(P(new y(a-s,h-c)));this.verts[r]=s,this.verts[r+1]=c,this.planes[r>>1]=new rt(l,C(l.x,l.y,s,c)),this.tPlanes[r>>1]=new rt(new y(0,0),0)}};var ot=(cp.BoxShape=function(t,e,i){var n=e/2,r=i/2;return ot(t,new G(-n,-r,n,r))},cp.BoxShape2=function(t,e){var i=[e.l,e.b,e.l,e.t,e.r,e.t,e.r,e.b];return new nt(t,i,b)});nt.prototype.transformVerts=function(t,e){for(var i=this.verts,o=this.tVerts,s=1/0,c=-(1/0),a=1/0,h=-(1/0),l=0;l<i.length;l+=2){var u=i[l],f=i[l+1],d=t.x+u*e.x-f*e.y,p=t.y+u*e.y+f*e.x;o[l]=d,o[l+1]=p,s=n(s,d),c=r(c,d),a=n(a,p),h=r(h,p)}this.bb_l=s,this.bb_b=a,this.bb_r=c,this.bb_t=h},nt.prototype.transformAxes=function(t,e){for(var i=this.planes,n=this.tPlanes,r=0;r<i.length;r++){var o=R(i[r].n,e);n[r].n=o,n[r].d=T(t,o)+i[r].d}},nt.prototype.cacheData=function(t,e){this.transformAxes(t,e),this.transformVerts(t,e)},nt.prototype.nearestPointQuery=function(t){for(var e=this.tPlanes,i=this.tVerts,n=i[i.length-2],r=i[i.length-1],o=1/0,s=b,c=!1,a=0;a<e.length;a++){if(e[a].compare(t)>0)c=!0;var h=i[2*a],l=i[2*a+1],u=f(t.x,t.y,n,r,h,l),d=k(t,u);if(o>d)o=d,s=u;n=h,r=l}return new J(this,s,c?o:-o)},nt.prototype.segmentQuery=function(t,e){for(var i=this.tPlanes,n=this.tVerts,r=i.length,o=2*r,s=0;r>s;s++){var c=i[s].n,a=T(t,c);if(!(i[s].d>a)){var h=T(e,c),l=(i[s].d-a)/(h-a);if(!(0>l||l>1)){var u=D(t,e,l),f=-I(c,u),d=-w(c.x,c.y,n[2*s],n[2*s+1]),p=-w(c.x,c.y,n[(2*s+2)%o],n[(2*s+3)%o]);if(f>=d&&p>=f)return new K(this,l,c)}else;}else;}},nt.prototype.valueOnAxis=function(t,e){for(var i=this.tVerts,r=C(t.x,t.y,i[0],i[1]),o=2;o<i.length;o+=2)r=n(r,C(t.x,t.y,i[o],i[o+1]));return r-e},nt.prototype.containsVert=function(t,e){for(var i=this.tPlanes,n=0;n<i.length;n++){var r=i[n].n,o=C(r.x,r.y,t,e)-i[n].d;if(o>0)return!1}return!0},nt.prototype.containsVertPartial=function(t,e,i){for(var n=this.tPlanes,r=0;r<n.length;r++){var o=n[r].n;if(!(T(o,i)<0)){var s=C(o.x,o.y,t,e)-n[r].d;if(s>0)return!1}else;}return!0},nt.prototype.getNumVerts=function(){return this.verts.length/2},nt.prototype.getVert=function(t){return new y(this.verts[2*t],this.verts[2*t+1])};var st=cp.Body=function(t,e){this.p=new y(0,0),this.vx=this.vy=0,this.f=new y(0,0),this.w=0,this.t=0,this.v_limit=1/0,this.w_limit=1/0,this.v_biasx=this.v_biasy=0,this.w_bias=0,this.space=null,this.shapeList=[],this.arbiterList=null,this.constraintList=null,this.nodeRoot=null,this.nodeNext=null,this.nodeIdleTime=0,this.setMass(t),this.setMoment(e),this.rot=new y(0,0),this.setAngle(0)},ct=function(){var t=new st(1/0,1/0);return t.nodeIdleTime=1/0,t};if(cp.StaticBody=ct,"undefined"!=typeof DEBUG&&DEBUG){var at=function(t,e){o(t.x==t.x&&t.y==t.y,e)},ht=function(t,e){o(Math.abs(t.x)!==1/0&&Math.abs(t.y)!==1/0,e)},lt=function(t,e){at(t,e),ht(t,e)};st.prototype.sanityCheck=function(){o(this.m===this.m&&this.m_inv===this.m_inv,"Body's mass is invalid."),o(this.i===this.i&&this.i_inv===this.i_inv,"Body's moment is invalid."),lt(this.p,"Body's position is invalid."),lt(this.f,"Body's force is invalid."),o(this.vx===this.vx&&Math.abs(this.vx)!==1/0,"Body's velocity is invalid."),o(this.vy===this.vy&&Math.abs(this.vy)!==1/0,"Body's velocity is invalid."),o(this.a===this.a&&Math.abs(this.a)!==1/0,"Body's angle is invalid."),o(this.w===this.w&&Math.abs(this.w)!==1/0,"Body's angular velocity is invalid."),o(this.t===this.t&&Math.abs(this.t)!==1/0,"Body's torque is invalid."),lt(this.rot,"Body's rotation vector is invalid."),o(this.v_limit===this.v_limit,"Body's velocity limit is invalid."),o(this.w_limit===this.w_limit,"Body's angular velocity limit is invalid.")}}else st.prototype.sanityCheck=function(){};st.prototype.getPos=function(){return this.p},st.prototype.getVel=function(){return new y(this.vx,this.vy)},st.prototype.getAngVel=function(){return this.w},st.prototype.isSleeping=function(){return null!==this.nodeRoot},st.prototype.isStatic=function(){return this.nodeIdleTime===1/0},st.prototype.isRogue=function(){return null===this.space},st.prototype.setMass=function(t){o(t>0,"Mass must be positive and non-zero."),this.activate(),this.m=t,this.m_inv=1/t},st.prototype.setMoment=function(t){o(t>0,"Moment of Inertia must be positive and non-zero."),this.activate(),this.i=t,this.i_inv=1/t},st.prototype.addShape=function(t){this.shapeList.push(t)},st.prototype.removeShape=function(t){l(this.shapeList,t)};var ut=function(t,e,i){if(t===i)return t.next(e);else if(t.a===e)t.next_a=ut(t.next_a,e,i);else t.next_b=ut(t.next_b,e,i);return t};st.prototype.removeConstraint=function(t){this.constraintList=ut(this.constraintList,this,t)},st.prototype.setPos=function(t){if(this.activate(),this.sanityCheck(),t===b)t=cp.v(0,0);this.p=t},st.prototype.setVel=function(t){this.activate(),this.vx=t.x,this.vy=t.y},st.prototype.setAngVel=function(t){this.activate(),this.w=t},st.prototype.setAngleInternal=function(t){o(!isNaN(t),"Internal Error: Attempting to set body's angle to NaN"),this.a=t,this.rot.x=Math.cos(t),this.rot.y=Math.sin(t)},st.prototype.setAngle=function(t){this.activate(),this.sanityCheck(),this.setAngleInternal(t)},st.prototype.velocity_func=function(t,e,i){var n=this.vx*e+(t.x+this.f.x*this.m_inv)*i,r=this.vy*e+(t.y+this.f.y*this.m_inv)*i,o=this.v_limit,s=n*n+r*r,c=s>o*o?o/Math.sqrt(s):1;this.vx=n*c,this.vy=r*c;var a=this.w_limit;this.w=v(this.w*e+this.t*this.i_inv*i,-a,a),this.sanityCheck()},st.prototype.position_func=function(t){this.p.x+=(this.vx+this.v_biasx)*t,this.p.y+=(this.vy+this.v_biasy)*t,this.setAngleInternal(this.a+(this.w+this.w_bias)*t),this.v_biasx=this.v_biasy=0,this.w_bias=0,this.sanityCheck()},st.prototype.resetForces=function(){this.activate(),this.f=new y(0,0),this.t=0},st.prototype.applyForce=function(t,e){this.activate(),this.f=E(this.f,t),this.t+=I(e,t)},st.prototype.applyImpulse=function(t,e){this.activate(),de(this,t.x,t.y,e)},st.prototype.getVelAtPoint=function(t){return E(new y(this.vx,this.vy),N(P(t),this.w))},st.prototype.getVelAtWorldPoint=function(t){return this.getVelAtPoint(x(t,this.p))},st.prototype.getVelAtLocalPoint=function(t){return this.getVelAtPoint(R(t,this.rot))},st.prototype.eachShape=function(t){for(var e=0,i=this.shapeList.length;i>e;e++)t(this.shapeList[e])},st.prototype.eachConstraint=function(t){for(var e=this.constraintList;e;){var i=e.next(this);t(e),e=i}},st.prototype.eachArbiter=function(t){for(var e=this.arbiterList;e;){var i=e.next(this);e.swappedColl=this===e.body_b,t(e),e=i}},st.prototype.local2World=function(t){return E(this.p,R(t,this.rot))},st.prototype.world2Local=function(t){return F(x(t,this.p),this.rot)},st.prototype.kineticEnergy=function(){var t=this.vx*this.vx+this.vy*this.vy,e=this.w*this.w;return(t?t*this.m:0)+(e?e*this.i:0)};var ft=cp.SpatialIndex=function(t){if(this.staticIndex=t,t){if(t.dynamicIndex)throw new Error("This static index is already associated with a dynamic index.");t.dynamicIndex=this}};ft.prototype.collideStatic=function(t,e){if(t.count>0){var i=t.query;this.each(function(t){i(t,new G(t.bb_l,t.bb_b,t.bb_r,t.bb_t),e)})}};var dt=cp.BBTree=function(t){ft.call(this,t),this.velocityFunc=null,this.leaves={},this.count=0,this.root=null,this.pooledNodes=null,this.pooledPairs=null,this.stamp=0};dt.prototype=Object.create(ft.prototype);var pt=0,_t=function(t,e,i){this.obj=null,this.bb_l=n(e.bb_l,i.bb_l),this.bb_b=n(e.bb_b,i.bb_b),this.bb_r=r(e.bb_r,i.bb_r),this.bb_t=r(e.bb_t,i.bb_t),this.parent=null,this.setA(e),this.setB(i)};dt.prototype.makeNode=function(t,e){var i=this.pooledNodes;if(i)return this.pooledNodes=i.parent,i.constructor(this,t,e),i;else return pt++,new _t(this,t,e)};var gt=0,vt=function(t,e){this.obj=e,t.getBB(e,this),this.parent=null,this.stamp=1,this.pairs=null,gt++};dt.prototype.getBB=function(t,e){var i=this.velocityFunc;if(i){var o=.1,s=(t.bb_r-t.bb_l)*o,c=(t.bb_t-t.bb_b)*o,a=N(i(t),.1);e.bb_l=t.bb_l+n(-s,a.x),e.bb_b=t.bb_b+n(-c,a.y),e.bb_r=t.bb_r+r(s,a.x),e.bb_t=t.bb_t+r(c,a.y)}else e.bb_l=t.bb_l,e.bb_b=t.bb_b,e.bb_r=t.bb_r,e.bb_t=t.bb_t},dt.prototype.getStamp=function(){var t=this.dynamicIndex;return t&&t.stamp?t.stamp:this.stamp},dt.prototype.incrementStamp=function(){if(this.dynamicIndex&&this.dynamicIndex.stamp)this.dynamicIndex.stamp++;else this.stamp++};var mt=0,yt=function(t,e,i,n){this.prevA=null,this.leafA=t,this.nextA=e,this.prevB=null,this.leafB=i,this.nextB=n};dt.prototype.makePair=function(t,e,i,n){var r=this.pooledPairs;if(r)return this.pooledPairs=r.prevA,r.prevA=null,r.leafA=t,r.nextA=e,r.prevB=null,r.leafB=i,r.nextB=n,r;else return mt++,new yt(t,e,i,n)},yt.prototype.recycle=function(t){this.prevA=t.pooledPairs,t.pooledPairs=this};var bt=function(t,e,i){if(i)if(i.leafA===e)i.prevA=t;else i.prevB=t;if(t)if(t.leafA===e)t.nextA=i;else t.nextB=i;else e.pairs=i};vt.prototype.clearPairs=function(t){var e,i=this.pairs;for(this.pairs=null;i;){if(i.leafA===this)e=i.nextA,bt(i.prevB,i.leafB,i.nextB);else e=i.nextB,bt(i.prevA,i.leafA,i.nextA);i.recycle(t),i=e}};var Tt=function(t,e,i){var n=t.pairs,r=e.pairs,o=i.makePair(t,n,e,r);if(t.pairs=e.pairs=o,n)if(n.leafA===t)n.prevA=o;else n.prevB=o;if(r)if(r.leafA===e)r.prevA=o;else r.prevB=o};_t.prototype.recycle=function(t){this.parent=t.pooledNodes,t.pooledNodes=this},vt.prototype.recycle=function(t){},_t.prototype.setA=function(t){this.A=t,t.parent=this},_t.prototype.setB=function(t){this.B=t,t.parent=this},vt.prototype.isLeaf=!0,_t.prototype.isLeaf=!1,_t.prototype.otherChild=function(t){return this.A==t?this.B:this.A},_t.prototype.replaceChild=function(t,e,i){if(s(t==this.A||t==this.B,"Node is not a child of parent."),this.A==t)this.A.recycle(i),this.setA(e);else this.B.recycle(i),this.setB(e);for(var o=this;o;o=o.parent){var c=o.A,a=o.B;o.bb_l=n(c.bb_l,a.bb_l),o.bb_b=n(c.bb_b,a.bb_b),o.bb_r=r(c.bb_r,a.bb_r),o.bb_t=r(c.bb_t,a.bb_t)}},_t.prototype.bbArea=vt.prototype.bbArea=function(){return(this.bb_r-this.bb_l)*(this.bb_t-this.bb_b)};var Ct=function(t,e){return(r(t.bb_r,e.bb_r)-n(t.bb_l,e.bb_l))*(r(t.bb_t,e.bb_t)-n(t.bb_b,e.bb_b))},At=function(t,e){return Math.abs(t.bb_l+t.bb_r-e.bb_l-e.bb_r)+Math.abs(t.bb_b+t.bb_t-e.bb_b-e.bb_t)},St=function(t,e,i){if(null==t)return e;else if(t.isLeaf)return i.makeNode(e,t);else{var o=t.B.bbArea()+Ct(t.A,e),s=t.A.bbArea()+Ct(t.B,e);if(o===s)o=At(t.A,e),s=At(t.B,e);if(o>s)t.setB(St(t.B,e,i));else t.setA(St(t.A,e,i));return t.bb_l=n(t.bb_l,e.bb_l),t.bb_b=n(t.bb_b,e.bb_b),t.bb_r=r(t.bb_r,e.bb_r),t.bb_t=r(t.bb_t,e.bb_t),t}};_t.prototype.intersectsBB=vt.prototype.intersectsBB=function(t){return this.bb_l<=t.r&&t.l<=this.bb_r&&this.bb_b<=t.t&&t.b<=this.bb_t};var Et=function(t,e,i){if(t.intersectsBB(e))if(t.isLeaf)i(t.obj);else Et(t.A,e,i),Et(t.B,e,i)},xt=function(t,e,i){var o=1/(i.x-e.x),s=t.bb_l==e.x?-(1/0):(t.bb_l-e.x)*o,c=t.bb_r==e.x?1/0:(t.bb_r-e.x)*o,a=n(s,c),h=r(s,c),l=1/(i.y-e.y),u=t.bb_b==e.y?-(1/0):(t.bb_b-e.y)*l,f=t.bb_t==e.y?1/0:(t.bb_t-e.y)*l,d=n(u,f),p=r(u,f);if(h>=d&&p>=a){var _=r(a,d),g=n(h,p);if(g>=0&&1>=_)return r(_,0)}return 1/0},Ot=function(t,e,i,r,o){if(t.isLeaf)return o(t.obj);else{var s=xt(t.A,e,i),c=xt(t.B,e,i);if(c>s){if(r>s)r=n(r,Ot(t.A,e,i,r,o));if(r>c)r=n(r,Ot(t.B,e,i,r,o))}else{if(r>c)r=n(r,Ot(t.B,e,i,r,o));if(r>s)r=n(r,Ot(t.A,e,i,r,o))}return r}};dt.prototype.subtreeRecycle=function(t){if(t.isLeaf)this.subtreeRecycle(t.A),this.subtreeRecycle(t.B),t.recycle(this)};var Nt=function(t,e,i){if(e==t)return null;else{var n=e.parent;if(n==t){var r=t.otherChild(e);return r.parent=t.parent,t.recycle(i),r}else return n.parent.replaceChild(n,n.otherChild(e),i),t}},It=function(t,e){return t.bb_l<=e.bb_r&&e.bb_l<=t.bb_r&&t.bb_b<=e.bb_t&&e.bb_b<=t.bb_t};vt.prototype.markLeafQuery=function(t,e,i,n){if(It(t,this))if(e)Tt(t,this,i);else{if(this.stamp<t.stamp)Tt(this,t,i);if(n)n(t.obj,this.obj)}},_t.prototype.markLeafQuery=function(t,e,i,n){if(It(t,this))this.A.markLeafQuery(t,e,i,n),this.B.markLeafQuery(t,e,i,n)},vt.prototype.markSubtree=function(t,e,i){if(this.stamp==t.getStamp()){if(e)e.markLeafQuery(this,!1,t,i);for(var n=this;n.parent;n=n.parent)if(n==n.parent.A)n.parent.B.markLeafQuery(this,!0,t,i);else n.parent.A.markLeafQuery(this,!1,t,i)}else for(var r=this.pairs;r;)if(this===r.leafB){if(i)i(r.leafA.obj,this.obj);r=r.nextB}else r=r.nextA},_t.prototype.markSubtree=function(t,e,i){this.A.markSubtree(t,e,i),this.B.markSubtree(t,e,i)},vt.prototype.containsObj=function(t){return this.bb_l<=t.bb_l&&this.bb_r>=t.bb_r&&this.bb_b<=t.bb_b&&this.bb_t>=t.bb_t},vt.prototype.update=function(t){var e=t.root,i=this.obj;if(!this.containsObj(i))return t.getBB(this.obj,this),e=Nt(e,this,t),t.root=St(e,this,t),this.clearPairs(t),this.stamp=t.getStamp(),!0;else return!1},vt.prototype.addPairs=function(t){var e=t.dynamicIndex;if(e){var i=e.root;if(i)i.markLeafQuery(this,!0,e,null)}else{var n=t.staticIndex.root;this.markSubtree(t,n,null)}},dt.prototype.insert=function(t,e){var i=new vt(this,t);this.leaves[e]=i,this.root=St(this.root,i,this),this.count++,i.stamp=this.getStamp(),i.addPairs(this),this.incrementStamp()},dt.prototype.remove=function(t,e){var i=this.leaves[e];delete this.leaves[e],this.root=Nt(this.root,i,this),this.count--,i.clearPairs(this),i.recycle(this)},dt.prototype.contains=function(t,e){return null!=this.leaves[e]};var wt=function(t,e){};dt.prototype.reindexQuery=function(t){if(this.root){var e,i=this.leaves;for(e in i)i[e].update(this);var n=this.staticIndex,r=n&&n.root;if(this.root.markSubtree(this,r,t),n&&!r)this.collideStatic(this,n,t);this.incrementStamp()}},dt.prototype.reindex=function(){this.reindexQuery(wt)},dt.prototype.reindexObject=function(t,e){var i=this.leaves[e];if(i){if(i.update(this))i.addPairs(this);this.incrementStamp()}},dt.prototype.pointQuery=function(t,e){this.query(new G(t.x,t.y,t.x,t.y),e)},dt.prototype.segmentQuery=function(t,e,i,n){if(this.root)Ot(this.root,t,e,i,n)},dt.prototype.query=function(t,e){if(this.root)Et(this.root,t,e)},dt.prototype.count=function(){return this.count},dt.prototype.each=function(t){var e;for(e in this.leaves)t(this.leaves[e].obj)};var Pt=function(t,e,i,o,s){return(r(t.bb_r,o)-n(t.bb_l,e))*(r(t.bb_t,s)-n(t.bb_b,i))},Lt=function(t,e,i,o){if(1==o)return e[i];else if(2==o)return t.makeNode(e[i],e[i+1]);for(var s=e[i],c=s.bb_l,a=s.bb_b,h=s.bb_r,l=s.bb_t,u=i+o,f=i+1;u>f;f++)s=e[f],c=n(c,s.bb_l),a=n(a,s.bb_b),h=r(h,s.bb_r),l=r(l,s.bb_t);var d=h-c>l-a,p=new Array(2*o);if(d)for(var f=i;u>f;f++)p[2*f+0]=e[f].bb_l,p[2*f+1]=e[f].bb_r;else for(var f=i;u>f;f++)p[2*f+0]=e[f].bb_b,p[2*f+1]=e[f].bb_t;p.sort(function(t,e){return t-e});var _=.5*(p[o-1]+p[o]),g=c,v=a,m=h,y=l,b=c,T=a,C=h,A=l;if(d)m=b=_;else y=T=_;for(var S=u,E=i;S>E;){var s=e[E];if(Pt(s,b,T,C,A)<Pt(s,g,v,m,y))S--,e[E]=e[S],e[S]=s;else E++}if(S==o){for(var s=null,f=i;u>f;f++)s=St(s,e[f],t);return s}return NodeNew(t,Lt(t,e,i,S-i),Lt(t,e,S,u-S))};dt.prototype.optimize=function(){var t=new Array(this.count),e=0;for(var i in this.leaves)t[e++]=this.nodes[i];tree.subtreeRecycle(root),this.root=Lt(tree,t,t.length)};var Rt=function(t,e){if(!t.isLeaf&&10>=e)Rt(t.A,e+1),Rt(t.B,e+1);for(var i="",n=0;e>n;n++)i+=" ";console.log(i+t.bb_b+" "+t.bb_t)};dt.prototype.log=function(){if(this.root)Rt(this.root,0)};var Ft=cp.CollisionHandler=function(){this.a=this.b=0};Ft.prototype.begin=function(t,e){return!0},Ft.prototype.preSolve=function(t,e){return!0},Ft.prototype.postSolve=function(t,e){},Ft.prototype.separate=function(t,e){};var Mt=function(t,e){this.e=0,this.u=0,this.surface_vr=b,this.a=t,this.body_a=t.body,this.b=e,this.body_b=e.body,this.thread_a_next=this.thread_a_prev=null,this.thread_b_next=this.thread_b_prev=null,this.contacts=null,this.stamp=0,this.handler=null,this.swappedColl=!1,this.state="first coll"};Mt.prototype.getShapes=function(){if(this.swappedColl)return[this.b,this.a];else return[this.a,this.b]},Mt.prototype.totalImpulse=function(){for(var t=this.contacts,e=new y(0,0),i=0,n=t.length;n>i;i++){var r=t[i];e.add(N(r.n,r.jnAcc))}return this.swappedColl?e:e.neg()},Mt.prototype.totalImpulseWithFriction=function(){for(var t=this.contacts,e=new y(0,0),i=0,n=t.length;n>i;i++){var r=t[i];e.add(new y(r.jnAcc,r.jtAcc).rotate(r.n))}return this.swappedColl?e:e.neg()},Mt.prototype.totalKE=function(){for(var t=(1-this.e)/(1+this.e),e=0,i=this.contacts,n=0,r=i.length;r>n;n++){var o=i[n],s=o.jnAcc,c=o.jtAcc;e+=t*s*s/o.nMass+c*c/o.tMass}return e},Mt.prototype.ignore=function(){this.state="ignore"},Mt.prototype.getA=function(){return this.swappedColl?this.b:this.a},Mt.prototype.getB=function(){return this.swappedColl?this.a:this.b},Mt.prototype.isFirstContact=function(){return"first coll"===this.state};var Bt=function(t,e,i){this.point=t,this.normal=e,this.dist=i};Mt.prototype.getContactPointSet=function(){var t,e=new Array(this.contacts.length);for(t=0;t<e.length;t++)e[t]=new Bt(this.contacts[t].p,this.contacts[t].n,this.contacts[t].dist);return e},Mt.prototype.getNormal=function(t){var e=this.contacts[t].n;return this.swappedColl?O(e):e},Mt.prototype.getPoint=function(t){return this.contacts[t].p},Mt.prototype.getDepth=function(t){return this.contacts[t].dist};var Dt=function(t,e,i,n){if(i)if(i.body_a===e)i.thread_a_next=n;else i.thread_b_next=n;else e.arbiterList=n;if(n)if(n.body_a===e)n.thread_a_prev=i;else n.thread_b_prev=i};Mt.prototype.unthread=function(){Dt(this,this.body_a,this.thread_a_prev,this.thread_a_next),Dt(this,this.body_b,this.thread_b_prev,this.thread_b_next),this.thread_a_prev=this.thread_a_next=null,this.thread_b_prev=this.thread_b_next=null},Mt.prototype.update=function(t,e,i,n){if(this.contacts)for(var r=0;r<this.contacts.length;r++)for(var o=this.contacts[r],s=0;s<t.length;s++){var c=t[s];if(c.hash===o.hash)c.jnAcc=o.jnAcc,c.jtAcc=o.jtAcc}if(this.contacts=t,this.handler=e,this.swappedColl=i.collision_type!==e.a,this.e=i.e*n.e,this.u=i.u*n.u,this.surface_vr=x(i.surface_v,n.surface_v),this.a=i,this.body_a=i.body,this.b=n,this.body_b=n.body,"cached"==this.state)this.state="first coll"},Mt.prototype.preStep=function(t,e,i){for(var r=this.body_a,o=this.body_b,s=0;s<this.contacts.length;s++){
var c=this.contacts[s];c.r1=x(c.p,r.p),c.r2=x(c.p,o.p),c.nMass=1/ve(r,o,c.r1,c.r2,c.n),c.tMass=1/ve(r,o,c.r1,c.r2,P(c.n)),c.bias=-i*n(0,c.dist+e)/t,c.jBias=0,c.bounce=fe(r,o,c.r1,c.r2,c.n)*this.e}},Mt.prototype.applyCachedImpulse=function(t){if(!this.isFirstContact())for(var e=this.body_a,i=this.body_b,n=0;n<this.contacts.length;n++){var r=this.contacts[n],o=r.n.x,s=r.n.y,c=o*r.jnAcc-s*r.jtAcc,a=o*r.jtAcc+s*r.jnAcc;pe(e,i,r.r1,r.r2,c*t,a*t)}};var zt=0,jt=0;Mt.prototype.applyImpulse=function(){zt++;for(var t=this.body_a,e=this.body_b,i=this.surface_vr,n=this.u,o=0;o<this.contacts.length;o++){jt++;var s=this.contacts[o],c=s.nMass,a=s.n,h=s.r1,l=s.r2,u=e.vx-l.y*e.w-(t.vx-h.y*t.w),f=e.vy+l.x*e.w-(t.vy+h.x*t.w),d=a.x*(e.v_biasx-l.y*e.w_bias-t.v_biasx+h.y*t.w_bias)+a.y*(l.x*e.w_bias+e.v_biasy-h.x*t.w_bias-t.v_biasy),p=C(u,f,a.x,a.y),_=C(u+i.x,f+i.y,-a.y,a.x),g=(s.bias-d)*c,m=s.jBias;s.jBias=r(m+g,0);var y=-(s.bounce+p)*c,b=s.jnAcc;s.jnAcc=r(b+y,0);var T=n*s.jnAcc,A=-_*s.tMass,S=s.jtAcc;s.jtAcc=v(S+A,-T,T);var E=a.x*(s.jBias-m),x=a.y*(s.jBias-m);_e(t,-E,-x,h),_e(e,E,x,l);var O=s.jnAcc-b,N=s.jtAcc-S;pe(t,e,h,l,a.x*O-a.y*N,a.x*N+a.y*O)}},Mt.prototype.callSeparate=function(t){var e=t.lookupHandler(this.a.collision_type,this.b.collision_type);e.separate(this,t)},Mt.prototype.next=function(t){return this.body_a==t?this.thread_a_next:this.thread_b_next};var Wt=0,kt=function(t,e,i,n){this.p=t,this.n=e,this.dist=i,this.r1=this.r2=b,this.nMass=this.tMass=this.bounce=this.bias=0,this.jnAcc=this.jtAcc=this.jBias=0,this.hash=n,Wt++},Ut=[],Vt=function(t,e,i,n){var r=i+n,o=x(e,t),s=M(o);if(!(s>=r*r)){var c=Math.sqrt(s);return new kt(E(t,N(o,.5+(i-.5*r)/(c?c:1/0))),c?N(o,1/c):new y(1,0),c-r,0)}},Ht=function(t,e){var i=Vt(t.tc,e.tc,t.r,e.r);return i?[i]:Ut},Gt=function(t,e){var i=e.ta,n=e.tb,r=t.tc,o=x(n,i),s=m(T(o,x(r,i))/M(o)),c=E(i,N(o,s)),a=Vt(r,c,t.r,e.r);if(a){var h=a.n;return 0===s&&T(h,e.a_tangent)<0||1===s&&T(h,e.b_tangent)<0?Ut:[a]}else return Ut},Yt=0,Xt=function(t,e){var i=0,n=t.valueOnAxis(e[0].n,e[0].d);if(n>0)return-1;for(var r=1;r<e.length;r++){var o=t.valueOnAxis(e[r].n,e[r].d);if(o>0)return-1;else if(o>n)n=o,i=r}return Yt=n,i},Qt=function(t,e,i,n){for(var r=[],o=t.tVerts,s=0;s<o.length;s+=2){var c=o[s],a=o[s+1];if(e.containsVertPartial(c,a,O(i)))r.push(new kt(new y(c,a),i,n,h(t.hashid,s)))}for(var l=e.tVerts,s=0;s<l.length;s+=2){var c=l[s],a=l[s+1];if(t.containsVertPartial(c,a,i))r.push(new kt(new y(c,a),i,n,h(e.hashid,s)))}return r},qt=function(t,e,i,n){for(var r=[],o=t.tVerts,s=0;s<o.length;s+=2){var c=o[s],a=o[s+1];if(e.containsVert(c,a))r.push(new kt(new y(c,a),i,n,h(t.hashid,s>>1)))}for(var l=e.tVerts,s=0;s<l.length;s+=2){var c=l[s],a=l[s+1];if(t.containsVert(c,a))r.push(new kt(new y(c,a),i,n,h(e.hashid,s>>1)))}return r.length?r:Qt(t,e,i,n)},Zt=function(t,e){var i=Xt(e,t.tPlanes);if(-1==i)return Ut;var n=Yt,r=Xt(t,e.tPlanes);if(-1==r)return Ut;var o=Yt;if(n>o)return qt(t,e,t.tPlanes[i].n,n);else return qt(t,e,O(e.tPlanes[r].n),o)},Jt=function(t,e,i){var r=T(e,t.ta)-t.r,o=T(e,t.tb)-t.r;return n(r,o)-i},Kt=function(t,e,i,n,r){for(var o=I(e.tn,e.ta),s=I(e.tn,e.tb),c=N(e.tn,r),a=i.tVerts,l=0;l<a.length;l+=2){var u=a[l],f=a[l+1];if(C(u,f,c.x,c.y)<T(e.tn,e.ta)*r+e.r){var d=w(e.tn.x,e.tn.y,u,f);if(o>=d&&d>=s)t.push(new kt(new y(u,f),c,n,h(i.hashid,l)))}}},$t=function(t,e){var i=[],n=e.tPlanes,r=n.length,o=T(t.tn,t.ta),s=e.valueOnAxis(t.tn,o)-t.r,c=e.valueOnAxis(O(t.tn),-o)-t.r;if(c>0||s>0)return Ut;var a=0,l=Jt(t,n[0].n,n[0].d);if(l>0)return Ut;for(var u=0;r>u;u++){var f=Jt(t,n[u].n,n[u].d);if(f>0)return Ut;else if(f>l)l=f,a=u}var d=O(n[a].n),p=E(t.ta,N(d,t.r)),_=E(t.tb,N(d,t.r));if(e.containsVert(p.x,p.y))i.push(new kt(p,d,l,h(t.hashid,0)));if(e.containsVert(_.x,_.y))i.push(new kt(_,d,l,h(t.hashid,1)));if(s>=l||c>=l)if(s>c)Kt(i,t,e,s,1);else Kt(i,t,e,c,-1);if(0===i.length){var g,v=2*a,m=e.tVerts,b=new y(m[v],m[v+1]);if(g=Vt(t.ta,b,t.r,0,i))return[g];if(g=Vt(t.tb,b,t.r,0,i))return[g];var C=2*r,A=new y(m[(v+2)%C],m[(v+3)%C]);if(g=Vt(t.ta,A,t.r,0,i))return[g];if(g=Vt(t.tb,A,t.r,0,i))return[g]}return i},te=function(t,e){for(var i=e.tPlanes,n=0,r=T(i[0].n,t.tc)-i[0].d-t.r,o=0;o<i.length;o++){var s=T(i[o].n,t.tc)-i[o].d-t.r;if(s>0)return Ut;else if(s>r)r=s,n=o}var c=i[n].n,a=e.tVerts,h=a.length,l=n<<1,u=a[l],f=a[l+1],d=a[(l+2)%h],p=a[(l+3)%h],_=w(c.x,c.y,u,f),g=w(c.x,c.y,d,p),v=I(c,t.tc);if(g>v){var m=Vt(t.tc,new y(d,p),t.r,0,m);return m?[m]:Ut}else if(_>v)return[new kt(x(t.tc,N(c,t.r+r/2)),O(c),r,0)];else{var m=Vt(t.tc,new y(u,f),t.r,0,m);return m?[m]:Ut}};$.prototype.collisionCode=0,et.prototype.collisionCode=1,nt.prototype.collisionCode=2,$.prototype.collisionTable=[Ht,Gt,te],et.prototype.collisionTable=[null,function(t,e){return Ut},$t],nt.prototype.collisionTable=[null,null,Zt];var ee=cp.collideShapes=function(t,e){return o(t.collisionCode<=e.collisionCode,"Collided shapes must be sorted by type"),t.collisionTable[e.collisionCode](t,e)},ie=new Ft,ne=cp.Space=function(){this.stamp=0,this.curr_dt=0,this.bodies=[],this.rousedBodies=[],this.sleepingComponents=[],this.staticShapes=new dt(null),this.activeShapes=new dt(this.staticShapes),this.arbiters=[],this.contactBuffersHead=null,this.cachedArbiters={},this.constraints=[],this.locked=0,this.collisionHandlers={},this.defaultHandler=ie,this.postStepCallbacks=[],this.iterations=10,this.gravity=b,this.damping=1,this.idleSpeedThreshold=0,this.sleepTimeThreshold=1/0,this.collisionSlop=.1,this.collisionBias=Math.pow(.9,60),this.collisionPersistence=3,this.enableContactGraph=!1,this.staticBody=new st(1/0,1/0),this.staticBody.nodeIdleTime=1/0,this.collideShapes=this.makeCollideShapes()};ne.prototype.getCurrentTimeStep=function(){return this.curr_dt},ne.prototype.setIterations=function(t){this.iterations=t},ne.prototype.isLocked=function(){return this.locked};var re=function(t){o(!t.locked,"This addition/removal cannot be done safely during a call to cpSpaceStep()  or during a query. Put these calls into a post-step callback.")};ne.prototype.addCollisionHandler=function(t,e,i,n,r,o){re(this),this.removeCollisionHandler(t,e);var s=new Ft;if(s.a=t,s.b=e,i)s.begin=i;if(n)s.preSolve=n;if(r)s.postSolve=r;if(o)s.separate=o;this.collisionHandlers[h(t,e)]=s},ne.prototype.removeCollisionHandler=function(t,e){re(this),delete this.collisionHandlers[h(t,e)]},ne.prototype.setDefaultCollisionHandler=function(t,e,i,n){re(this);var r=new Ft;if(t)r.begin=t;if(e)r.preSolve=e;if(i)r.postSolve=i;if(n)r.separate=n;this.defaultHandler=r},ne.prototype.lookupHandler=function(t,e){return this.collisionHandlers[h(t,e)]||this.defaultHandler},ne.prototype.addShape=function(t){var e=t.body;if(e.isStatic())return this.addStaticShape(t);else return o(!t.space,"This shape is already added to a space and cannot be added to another."),re(this),e.activate(),e.addShape(t),t.update(e.p,e.rot),this.activeShapes.insert(t,t.hashid),t.space=this,t},ne.prototype.addStaticShape=function(t){o(!t.space,"This shape is already added to a space and cannot be added to another."),re(this);var e=t.body;return e.addShape(t),t.update(e.p,e.rot),this.staticShapes.insert(t,t.hashid),t.space=this,t},ne.prototype.addBody=function(t){return o(!t.isStatic(),"Static bodies cannot be added to a space as they are not meant to be simulated."),o(!t.space,"This body is already added to a space and cannot be added to another."),re(this),this.bodies.push(t),t.space=this,t},ne.prototype.addConstraint=function(t){o(!t.space,"This shape is already added to a space and cannot be added to another."),re(this);var e=t.a,i=t.b;return e.activate(),i.activate(),this.constraints.push(t),t.next_a=e.constraintList,e.constraintList=t,t.next_b=i.constraintList,i.constraintList=t,t.space=this,t},ne.prototype.filterArbiters=function(t,e){for(var i in this.cachedArbiters){var n=this.cachedArbiters[i];if(t===n.body_a&&(e===n.a||null===e)||t===n.body_b&&(e===n.b||null===e)){if(e&&"cached"!==n.state)n.callSeparate(this);n.unthread(),l(this.arbiters,n),delete this.cachedArbiters[i]}}},ne.prototype.removeShape=function(t){var e=t.body;if(e.isStatic())this.removeStaticShape(t);else o(this.containsShape(t),"Cannot remove a shape that was not added to the space. (Removed twice maybe?)"),re(this),e.activate(),e.removeShape(t),this.filterArbiters(e,t),this.activeShapes.remove(t,t.hashid),t.space=null},ne.prototype.removeStaticShape=function(t){o(this.containsShape(t),"Cannot remove a static or sleeping shape that was not added to the space. (Removed twice maybe?)"),re(this);var e=t.body;if(e.isStatic())e.activateStatic(t);e.removeShape(t),this.filterArbiters(e,t),this.staticShapes.remove(t,t.hashid),t.space=null},ne.prototype.removeBody=function(t){o(this.containsBody(t),"Cannot remove a body that was not added to the space. (Removed twice maybe?)"),re(this),t.activate(),l(this.bodies,t),t.space=null},ne.prototype.removeConstraint=function(t){o(this.containsConstraint(t),"Cannot remove a constraint that was not added to the space. (Removed twice maybe?)"),re(this),t.a.activate(),t.b.activate(),l(this.constraints,t),t.a.removeConstraint(t),t.b.removeConstraint(t),t.space=null},ne.prototype.containsShape=function(t){return t.space===this},ne.prototype.containsBody=function(t){return t.space==this},ne.prototype.containsConstraint=function(t){return t.space==this},ne.prototype.uncacheArbiter=function(t){delete this.cachedArbiters[h(t.a.hashid,t.b.hashid)],l(this.arbiters,t)},ne.prototype.eachBody=function(t){this.lock();for(var e=this.bodies,i=0;i<e.length;i++)t(e[i]);for(var n=this.sleepingComponents,i=0;i<n.length;i++)for(var r=n[i],o=r;o;){var s=o.nodeNext;t(o),o=s}this.unlock(!0)},ne.prototype.eachShape=function(t){this.lock(),this.activeShapes.each(t),this.staticShapes.each(t),this.unlock(!0)},ne.prototype.eachConstraint=function(t){this.lock();for(var e=this.constraints,i=0;i<e.length;i++)t(e[i]);this.unlock(!0)},ne.prototype.reindexStatic=function(){o(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete."),this.staticShapes.each(function(t){var e=t.body;t.update(e.p,e.rot)}),this.staticShapes.reindex()},ne.prototype.reindexShape=function(t){o(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.");var e=t.body;t.update(e.p,e.rot),this.activeShapes.reindexObject(t,t.hashid),this.staticShapes.reindexObject(t,t.hashid)},ne.prototype.reindexShapesForBody=function(t){for(var e=t.shapeList;e;e=e.next)this.reindexShape(e)},ne.prototype.useSpatialHash=function(t,e){throw new Error("Spatial Hash not implemented.")},ne.prototype.activateBody=function(t){if(o(!t.isRogue(),"Internal error: Attempting to activate a rogue body."),this.locked){if(-1===this.rousedBodies.indexOf(t))this.rousedBodies.push(t)}else{this.bodies.push(t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.staticShapes.remove(i,i.hashid),this.activeShapes.insert(i,i.hashid)}for(var n=t.arbiterList;n;n=n.next(t)){var r=n.body_a;if(t===r||r.isStatic()){var s=n.a,c=n.b;this.cachedArbiters[h(s.hashid,c.hashid)]=n,n.stamp=this.stamp,n.handler=this.lookupHandler(s.collision_type,c.collision_type),this.arbiters.push(n)}}for(var a=t.constraintList;a;a=a.nodeNext){var r=a.a;if(t===r||r.isStatic())this.constraints.push(a)}}},ne.prototype.deactivateBody=function(t){o(!t.isRogue(),"Internal error: Attempting to deactivate a rogue body."),l(this.bodies,t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.activeShapes.remove(i,i.hashid),this.staticShapes.insert(i,i.hashid)}for(var n=t.arbiterList;n;n=n.next(t)){var r=n.body_a;if(t===r||r.isStatic())this.uncacheArbiter(n)}for(var s=t.constraintList;s;s=s.nodeNext){var r=s.a;if(t===r||r.isStatic())l(this.constraints,s)}};var oe=function(t){return t?t.nodeRoot:null},se=function(t){if(t&&t.isSleeping(t)){o(!t.isRogue(),"Internal Error: componentActivate() called on a rogue body.");for(var e=t.space,i=t;i;){var n=i.nodeNext;i.nodeIdleTime=0,i.nodeRoot=null,i.nodeNext=null,e.activateBody(i),i=n}l(e.sleepingComponents,t)}};st.prototype.activate=function(){if(!this.isRogue())this.nodeIdleTime=0,se(oe(this))},st.prototype.activateStatic=function(t){o(this.isStatic(),"Body.activateStatic() called on a non-static body.");for(var e=this.arbiterList;e;e=e.next(this))if(!t||t==e.a||t==e.b)(e.body_a==this?e.body_b:e.body_a).activate()},st.prototype.pushArbiter=function(t){s(null===(t.body_a===this?t.thread_a_next:t.thread_b_next),"Internal Error: Dangling contact graph pointers detected. (A)"),s(null===(t.body_a===this?t.thread_a_prev:t.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (B)");var e=this.arbiterList;if(s(null===e||null===(e.body_a===this?e.thread_a_prev:e.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (C)"),t.body_a===this)t.thread_a_next=e;else t.thread_b_next=e;if(e)if(e.body_a===this)e.thread_a_prev=t;else e.thread_b_prev=t;this.arbiterList=t};var ce=function(t,e){if(e.nodeRoot=t,e!==t)e.nodeNext=t.nodeNext,t.nodeNext=e},ae=function(t,e){if(!e.isRogue()){var i=oe(e);if(null==i){ce(t,e);for(var n=e.arbiterList;n;n=n.next(e))ae(t,e==n.body_a?n.body_b:n.body_a);for(var r=e.constraintList;r;r=r.next(e))ae(t,e==r.a?r.b:r.a)}else s(i===t,"Internal Error: Inconsistency detected in the contact graph.")}},he=function(t,e){for(var i=t;i;i=i.nodeNext)if(i.nodeIdleTime<e)return!0;return!1};ne.prototype.processComponents=function(t){for(var e=this.sleepTimeThreshold!==1/0,i=this.bodies,n=0;n<i.length;n++){var r=i[n];s(null===r.nodeNext,"Internal Error: Dangling next pointer detected in contact graph."),s(null===r.nodeRoot,"Internal Error: Dangling root pointer detected in contact graph.")}if(e)for(var o=this.idleSpeedThreshold,c=o?o*o:M(this.gravity)*t*t,n=0;n<i.length;n++){var r=i[n],a=c?r.m*c:0;r.nodeIdleTime=r.kineticEnergy()>a?0:r.nodeIdleTime+t}for(var h=this.arbiters,n=0,l=h.length;l>n;n++){var u=h[n],f=u.body_a,d=u.body_b;if(e){if(d.isRogue()&&!d.isStatic()||f.isSleeping())f.activate();if(f.isRogue()&&!f.isStatic()||d.isSleeping())d.activate()}f.pushArbiter(u),d.pushArbiter(u)}if(e){for(var p=this.constraints,n=0;n<p.length;n++){var _=p[n],f=_.a,d=_.b;if(d.isRogue()&&!d.isStatic())f.activate();if(f.isRogue()&&!f.isStatic())d.activate()}for(var n=0;n<i.length;){var r=i[n];if(null===oe(r))if(ae(r,r),!he(r,this.sleepTimeThreshold)){this.sleepingComponents.push(r);for(var g=r;g;g=g.nodeNext)this.deactivateBody(g);continue}n++,r.nodeRoot=null,r.nodeNext=null}}},st.prototype.sleep=function(){this.sleepWithGroup(null)},st.prototype.sleepWithGroup=function(t){o(!this.isStatic()&&!this.isRogue(),"Rogue and static bodies cannot be put to sleep.");var e=this.space;if(o(e,"Cannot put a rogue body to sleep."),o(!e.locked,"Bodies cannot be put to sleep during a query or a call to cpSpaceStep(). Put these calls into a post-step callback."),o(null===t||t.isSleeping(),"Cannot use a non-sleeping body as a group identifier."),this.isSleeping())return void o(oe(this)===oe(t),"The body is already sleeping and it's group cannot be reassigned.");for(var i=0;i<this.shapeList.length;i++)this.shapeList[i].update(this.p,this.rot);if(e.deactivateBody(this),t){var n=oe(t);this.nodeRoot=n,this.nodeNext=n.nodeNext,this.nodeIdleTime=0,n.nodeNext=this}else this.nodeRoot=this,this.nodeNext=null,this.nodeIdleTime=0,e.sleepingComponents.push(this);l(e.bodies,this)},ne.prototype.activateShapesTouchingShape=function(t){if(this.sleepTimeThreshold!==1/0)this.shapeQuery(t,function(t,e){t.body.activate()})},ne.prototype.pointQuery=function(t,e,i,n){var r=function(r){if((!r.group||i!==r.group)&&e&r.layers&&r.pointQuery(t))n(r)},o=new G(t.x,t.y,t.x,t.y);this.lock(),this.activeShapes.query(o,r),this.staticShapes.query(o,r),this.unlock(!0)},ne.prototype.pointQueryFirst=function(t,e,i){var n=null;return this.pointQuery(t,e,i,function(t){if(!t.sensor)n=t}),n},ne.prototype.nearestPointQuery=function(t,e,i,n,r){var o=function(o){if((!o.group||n!==o.group)&&i&o.layers){var s=o.nearestPointQuery(t);if(s.d<e)r(o,s.d,s.p)}},s=Y(t,e);this.lock(),this.activeShapes.query(s,o),this.staticShapes.query(s,o),this.unlock(!0)},ne.prototype.nearestPointQueryNearest=function(t,e,i,n){var r,o=function(o){if((!o.group||n!==o.group)&&i&o.layers&&!o.sensor){var s=o.nearestPointQuery(t);if(s.d<e&&(!r||s.d<r.d))r=s}},s=Y(t,e);return this.activeShapes.query(s,o),this.staticShapes.query(s,o),r},ne.prototype.segmentQuery=function(t,e,i,n,r){var o=function(o){var s;if((!o.group||n!==o.group)&&i&o.layers&&(s=o.segmentQuery(t,e)))r(o,s.t,s.n);return 1};this.lock(),this.staticShapes.segmentQuery(t,e,1,o),this.activeShapes.segmentQuery(t,e,1,o),this.unlock(!0)},ne.prototype.segmentQueryFirst=function(t,e,i,n){var r=null,o=function(o){var s;if((!o.group||n!==o.group)&&i&o.layers&&!o.sensor&&(s=o.segmentQuery(t,e))&&(null===r||s.t<r.t))r=s;return r?r.t:1};return this.staticShapes.segmentQuery(t,e,1,o),this.activeShapes.segmentQuery(t,e,r?r.t:1,o),r},ne.prototype.bbQuery=function(t,e,i,n){var r=function(r){if((!r.group||i!==r.group)&&e&r.layers&&X(t,r.bb_l,r.bb_b,r.bb_r,r.bb_t))n(r)};this.lock(),this.activeShapes.query(t,r),this.staticShapes.query(t,r),this.unlock(!0)},ne.prototype.shapeQuery=function(t,e){var i=t.body;if(i)t.update(i.p,i.rot);var n=new G(t.bb_l,t.bb_b,t.bb_r,t.bb_t),r=!1,o=function(i){var n=t;if((!n.group||n.group!==i.group)&&n.layers&i.layers&&n!==i){var o;if(n.collisionCode<=i.collisionCode)o=ee(n,i);else{o=ee(i,n);for(var s=0;s<o.length;s++)o[s].n=O(o[s].n)}if(o.length)if(r=!(n.sensor||i.sensor),e){for(var c=new Array(o.length),s=0;s<o.length;s++)c[s]=new Bt(o[s].p,o[s].n,o[s].dist);e(i,c)}}};return this.lock(),this.activeShapes.query(n,o),this.staticShapes.query(n,o),this.unlock(!0),r},ne.prototype.addPostStepCallback=function(t){s(this.locked,"Adding a post-step callback when the space is not locked is unnecessary. Post-step callbacks will not called until the end of the next call to cpSpaceStep() or the next query."),this.postStepCallbacks.push(t)},ne.prototype.runPostStepCallbacks=function(){for(var t=0;t<this.postStepCallbacks.length;t++)this.postStepCallbacks[t]();this.postStepCallbacks=[]},ne.prototype.lock=function(){this.locked++},ne.prototype.unlock=function(t){if(this.locked--,o(this.locked>=0,"Internal Error: Space lock underflow."),0===this.locked&&t){for(var e=this.rousedBodies,i=0;i<e.length;i++)this.activateBody(e[i]);e.length=0,this.runPostStepCallbacks()}},ne.prototype.makeCollideShapes=function(){var t=this;return function(e,i){var n=t;if(e.bb_l<=i.bb_r&&i.bb_l<=e.bb_r&&e.bb_b<=i.bb_t&&i.bb_b<=e.bb_t&&e.body!==i.body&&(!e.group||e.group!==i.group)&&e.layers&i.layers){var r=n.lookupHandler(e.collision_type,i.collision_type),o=e.sensor||i.sensor;if(!o||r!==ie){if(e.collisionCode>i.collisionCode){var s=e;e=i,i=s}var c=ee(e,i);if(0!==c.length){var a=h(e.hashid,i.hashid),l=n.cachedArbiters[a];if(!l)l=n.cachedArbiters[a]=new Mt(e,i);if(l.update(c,r,e,i),"first coll"==l.state&&!r.begin(l,n))l.ignore();if("ignore"!==l.state&&r.preSolve(l,n)&&!o)n.arbiters.push(l);else if(l.contacts=null,"ignore"!==l.state)l.state="normal";l.stamp=n.stamp}}}}},ne.prototype.arbiterSetFilter=function(t){var e=this.stamp-t.stamp,i=t.body_a,n=t.body_b;if((i.isStatic()||i.isSleeping())&&(n.isStatic()||n.isSleeping()))return!0;if(e>=1&&"cached"!=t.state)t.callSeparate(this),t.state="cached";if(e>=this.collisionPersistence)return t.contacts=null,!1;else return!0};var le=function(t){var e=t.body;t.update(e.p,e.rot)};ne.prototype.step=function(t){if(0!==t){o(0===b.x&&0===b.y,"vzero is invalid"),this.stamp++;var e=this.curr_dt;this.curr_dt=t;var i,n,r,s=this.bodies,c=this.constraints,a=this.arbiters;for(i=0;i<a.length;i++){var h=a[i];if(h.state="normal",!h.body_a.isSleeping()&&!h.body_b.isSleeping())h.unthread()}for(a.length=0,this.lock(),i=0;i<s.length;i++)s[i].position_func(t);this.activeShapes.each(le),this.activeShapes.reindexQuery(this.collideShapes),this.unlock(!1),this.processComponents(t),this.lock();for(r in this.cachedArbiters)if(!this.arbiterSetFilter(this.cachedArbiters[r]))delete this.cachedArbiters[r];var l=this.collisionSlop,u=1-Math.pow(this.collisionBias,t);for(i=0;i<a.length;i++)a[i].preStep(t,l,u);for(i=0;i<c.length;i++){var f=c[i];f.preSolve(this),f.preStep(t)}var d=Math.pow(this.damping,t),p=this.gravity;for(i=0;i<s.length;i++)s[i].velocity_func(p,d,t);var _=0===e?0:t/e;for(i=0;i<a.length;i++)a[i].applyCachedImpulse(_);for(i=0;i<c.length;i++)c[i].applyCachedImpulse(_);for(i=0;i<this.iterations;i++){for(n=0;n<a.length;n++)a[n].applyImpulse();for(n=0;n<c.length;n++)c[n].applyImpulse()}for(i=0;i<c.length;i++)c[i].postSolve(this);for(i=0;i<a.length;i++)a[i].handler.postSolve(a[i],this);this.unlock(!0)}};var ue=function(t,e,i,n){var r=t.vx+-i.y*t.w,o=t.vy+i.x*t.w,s=e.vx+-n.y*e.w,c=e.vy+n.x*e.w;return new y(s-r,c-o)},fe=function(t,e,i,n,r){var o=t.vx+-i.y*t.w,s=t.vy+i.x*t.w,c=e.vx+-n.y*e.w,a=e.vy+n.x*e.w;return C(c-o,a-s,r.x,r.y)},de=function(t,e,i,n){t.vx+=e*t.m_inv,t.vy+=i*t.m_inv,t.w+=t.i_inv*(n.x*i-n.y*e)},pe=function(t,e,i,n,r,o){de(t,-r,-o,i),de(e,r,o,n)},_e=function(t,e,i,n){t.v_biasx+=e*t.m_inv,t.v_biasy+=i*t.m_inv,t.w_bias+=t.i_inv*w(n.x,n.y,e,i)},ge=function(t,e,i){var n=I(e,i);return t.m_inv+t.i_inv*n*n},ve=function(t,e,i,n,r){var o=ge(t,i,r)+ge(e,n,r);return s(0!==o,"Unsolvable collision or constraint."),o},me=function(t,e,i,n,r,o){var c,a,h,l,u=t.m_inv+e.m_inv;c=u,a=0,h=0,l=u;var f=t.i_inv,d=i.x*i.x*f,p=i.y*i.y*f,_=-i.x*i.y*f;c+=p,a+=_,h+=_,l+=d;var g=e.i_inv,v=n.x*n.x*g,m=n.y*n.y*g,y=-n.x*n.y*g;c+=m,a+=y,h+=y,l+=v;var b=c*l-a*h;s(0!==b,"Unsolvable constraint.");var T=1/b;r.x=l*T,r.y=-a*T,o.x=-h*T,o.y=c*T},ye=function(t,e,i){return new y(T(t,e),T(t,i))},be=function(t,e){return 1-Math.pow(t,e)},Te=cp.Constraint=function(t,e){this.a=t,this.b=e,this.space=null,this.next_a=null,this.next_b=null,this.maxForce=1/0,this.errorBias=Math.pow(.9,60),this.maxBias=1/0};Te.prototype.activateBodies=function(){if(this.a)this.a.activate();if(this.b)this.b.activate()},Te.prototype.preStep=function(t){},Te.prototype.applyCachedImpulse=function(t){},Te.prototype.applyImpulse=function(){},Te.prototype.getImpulse=function(){return 0},Te.prototype.preSolve=function(t){},Te.prototype.postSolve=function(t){},Te.prototype.next=function(t){return this.a===t?this.next_a:this.next_b};var Ce=cp.PinJoint=function(t,e,i,n){Te.call(this,t,e),this.anchr1=i,this.anchr2=n;var r=t?E(t.p,R(i,t.rot)):i,o=e?E(e.p,R(n,e.rot)):n;this.dist=A(x(o,r)),s(this.dist>0,"You created a 0 length pin joint. A pivot joint will be much more stable."),this.r1=this.r2=null,this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};Ce.prototype=Object.create(Te.prototype),Ce.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot);var n=x(E(i.p,this.r2),E(e.p,this.r1)),r=A(n);this.n=N(n,1/(r?r:1/0)),this.nMass=1/ve(e,i,this.r1,this.r2,this.n);var o=this.maxBias;this.bias=v(-be(this.errorBias,t)*(r-this.dist)/t,-o,o),this.jnMax=this.maxForce*t},Ce.prototype.applyCachedImpulse=function(t){var e=N(this.n,this.jnAcc*t);pe(this.a,this.b,this.r1,this.r2,e.x,e.y)},Ce.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=fe(t,e,this.r1,this.r2,i),r=(this.bias-n)*this.nMass,o=this.jnAcc;this.jnAcc=v(o+r,-this.jnMax,this.jnMax),r=this.jnAcc-o,pe(t,e,this.r1,this.r2,i.x*r,i.y*r)},Ce.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var Ae=cp.SlideJoint=function(t,e,i,n,r,o){Te.call(this,t,e),this.anchr1=i,this.anchr2=n,this.min=r,this.max=o,this.r1=this.r2=this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};Ae.prototype=Object.create(Te.prototype),Ae.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot);var n=x(E(i.p,this.r2),E(e.p,this.r1)),r=A(n),o=0;if(r>this.max)o=r-this.max,this.n=j(n);else if(r<this.min)o=this.min-r,this.n=O(j(n));else this.n=b,this.jnAcc=0;this.nMass=1/ve(e,i,this.r1,this.r2,this.n);var s=this.maxBias;this.bias=v(-be(this.errorBias,t)*o/t,-s,s),this.jnMax=this.maxForce*t},Ae.prototype.applyCachedImpulse=function(t){var e=this.jnAcc*t;pe(this.a,this.b,this.r1,this.r2,this.n.x*e,this.n.y*e)},Ae.prototype.applyImpulse=function(){if(0!==this.n.x||0!==this.n.y){var t=this.a,e=this.b,i=this.n,n=this.r1,r=this.r2,o=ue(t,e,n,r),s=T(o,i),c=(this.bias-s)*this.nMass,a=this.jnAcc;this.jnAcc=v(a+c,-this.jnMax,0),c=this.jnAcc-a,pe(t,e,this.r1,this.r2,i.x*c,i.y*c)}},Ae.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var Se=cp.PivotJoint=function(t,e,i,n){if(Te.call(this,t,e),"undefined"==typeof n){var r=i;i=t?t.world2Local(r):r,n=e?e.world2Local(r):r}this.anchr1=i,this.anchr2=n,this.r1=this.r2=b,this.k1=new y(0,0),this.k2=new y(0,0),this.jAcc=b,this.jMaxLen=0,this.bias=b};Se.prototype=Object.create(Te.prototype),Se.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot),me(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var n=x(E(i.p,this.r2),E(e.p,this.r1));this.bias=W(N(n,-be(this.errorBias,t)/t),this.maxBias)},Se.prototype.applyCachedImpulse=function(t){pe(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},Se.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,r=ue(t,e,i,n),o=ye(x(this.bias,r),this.k1,this.k2),s=this.jAcc;this.jAcc=W(E(this.jAcc,o),this.jMaxLen),pe(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},Se.prototype.getImpulse=function(){return A(this.jAcc)};var Ee=cp.GrooveJoint=function(t,e,i,n,r){Te.call(this,t,e),this.grv_a=i,this.grv_b=n,this.grv_n=P(z(x(n,i))),this.anchr2=r,this.grv_tn=null,this.clamp=0,this.r1=this.r2=null,this.k1=new y(0,0),this.k2=new y(0,0),this.jAcc=b,this.jMaxLen=0,this.bias=null};Ee.prototype=Object.create(Te.prototype),Ee.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.local2World(this.grv_a),r=e.local2World(this.grv_b),o=R(this.grv_n,e.rot),s=T(n,o);this.grv_tn=o,this.r2=R(this.anchr2,i.rot);var c=I(E(i.p,this.r2),o);if(c<=I(n,o))this.clamp=1,this.r1=x(n,e.p);else if(c>=I(r,o))this.clamp=-1,this.r1=x(r,e.p);else this.clamp=0,this.r1=x(E(N(P(o),-c),N(o,s)),e.p);me(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var a=x(E(i.p,this.r2),E(e.p,this.r1));this.bias=W(N(a,-be(this.errorBias,t)/t),this.maxBias)},Ee.prototype.applyCachedImpulse=function(t){pe(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},Ee.prototype.grooveConstrain=function(t){var e=this.grv_tn,i=this.clamp*I(t,e)>0?t:L(t,e);return W(i,this.jMaxLen)},Ee.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,r=ue(t,e,i,n),o=ye(x(this.bias,r),this.k1,this.k2),s=this.jAcc;this.jAcc=this.grooveConstrain(E(s,o)),pe(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},Ee.prototype.getImpulse=function(){return A(this.jAcc)},Ee.prototype.setGrooveA=function(t){this.grv_a=t,this.grv_n=P(z(x(this.grv_b,t))),this.activateBodies()},Ee.prototype.setGrooveB=function(t){this.grv_b=t,this.grv_n=P(z(x(t,this.grv_a))),this.activateBodies()};var xe=function(t,e){return(t.restLength-e)*t.stiffness},Oe=cp.DampedSpring=function(t,e,i,n,r,o,s){Te.call(this,t,e),this.anchr1=i,this.anchr2=n,this.restLength=r,this.stiffness=o,this.damping=s,this.springForceFunc=xe,this.target_vrn=this.v_coef=0,this.r1=this.r2=null,this.nMass=0,this.n=null};Oe.prototype=Object.create(Te.prototype),Oe.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot);var n=x(E(i.p,this.r2),E(e.p,this.r1)),r=A(n);this.n=N(n,1/(r?r:1/0));var o=ve(e,i,this.r1,this.r2,this.n);s(0!==o,"Unsolvable this."),this.nMass=1/o,this.target_vrn=0,this.v_coef=1-Math.exp(-this.damping*t*o);var c=this.springForceFunc(this,r);pe(e,i,this.r1,this.r2,this.n.x*c*t,this.n.y*c*t)},Oe.prototype.applyCachedImpulse=function(t){},Oe.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=this.r1,r=this.r2,o=fe(t,e,n,r,i),s=(this.target_vrn-o)*this.v_coef;this.target_vrn=o+s,s*=this.nMass,pe(t,e,this.r1,this.r2,this.n.x*s,this.n.y*s)},Oe.prototype.getImpulse=function(){return 0};var Ne=function(t,e){return(e-t.restAngle)*t.stiffness},Ie=cp.DampedRotarySpring=function(t,e,i,n,r){Te.call(this,t,e),this.restAngle=i,this.stiffness=n,this.damping=r,this.springTorqueFunc=Ne,this.target_wrn=0,this.w_coef=0,this.iSum=0};Ie.prototype=Object.create(Te.prototype),Ie.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.i_inv+i.i_inv;s(0!==n,"Unsolvable spring."),this.iSum=1/n,this.w_coef=1-Math.exp(-this.damping*t*n),this.target_wrn=0;var r=this.springTorqueFunc(this,e.a-i.a)*t;e.w-=r*e.i_inv,i.w+=r*i.i_inv},Ie.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=t.w-e.w,n=(this.target_wrn-i)*this.w_coef;this.target_wrn=i+n;var r=n*this.iSum;t.w+=r*t.i_inv,e.w-=r*e.i_inv};var we=cp.RotaryLimitJoint=function(t,e,i,n){Te.call(this,t,e),this.min=i,this.max=n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};we.prototype=Object.create(Te.prototype),we.prototype.preStep=function(t){var e=this.a,i=this.b,n=i.a-e.a,r=0;if(n>this.max)r=this.max-n;else if(n<this.min)r=this.min-n;this.iSum=1/(1/e.i+1/i.i);var o=this.maxBias;if(this.bias=v(-be(this.errorBias,t)*r/t,-o,o),this.jMax=this.maxForce*t,!this.bias)this.jAcc=0},we.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},we.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=-(this.bias+i)*this.iSum,r=this.jAcc;if(this.bias<0)this.jAcc=v(r+n,0,this.jMax);else this.jAcc=v(r+n,-this.jMax,0);n=this.jAcc-r,t.w-=n*t.i_inv,e.w+=n*e.i_inv}},we.prototype.getImpulse=function(){return Math.abs(joint.jAcc)};var Pe=cp.RatchetJoint=function(t,e,i,n){Te.call(this,t,e),this.angle=0,this.phase=i,this.ratchet=n,this.angle=(e?e.a:0)-(t?t.a:0),this.iSum=this.bias=this.jAcc=this.jMax=0};Pe.prototype=Object.create(Te.prototype),Pe.prototype.preStep=function(t){var e=this.a,i=this.b,n=this.angle,r=this.phase,o=this.ratchet,s=i.a-e.a,c=n-s,a=0;if(c*o>0)a=c;else this.angle=Math.floor((s-r)/o)*o+r;this.iSum=1/(e.i_inv+i.i_inv);var h=this.maxBias;if(this.bias=v(-be(this.errorBias,t)*a/t,-h,h),this.jMax=this.maxForce*t,!this.bias)this.jAcc=0},Pe.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Pe.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=this.ratchet,r=-(this.bias+i)*this.iSum,o=this.jAcc;this.jAcc=v((o+r)*n,0,this.jMax*Math.abs(n))/n,r=this.jAcc-o,t.w-=r*t.i_inv,e.w+=r*e.i_inv}},Pe.prototype.getImpulse=function(t){return Math.abs(t.jAcc)};var Le=cp.GearJoint=function(t,e,i,n){Te.call(this,t,e),this.phase=i,this.ratio=n,this.ratio_inv=1/n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Le.prototype=Object.create(Te.prototype),Le.prototype.preStep=function(t){var e=this.a,i=this.b;this.iSum=1/(e.i_inv*this.ratio_inv+this.ratio*i.i_inv);var n=this.maxBias;this.bias=v(-be(this.errorBias,t)*(i.a*this.ratio-e.a-this.phase)/t,-n,n),this.jMax=this.maxForce*t},Le.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv*this.ratio_inv,i.w+=n*i.i_inv},Le.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w*this.ratio-t.w,n=(this.bias-i)*this.iSum,r=this.jAcc;this.jAcc=v(r+n,-this.jMax,this.jMax),n=this.jAcc-r,t.w-=n*t.i_inv*this.ratio_inv,e.w+=n*e.i_inv},Le.prototype.getImpulse=function(){return Math.abs(this.jAcc)},Le.prototype.setRatio=function(t){this.ratio=t,this.ratio_inv=1/t,this.activateBodies()};var Re=cp.SimpleMotor=function(t,e,i){Te.call(this,t,e),this.rate=i,this.jAcc=0,this.iSum=this.jMax=0};Re.prototype=Object.create(Te.prototype),Re.prototype.preStep=function(t){this.iSum=1/(this.a.i_inv+this.b.i_inv),this.jMax=this.maxForce*t},Re.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Re.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w-t.w+this.rate,n=-i*this.iSum,r=this.jAcc;this.jAcc=v(r+n,-this.jMax,this.jMax),n=this.jAcc-r,t.w-=n*t.i_inv,
e.w+=n*e.i_inv},Re.prototype.getImpulse=function(){return Math.abs(this.jAcc)}},{}],116:[function(require,module,exports){"use strict";cc.initEngine=function(t,e){if(require("script/jsb.js"),cc._renderType=cc.game.RENDER_TYPE_OPENGL,cc._initDebugSetting(t[cc.game.CONFIG_KEY.debugMode]),cc._engineLoaded=!0,cc.log(cc.ENGINE_VERSION),e)e()};try{var originLog=console.log;console.log=function(){originLog.call(console,cc.js.formatStr.apply(null,arguments))}}catch(e){}eval('if(typeof CC_TEST=="undefined")window.CC_TEST=typeof describe!="undefined"||typeof QUnit=="object";if(typeof CC_EDITOR=="undefined")window.CC_EDITOR=typeof Editor=="object"&&typeof process=="object"&&"electron" in process.versions;if(typeof CC_DEV=="undefined")window.CC_DEV=CC_EDITOR||CC_TEST;if(typeof CC_JSB=="undefined")window.CC_JSB=true;'),require("./jsb-predefine"),require("./jsb-loader"),require("./jsb-game"),require("./jsb-director"),require("./jsb-tex-sprite-frame"),require("./jsb-scale9sprite"),require("./jsb-label"),require("./jsb-editbox"),require("./jsb-particle"),require("./jsb-spine"),require("./jsb-enums"),require("./jsb-event"),require("./jsb-action"),require("./jsb-etc");var _engineNumberVersion=function(){var t=/Cocos2d\-JS\sv([\d]+)\.([\d]+)/.exec(cc.ENGINE_VERSION);if(t&&t[1])return{major:parseInt(t[1]),minor:parseInt(t[2])};else return null}();if(_engineNumberVersion)if(3===_engineNumberVersion.major){if(_engineNumberVersion.minor<6)require("./versions/jsb-polyfill-v3.5");if(_engineNumberVersion.minor<9)require("./versions/jsb-polyfill-v3.8");if(_engineNumberVersion.minor<10)require("./versions/jsb-polyfill-v3.9")}},{"./jsb-action":117,"./jsb-director":118,"./jsb-editbox":119,"./jsb-enums":120,"./jsb-etc":121,"./jsb-event":122,"./jsb-game":123,"./jsb-label":124,"./jsb-loader":125,"./jsb-particle":126,"./jsb-predefine":127,"./jsb-scale9sprite":128,"./jsb-spine":129,"./jsb-tex-sprite-frame":130,"./versions/jsb-polyfill-v3.5":131,"./versions/jsb-polyfill-v3.8":132,"./versions/jsb-polyfill-v3.9":133,"script/jsb.js":void 0}],117:[function(t,e,i){function n(t){var e=t._ctor;t._ctor=function(){e.apply(this,arguments),this.retain(),this._retained=!0}}function r(t,e){var i=t[0].toLowerCase()+t.substr(1);cc[i]=function(){var t=e.create.apply(this,arguments);return t.retain(),t._retained=!0,t}}function o(t,e){var i=t[e];t[e]=function(){if(this._retained)this.release(),this._retained=!1;var t=i.apply(this,arguments);return t.retain(),t._retained=!0,t}}function s(t){if(t instanceof cc.Component)t=t.node._sgNode;else if(t instanceof cc.Node)t=t._sgNode;else if(!(t instanceof _ccsg.Node))t=null;return t}function c(t,e){var i=cc.ActionManager.prototype,n=i[t];i[t]=function(){if(arguments[e]=s(arguments[e]),arguments[e])return n.apply(this,arguments);else;}}function a(t){this._jsbUpdate(t);var e=this.getTarget();if(e._owner)e._owner.x=e.getPositionX(),e._owner.y=e.getPositionY()}function h(t){this._jsbUpdate(t);var e=this.getTarget();if(e._owner)e._owner.rotation=e.getRotation()}function l(t){this._jsbUpdate(t);var e=this.getTarget();if(e._owner)e._owner.scaleX=e.getScaleX(),e._owner.scaleY=e.getScaleY()}function u(t){this._jsbUpdate(t);var e=this.getTarget();if(e._owner)e._owner.removeFromParent()}function f(t){this._jsbUpdate(t);var e=this.getTarget();if(e._owner)e._owner.skewX=e.getSkewX(),e._owner.skewY=e.getSkewY()}function d(t){this._jsbUpdate(t);var e=this.getTarget();if(e._owner)e._owner.color=e.getColor()}for(var p=["ActionEase","EaseExponentialIn","EaseExponentialOut","EaseExponentialInOut","EaseSineIn","EaseSineOut","EaseSineInOut","EaseBounce","EaseBounceIn","EaseBounceOut","EaseBounceInOut","EaseBackIn","EaseBackOut","EaseBackInOut","EaseRateAction","EaseIn","EaseElastic","EaseElasticIn","EaseElasticOut","EaseElasticInOut","RemoveSelf","FlipX","FlipY","Place","CallFunc","DelayTime","Sequence","Spawn","Speed","Repeat","RepeatForever","Follow","TargetedAction","Animate","OrbitCamera","GridAction","ProgressTo","ProgressFromTo","ActionInterval","RotateTo","RotateBy","MoveBy","MoveTo","SkewTo","SkewBy","JumpTo","JumpBy","ScaleTo","ScaleBy","Blink","FadeTo","FadeIn","FadeOut","TintTo","TintBy"],_=0;_<p.length;++_){var g=p[_],v=cc[g];if(v){var m=v.prototype;if(n(m),-1===g.indexOf("Ease"))r(g,v)}else;}o(cc.ActionInterval.prototype,"repeat"),o(cc.ActionInterval.prototype,"repeatForever"),o(cc.ActionInterval.prototype,"easing");var y=cc.Node.prototype.runAction;cc.Node.prototype.runAction=function(t){if(y.call(this,t),t._retained)t.release(),t._retained=!1};var b=cc.ActionManager.prototype.addAction;cc.ActionManager.prototype.addAction=function(t,e,i){if(e=s(e))if(b.call(this,t,e,i),t._retained)t.release(),t._retained=!1};for(var T=[["removeAllActionsFromTarget",0],["removeActionByTag",1],["getActionByTag",1],["numberOfRunningActionsInTarget",0],["pauseTarget",0],["resumeTarget",0]],_=0;_<T.length;++_)c.apply(null,T[_]);cc.ActionManager.prototype.resumeTargets=function(t){if(t)for(var e=0;e<t.length;e++)if(t[e])this.resumeTarget(t[e])},cc.ActionManager.prototype.pauseTargets=function(t){if(t)for(var e=0;e<t.length;e++)if(t[e])this.pauseTarget(t[e])};var C={MoveTo:a,MoveBy:a,JumpTo:a,JumpBy:a,Place:a,RotateTo:h,RotateBy:h,ScaleTo:l,ScaleBy:l,RemoveSelf:u,SkewTo:f,SkewBy:f,TintTo:d,TintBy:d};for(var A in C){var S=cc[A];S.prototype._jsbUpdate=S.prototype.update,S.prototype.update=C[A]}},{}],118:[function(t,e,i){"use strict";cc.js.mixin(cc.director,{sharedInit:function(){if(cc.AnimationManager)this._animationManager=new cc.AnimationManager,this.getScheduler().scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1);else this._animationManager=null;cc._widgetManager.init(this)},reset:function(){if(this.purgeDirector(),cc.eventManager)cc.eventManager.setEnabled(!0);var t=this.getActionManager();if(t)this.getScheduler().scheduleUpdate(t,cc.Scheduler.PRIORITY_SYSTEM,!1);if(this._animationManager)this.getScheduler().scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1);this.startAnimation()},getAnimationManager:function(){return this._animationManager},getScene:function(){return this._scene},runSceneImmediate:function(t,e,i){var n,r,o=cc.game,s=o._persistRootNodes;if(t instanceof cc.Scene)t._load();for(n in s)r=s[n],o._ignoreRemovePersistNode=r,r.parent=null,o._ignoreRemovePersistNode=null;var c=this._scene;if(cc.isValid(c))c.destroy();if(this._scene=null,cc.Object._deferredDestroy(),e)e();this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,t);var a=t;if(t instanceof cc.Scene){this._scene=t,a=t._sgNode;for(n in s){r=s[n];var h=t.getChildByUuid(n);if(h)s[n]=h,h._persistNode=!0;else r.parent=t}t._activate()}if(!this.getRunningScene())this.runWithScene(a);else this.replaceScene(a);if(i)i(null,t);this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,t)},runScene:function(t,e,i){if(cc.assert(t,cc._LogInfos.Director.pushScene),t instanceof cc.Scene)t._load();this.once(cc.Director.EVENT_AFTER_DRAW,function(){this.runSceneImmediate(t,e,i)})},loadScene:function(t,e,i){var n,r;if(this._loadingScene)return cc.error('[loadScene] Failed to load scene "%s" because "%s" is already loading',t,this._loadingScene),!1;if("string"==typeof t){if(!t.endsWith(".fire"))t+=".fire";if("/"!==t[0]&&!t.startsWith("db://assets/"))t="/"+t;for(var o=0;o<cc.game._sceneInfos.length;o++){r=cc.game._sceneInfos[o];var s=r.url;if(s.endsWith(t)){n=r.uuid;break}}}else if(r=cc.game._sceneInfos[t],"object"==typeof r)n=r.uuid;else return cc.error("[loadScene] The scene index to load (%s) is out of range.",t),!1;if(n)return this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),this._loadingScene=t,this._loadSceneByUuid(n,e,i),!0;else return cc.error('[loadScene] Can not load the scene "%s" because it has not been added to the build settings before play.',t),!1},_loadSceneByUuid:function(t,e,i){cc.AssetLibrary.loadAsset(t,function(n,r){var o=cc.director;o._loadingScene="";var s;if(n){if(n="Failed to load scene: "+n,cc.error(n),!1)console.assert(!1,n)}else if(s=r.scene,s instanceof cc.Scene)s._id=r._uuid,o.runScene(s,i,e);else n="The asset "+t+" is not a scene",cc.error(n),s=null;if(n&&e)e(n)})}}),cc.EventTarget.call(cc.director),cc.js.addon(cc.director,cc.EventTarget.prototype),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.EVENT_BEFORE_VISIT="director_before_visit",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_BEFORE_UPDATE="director_before_update",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading",cc.Director.EVENT_BEFORE_SCENE_LAUNCH="director_before_scene_launch",cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch",cc.Director.EVENT_COMPONENT_UPDATE="director_component_update",cc.Director.EVENT_COMPONENT_LATE_UPDATE="director_component_late_update",cc.eventManager.addCustomListener(cc.Director.EVENT_BEFORE_UPDATE,function(){var t=1/60;cc.director.emit(cc.Director.EVENT_BEFORE_UPDATE),cc.director.emit(cc.Director.EVENT_COMPONENT_UPDATE,t)}),cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_UPDATE,function(){var t=1/60;cc.director.emit(cc.Director.EVENT_COMPONENT_LATE_UPDATE,t),cc.director.emit(cc.Director.EVENT_AFTER_UPDATE),cc.Object._deferredDestroy(),cc.director.emit(cc.Director.EVENT_BEFORE_VISIT,this)}),cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_VISIT,function(){cc.director.emit(cc.Director.EVENT_AFTER_VISIT,this)}),cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_DRAW,function(){cc.director.emit(cc.Director.EVENT_AFTER_DRAW,this)})},{}],119:[function(t,e,i){"use strict";var n=cc.EditBox.prototype;cc.defineGetterSetter(n,"font",null,n.setFont),cc.defineGetterSetter(n,"fontName",null,n.setFontName),cc.defineGetterSetter(n,"fontSize",null,n.setFontSize),cc.defineGetterSetter(n,"fontColor",null,n.setFontColor),cc.defineGetterSetter(n,"string",n.getString,n.setString),cc.defineGetterSetter(n,"maxLength",n.getMaxLength,n.setMaxLength),cc.defineGetterSetter(n,"placeholder",n.getPlaceHolder,n.setPlaceHolder),cc.defineGetterSetter(n,"placeholderFont",null,n.setPlaceholderFont),cc.defineGetterSetter(n,"placeholderFontName",null,n.setPlaceholderFontName),cc.defineGetterSetter(n,"placeholderFontSize",null,n.setPlaceholderFontSize),cc.defineGetterSetter(n,"placeholderFontColor",null,n.setPlaceholderFontColor),cc.defineGetterSetter(n,"inputFlag",null,n.setInputFlag),cc.defineGetterSetter(n,"delegate",null,n.setDelegate),cc.defineGetterSetter(n,"inputMode",null,n.setInputMode),cc.defineGetterSetter(n,"returnType",null,n.setReturnType),n._setMaxLength=n.setMaxLength,n.setMaxLength=function(t){if(-1==t)t=Number.MAX_VALUE;this._setMaxLength(t)},n.setLineHeight=function(){},n=null},{}],120:[function(t,e,i){"use strict";cc.ProgressTimer.Type=cc.Enum({RADIAL:0,BAR:1}),cc.EditBox.InputMode=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),cc.EditBox.InputFlag=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4}),cc.EditBox.KeyboardReturnType=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4}),cc.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),ccui.RelativeLayoutParameter.Type=cc.Enum({NONE:0,PARENT_TOP_LEFT:1,PARENT_TOP_CENTER_HORIZONTAL:2,PARENT_TOP_RIGHT:3,PARENT_LEFT_CENTER_VERTICAL:4,CENTER_IN_PARENT:5,PARENT_RIGHT_CENTER_VERTICAL:6,PARENT_LEFT_BOTTOM:7,PARENT_BOTTOM_CENTER_HORIZONTAL:8,PARENT_RIGHT_BOTTOM:9,LOCATION_ABOVE_LEFTALIGN:10,LOCATION_ABOVE_CENTER:11,LOCATION_ABOVE_RIGHTALIGN:12,LOCATION_LEFT_OF_TOPALIGN:13,LOCATION_LEFT_OF_CENTER:14,LOCATION_LEFT_OF_BOTTOMALIGN:15,LOCATION_RIGHT_OF_TOPALIGN:16,LOCATION_RIGHT_OF_CENTER:17,LOCATION_RIGHT_OF_BOTTOMALIGN:18,LOCATION_BELOW_LEFTALIGN:19,LOCATION_BELOW_CENTER:20,LOCATION_BELOW_RIGHTALIGN:21}),ccui.Layout.Type=cc.Enum({ABSOLUTE:0,LINEAR_VERTICAL:1,LINEAR_HORIZONTAL:2,RELATIVE:3}),ccui.LoadingBar.Type=cc.Enum({LEFT:0,RIGHT:1}),ccui.ScrollView.Dir=cc.Enum({NONE:0,VERTICAL:1,HORIZONTAL:2,BOTH:3})},{}],121:[function(t,e,i){"use strict";var n=/[^\.\/]+\/\.\.\//;cc.js.mixin(cc.path,{_normalize:function(t){var e=t=String(t);do e=t,t=t.replace(n,"");while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",_setEndWithSep:function(t,e){var i=cc.path.sep;if("undefined"==typeof e)e=!0;else if("string"==typeof e)i=e,e=!!e;var n=t[t.length-1],r="\\"===n||"/"===n;if(!r&&e)t+=i;else if(r&&!e)t=t.slice(0,-1);return t}}),cc.Scheduler.prototype.schedule=function(t,e,i,n,r,o){this.scheduleCallbackForTarget(e,t,i,n,r,o)},cc.Scheduler.prototype.scheduleUpdate=cc.Scheduler.prototype.scheduleUpdateForTarget,cc.Scheduler.prototype._unschedule=cc.Scheduler.prototype.unschedule,cc.Scheduler.prototype.unschedule=function(t,e){if("function"==typeof e){var i=e;e=t,t=i}this._unschedule(e,t)};var r=cc.Node.prototype;if(cc.defineGetterSetter(r,"arrivalOrder",r.getOrderOfArrival,r.setOrderOfArrival),cc.defineGetterSetter(r,"_parent",r.getParent,r.setParent),!cc.TextureCache.prototype._addImageAsync)cc.TextureCache.prototype._addImageAsync=cc.TextureCache.prototype.addImageAsync;cc.TextureCache.prototype.addImageAsync=function(t,e,i){var n=null;return cc.loader.load(t,function(t,r){if(t)r=null;if(e)e.call(i,r);n=r}),n},cc.TextureCache.prototype.addImage=function(t,e,i){if("function"==typeof e)return this.addImageAsync(t,e,i);else if(e)return this._addImage(t,e);else return this._addImage(t)};var o=0,s={},c=function(t){this._intervalId=o++,this._code=t};if(c.prototype.fun=function(){if(this._code){var t=this._code;if("string"==typeof t)Function(t)();else if("function"==typeof t)t.apply(null,this._args)}},window.setTimeout=function(t,e){var i=new c(t);if(arguments.length>2)i._args=Array.prototype.slice.call(arguments,2);var n=i.fun;return i.fun=function(){n.apply(this,arguments),clearTimeout(i._intervalId)},cc.director.getScheduler()._schedule(i.fun,i,e/1e3,0,0,!1,i._intervalId+""),s[i._intervalId]=i,i._intervalId},window.setInterval=function(t,e){var i=new c(t);if(arguments.length>2)i._args=Array.prototype.slice.call(arguments,2);return cc.director.getScheduler()._schedule(i.fun,i,e/1e3,cc.REPEAT_FOREVER,0,!1,i._intervalId+""),s[i._intervalId]=i,i._intervalId},window.clearInterval=function(t){var e=s[t];if(e)cc.director.getScheduler()._unschedule(e._intervalId+"",e),delete s[t]},window.clearTimeout=clearInterval,window.SocketIO)window.io=window.SocketIO;window._ccsg={Node:cc.Node,Scene:cc.Scene,Sprite:cc.Sprite,ParticleSystem:cc.ParticleSystem,Label:cc.Label,EditBox:cc.EditBox,TMXTiledMap:cc.TMXTiledMap,TMXLayer:cc.TMXLayer,MotionStreak:cc.MotionStreak},cc._Class=cc.Class,cc.formatStr=cc.js.formatStr},{}],122:[function(t,e,i){"use strict";cc.Event.NO_TYPE="no_type",cc.Event.NONE=0,cc.Event.CAPTURING_PHASE=1,cc.Event.AT_TARGET=2,cc.Event.BUBBLING_PHASE=3,cc.Event.prototype._getCurrentTarget=cc.Event.prototype.getCurrentTarget,cc.Event.prototype.getCurrentTarget=function(){return this.currentTarget||this._getCurrentTarget()},cc.Event.prototype._stopPropagation=cc.Event.prototype.stopPropagation,cc.Event.prototype.stopPropagation=function(){this._propagationStopped=!0,this._stopPropagation()},cc.Event.prototype._isStopped=cc.Event.prototype.isStopped,cc.Event.prototype.isStopped=function(){return this._propagationStopped||this._propagationImmediateStopped||this._isStopped()},cc.js.mixin(cc.Event.prototype,{type:"no_type",target:null,currentTarget:null,eventPhase:0,bubbles:!1,_defaultPrevented:!1,_propagationStopped:!1,_propagationImmediateStopped:!1,unuse:function(){this.type=cc.Event.NO_TYPE,this.target=null,this.currentTarget=null,this.eventPhase=cc.Event.NONE,this._defaultPrevented=!1,this._propagationStopped=!1,this._propagationImmediateStopped=!1},reuse:function(t,e){this.type=t,this.bubbles=e||!1},preventDefault:function(){this._defaultPrevented=!0},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0}}),cc.Event.EventCustom=function(t,e){this.target=null,this.currentTarget=null,this.eventPhase=0,this._defaultPrevented=!1,this._propagationStopped=!1,this._propagationImmediateStopped=!1,this.type=t,this.bubbles=e||!1,this.detail=null},cc.js.extend(cc.Event.EventCustom,cc.Event),cc.js.mixin(cc.Event.EventCustom.prototype,{setUserData:function(t){this.detail=t},getUserData:function(){return this.detail},getEventName:cc.Event.prototype.getType}),cc.eventManager.addListener=function(t,e){if(!(t instanceof cc.EventListener))t=cc.EventListener.create(t);if("number"==typeof e){if(0===e)return void cc.log("0 priority is forbidden for fixed priority since it's used for scene graph based priority.");cc.eventManager.addEventListenerWithFixedPriority(t,e)}else{var i=e;if(e instanceof cc.Component)i=e.node._sgNode;if(e instanceof cc.Node)i=e._sgNode;if(i!==e)for(var n=Object.keys(t),r=0;r<n.length;++r){var o=n[r],s=t[o];if("function"==typeof s)t[o]=function(t){return function(i,n){var r=n||i;if(r)r.target=e,r.currentTarget=e,r.bubbles=!1,r.eventPhase=0,r._defaultPrevented=!1,r._propagationStopped=!1,r._propagationImmediateStopped=!1;return t.call(this,i,n)}}(s)}cc.eventManager.addEventListenerWithSceneGraphPriority(t,i)}return t},cc.eventManager._removeListeners=cc.eventManager.removeListeners,cc.eventManager.removeListeners=function(t,e){if(t instanceof cc.Component)t=t.node._sgNode;if(t instanceof cc.Node)t=t._sgNode;else if(!(t instanceof _ccsg.Node))return;this._removeListeners(t,e||!1)},cc.eventManager._pauseTarget=cc.eventManager.pauseTarget,cc.eventManager.pauseTarget=function(t,e){var i=t;if(t._eventPaused=!0,t instanceof cc.Component)i=t.node._sgNode;else if(t instanceof cc.Node)i=t._sgNode;else if(!(i instanceof _ccsg.Node))return;if(i!==t&&!i.isRunning()){var n=i.onEnter;i.onEnter=function(){if(n.call(this),t._eventPaused)cc.eventManager._pauseTarget(this,e||!1);this.onEnter=n}}this._pauseTarget(i,e||!1)},cc.eventManager._resumeTarget=cc.eventManager.resumeTarget,cc.eventManager.resumeTarget=function(t,e){if(t._eventPaused=!1,t instanceof cc.Component)t=t.node._sgNode;if(t instanceof cc.Node)t=t._sgNode;else if(!(t instanceof _ccsg.Node))return;this._resumeTarget(t,e||!1)},cc.js.mixin(cc.EventTouch.prototype,{setLocation:function(t,e){this.touch&&this.touch.setTouchInfo(this.touch.getID(),t,e)},getLocation:function(){return this.touch?this.touch.getLocation():cc.v2()},getLocationInView:function(){return this.touch?this.touch.getLocationInView():cc.v2()},getPreviousLocation:function(){return this.touch?this.touch.getPreviousLocation():cc.v2()},getStartLocation:function(){return this.touch?this.touch.getStartLocation():cc.v2()},getID:function(){return this.touch?this.getID():null},getDelta:function(){return this.touch?this.touch.getDelta():cc.v2()},getDeltaX:function(){return this.touch?this.touch.getDelta().x:0},getDeltaY:function(){return this.touch?this.touch.getDelta().y:0},getLocationX:function(){return this.touch?this.touch.getLocationX():0},getLocationY:function(){return this.touch?this.touch.getLocationY():0}})},{}],123:[function(t,e,i){"use strict";cc.js.mixin(cc.game,{_paused:!1,_sceneInfos:[],_persistRootNodes:{},_ignoreRemovePersistNode:null,CONFIG_KEY:{width:"width",height:"height",engineDir:"engineDir",modules:"modules",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",registerSystemEvent:"registerSystemEvent",jsList:"jsList",scenes:"scenes"},pause:function(){this._paused=!0,cc.director.pause()},resume:function(){this._paused=!1,cc.director.resume()},isPaused:function(){return this._paused},prepare:function(t){var e=this,i=e.config,n=e.CONFIG_KEY;if(this._loadConfig(),!this._prepared){if(!this._prepareCalled)if(!cc._engineLoaded)cc.initEngine(this.config,function(){e.prepare(t)});else{this._prepareCalled=!0,cc.director.sharedInit();var r=i[n.jsList];if(r)cc.loader.load(r,function(i){if(i)throw new Error(JSON.stringify(i));if(e._prepared=!0,t)t()});else if(t)t()}}else if(t)t()},run:function(t,e){if("function"==typeof t)cc.game.onStart=t;else{if(t)cc.game.config=t;if("function"==typeof e)cc.game.onStart=e}cc.director.startAnimation(),this.prepare(cc.game.onStart&&cc.game.onStart.bind(cc.game))},addPersistRootNode:function(t){if(!(t instanceof cc.Node&&t._id))return void cc.warn("The target can not be made persist because it's not a cc.Node or it doesn't have _id property.");var e=t._id;if(!this._persistRootNodes[e]){var i=cc.director._scene;if(cc.isValid(i)){if(!t.parent)t.parent=i;else if(!(t.parent instanceof cc.Scene))return void cc.warn("The node can not be made persist because it's not under root node.");else if(t.parent!==i)return void cc.warn("The node can not be made persist because it's not in current scene.");this._persistRootNodes[e]=t,t._persistNode=!0}}},removePersistRootNode:function(t){if(t!==this._ignoreRemovePersistNode){var e=t._id||"";if(t===this._persistRootNodes[e])delete this._persistRootNodes[e],t._persistNode=!1}},isPersistRootNode:function(t){return t._persistNode},_loadConfig:function(){if(this.config)this._initConfig(this.config);else try{var t=jsb.fileUtils.getStringFromFile("project.json"),e=JSON.parse(t);this._initConfig(e||{})}catch(i){console.log("Failed to read or parse project.json"),this._initConfig({})}},_initConfig:function(t){var e=this.CONFIG_KEY;if("number"!=typeof t[e.debugMode])t[e.debugMode]=0;if("number"!=typeof t[e.frameRate])t[e.frameRate]=60;if("number"!=typeof t[e.renderMode])t[e.renderMode]=0;t[e.showFPS]=e.showFPS in t?!!t[e.showFPS]:!0,t[e.engineDir]=t[e.engineDir]||"frameworks/cocos2d-html5",this._sceneInfos=this._sceneInfos.concat(t[e.scenes]),cc.director.setDisplayStats(this.config[e.showFPS]),cc.director.setAnimationInterval(1/this.config[e.frameRate]),this.config=t}}),cc.EventTarget.call(cc.game),cc.js.addon(cc.game,cc.EventTarget.prototype)},{}],124:[function(t,e,i){"use strict";var n=cc.Label;if(!n.createWithTTF&&n.prototype.createWithTTF)n.createWithTTF=n.prototype.createWithTTF;if(n.prototype.setHorizontalAlign=n.prototype.setHorizontalAlignment,n.prototype.setVerticalAlign=n.prototype.setVerticalAlignment,!n.prototype.setBMFontSize)n.prototype.setBMFontSize=function(){};if(!n.prototype.getBMFontSize)n.prototype.getBMFontSize=function(){};if(!n.prototype.setOverflow)n.prototype.setOverflow=function(){};if(!n.prototype.getOverflow)n.prototype.getOverflow=function(){};if(n.prototype._setOverflow=n.prototype.setOverflow,n.prototype.setOverflow=function(t){this._overFlow=t,this._setOverflow(this._overFlow)},n.prototype.getOverflow=function(){return this._overFlow},!n.prototype.isSystemFontUsed)n.prototype.isSystemFontUsed=function(){return this._isSystemFontUsed},n.prototype.setSystemFontUsed=function(t){this._isSystemFontUsed=t,this.setSystemFontName("Arial"),this.setSystemFontSize(this.getFontSize())};n.prototype.setFontSize=function(t){if(this._fontSize=t,this._labelType===_ccsg.Label.Type.SystemFont)this.setSystemFontSize(t);else if(this._labelType===_ccsg.Label.Type.BMFont)this.setBMFontSize(t);else if(this._labelType===_ccsg.Label.Type.TTF){var e=this.getTTFConfig();e.fontSize=t,this.setTTFConfig(e)}},n.prototype.getFontSize=function(){return this._fontSize},n.prototype.enableWrapText=n.prototype.enableWrap||function(){},n.prototype.isWrapTextEnabled=n.prototype.isWrapEnabled||function(){},n.prototype._setLineHeight=n.prototype.setLineHeight,n.prototype.setLineHeight=function(t){if(this._labelType!==_ccsg.Label.Type.SystemFont)this._setLineHeight(t)},n.prototype._setTTFConfig=n.prototype.setTTFConfig,n.prototype.setTTFConfig=function(t){this._setTTFConfig(t),this._ttfConfig=t},n.prototype.getTTFConfig=function(){return this._ttfConfig},n.prototype.setContentSize=function(t,e){var i="number"==typeof t.width?t.width:t,n="number"==typeof t.height?t.height:e;if(this.getOverflow()===cc.Label.Overflow.NONE)i=0,n=0;this.setDimensions(i,n)},n.prototype.setFontFileOrFamily=function(t){t=t||"";var e=cc.path.extname(t);if(!e)this._labelType=_ccsg.Label.Type.SystemFont,this.setSystemFontName(t),this._isSystemFontUsed=!0;else if(".ttf"===e)this._labelType=_ccsg.Label.Type.TTF,this._ttfConfig.fontFilePath=t,this.setTTFConfig(this._ttfConfig);else if(".fnt"===e)this._labelType=_ccsg.Label.Type.BMFont,this.setBMFontFilePath(t),this.setFontSize(this.getFontSize());this.getContentSize()},cc.Label=function(t,e){e=e||"Arial";var i,r=cc.path.extname(e),o=_ccsg.Label.Type.TTF;if(".ttf"===r){var s={fontFilePath:e,fontSize:40,outlineSize:0,glyphs:0,customGlyphs:"",distanceFieldEnable:!1};i=n.createWithTTF(s,t,40),i._ttfConfig=s}else if(".fnt"===r)i=n.createWithBMFont(e,t),o=_ccsg.Label.Type.BMFont;else i=n.createWithSystemFont(t||"",e,40),o=_ccsg.Label.Type.SystemFont,i._isSystemFontUsed=!0;return i._labelType=o,i},cc.Label.Type=cc.Enum({TTF:0,BMFont:1,SystemFont:2}),cc.Label.Overflow=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3})},{}],125:[function(t,e,i){"use strict";function n(t,e){e(null,null)}function r(e,i){var n=e.url;t(n),i(null,n)}function o(t,e){var i=t.url,n=jsb.fileUtils.getStringFromFile(i);if("string"==typeof n&&n)e(null,n);else e(new Error("Download text failed: "+i))}function s(t,e){e(null,t.url)}function c(t,e){var i=t.url,n=cc.textureCache.getTextureForKey(i);if(n)e&&e(null,n);else if(i.match(jsb.urlRegExp))jsb.loadRemoteImg(i,function(t,n){if(t)e&&e(null,n);else e&&e(new Error("Load image failed: "+i))});else cc.textureCache._addImageAsync(i,function(t){if(t instanceof cc.Texture2D)e&&e(null,t);else e&&e(new Error("Load image failed: "+i))})}t("../cocos2d/core/load-pipeline"),cc.loader.addDownloadHandlers({js:r,jsc:r,png:n,jpg:n,bmp:n,jpeg:n,gif:n,ico:n,tiff:n,webp:n,image:n,mp3:s,ogg:s,wav:s,mp4:s,m4a:s,txt:o,xml:o,vsh:o,fsh:o,atlas:o,tmx:o,tsx:o,json:o,ExportJson:o,plist:o,fnt:o,font:n,eot:n,ttf:n,woff:n,svg:n,ttc:n,"default":o}),cc.loader.addLoadHandlers({png:c,jpg:c,bmp:c,jpeg:c,gif:c,ico:c,tiff:c,webp:c,image:c,"default":n})},{"../cocos2d/core/load-pipeline":62}],126:[function(t,e,i){"use strict";function n(t,e){return function(i){if(this.getEmitterMode()===e)t.call(this,i)}}cc.ParticleSystem.Mode=cc.Enum({GRAVITY:0,RADIUS:1}),cc.ParticleSystem.Type=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2});for(var r=[{tangentialAccel:"setTangentialAccel",tangentialAccelVar:"setTangentialAccelVar",radialAccel:"setRadialAccel",radialAccelVar:"setRadialAccelVar",rotationIsDir:"setRotationIsDir",gravity:"setGravity",speed:"setSpeed",speedVar:"setSpeedVar"},{startRadius:"setStartRadius",startRadiusVar:"setStartRadiusVar",endRadius:"setEndRadius",endRadiusVar:"setEndRadiusVar",rotatePerS:"setRotatePerSecond",rotatePerSVar:"setRotatePerSecondVar"}],o=cc.ParticleSystem.prototype,s=0;s<r.length;s++){var c=r[s];for(var a in c){var h=c[a],l=o[h];o[h]=n(l,s);var u=h.replace("set","get");cc.defineGetterSetter(o,a,o[u],o[h])}}},{}],127:[function(t,e,i){if(cc.initEngine({debugMode:cc.game.DEBUG_MODE_INFO}),!cc.ClassManager)cc.ClassManager=window.ClassManager||{id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};if(!1)cc._Test={};t("../cocos2d/core/platform/js"),t("../cocos2d/core/value-types"),t("../cocos2d/core/utils/find"),t("../cocos2d/core/event"),t("../CCDebugger")},{"../CCDebugger":1,"../cocos2d/core/event":57,"../cocos2d/core/platform/js":80,"../cocos2d/core/utils/find":90,"../cocos2d/core/value-types":103}],128:[function(t,e,i){"use strict";var n=!1;if(cc.Scale9SpriteV2)n=!0,cc.Scale9Sprite=cc.Scale9SpriteV2;cc.Scale9Sprite.state={NORMAL:0,GRAY:1},cc.Scale9Sprite.RenderingType=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3}),cc.Scale9Sprite.FillType=cc.Enum({Horizontal:0,Vertical:1,RADIAL:2});var r=cc.Scale9Sprite.prototype;if(n){var o=r.setContentSize;r.setContentSize=function(t,e){if(void 0!==e)t=new cc.Size(t,e);o.call(this,t)};var s=r.setAnchorPoint;r.setAnchorPoint=function(t,e){if(void 0!==e)t=new cc.Vec2(t,e);s.call(this,t)}}else r.setFillType=function(){},r.setFillCenter=function(){},r.setFillStart=function(){},r.setFillRange=function(){},r.enableTrimmedContentSize=function(){},r._lazyInit=function(){if(!this._onceInit)this._onceInit=!0,this._insets={left:0,right:0,top:0,bottom:0},this._trim={left:0,right:0,top:0,bottom:0},this._contentSizeTrimmed=new cc.Size(0,0),this._anchorPointTrimmed=new cc.Vec2(0,0),this._sizeAfterTrimmed=new cc.Size(0,0)},r._applyInsetsContentAnchor=function(){var t=this._renderingType||this.getRenderingType&&this.getRenderingType(),e=1,i=1;if(t===cc.Scale9Sprite.RenderingType.SIMPLE)e=this._contentSizeTrimmed.width/this._sizeAfterTrimmed.width,i=this._contentSizeTrimmed.height/this._sizeAfterTrimmed.height;var n=new cc.Size(0,0);n.width=this._contentSizeTrimmed.width+(this._trim.left+this._trim.right)*e,n.height=this._contentSizeTrimmed.height+(this._trim.top+this._trim.bottom)*i,this._setContentSize(n);var r=new cc.Vec2(0,0);r.x=this._contentSizeTrimmed.width*this._anchorPointTrimmed.x+this._trim.left*e,r.y=this._contentSizeTrimmed.height*this._anchorPointTrimmed.y+this._trim.bottom*i,r.x=r.x/n.width,r.y=r.y/n.height,this._setAnchorPoint(r);var o=new cc.Rect(0,0,0,0);o.x=this._trim.left+this._insets.left,o.y=this._trim.top+this._insets.top,o.width=this._sizeAfterTrimmed.width-this._insets.left-this._insets.right,o.height=this._sizeAfterTrimmed.height-this._insets.top-this._insets.bottom,this.setCapInsets(o)},r._setBlendFunc=r.setBlendFunc,r.setBlendFunc=function(t,e){if(void 0!==e)t={src:t,dst:e};if(this._setBlendFunc)this._setBlendFunc(t)},r._getContentSize=r.getContentSize,r.getContentSize=function(){return new cc.Size(this._contentSizeTrimmed)},r._setContentSize=r.setContentSize,r.setContentSize=function(t,e){if(this._lazyInit(),void 0!==e)t=new cc.Size(t,e);this._contentSizeTrimmed=new cc.Size(t),this._applyInsetsContentAnchor()},r._getAnchorPoint=r.getAnchorPoint,r.getAnchorPoint=function(){return new cc.Vec2(this._anchorPointTrimmed)},r._setAnchorPoint=r.setAnchorPoint,r.setAnchorPoint=function(t,e){if(this._lazyInit(),void 0!==e)t=new cc.Vec2(t,e);this._anchorPointTrimmed=new cc.Vec2(t),this._applyInsetsContentAnchor()},r._getInsetLeft=r.getInsetLeft,r._getInsetRight=r.getInsetRight,r._getInsetBottom=r.getInsetBottom,r._getInsetTop=r.getInsetTop,r.getInsetLeft=function(){return this._insets.left},r.getInsetRight=function(){return this._insets.right},r.getInsetBottom=function(){return this._insets.bottom},r.getInsetTop=function(){return this._insets.top},r._setInsetLeft=r.setInsetLeft,r.setInsetLeft=function(t){this._lazyInit(),this._insets.left=t,this._applyInsetsContentAnchor()},r._setInsetRight=r.setInsetRight,r.setInsetRight=function(t){this._lazyInit(),this._insets.right=t,this._applyInsetsContentAnchor()},r._setInsetTop=r.setInsetTop,r.setInsetTop=function(t){this._lazyInit(),this._insets.top=t,this._applyInsetsContentAnchor()},r._setInsetBottom=r.setInsetBottom,r.setInsetBottom=function(t){this._lazyInit(),this._insets.bottom=t,this._applyInsetsContentAnchor()},r._setSpriteFrame=r.setSpriteFrame,r.setSpriteFrame=function(t){this._lazyInit();var e=t.getOriginalSize(),i=t.getRect(),n=t.getOffset(),r=(e.width+2*n.x-i.width)/2,o=e.width-r-i.width,s=(e.height+2*n.y-i.height)/2,c=e.height-s-i.height;this._trim.left=r,this._trim.right=o,this._trim.top=c,this._trim.bottom=s,this._sizeAfterTrimmed=new cc.Size(i.width,i.height),this._setSpriteFrame(t),this._applyInsetsContentAnchor()}},{}],129:[function(t,e,i){sp._SGSkeleton=sp.Skeleton,sp._SGSkeletonAnimation=sp.SkeletonAnimation},{}],130:[function(t,e,i){"use strict";cc.textureCache._textures={},cc.textureCache.cacheImage=function(t,e){if(e instanceof cc.Texture2D)this._textures[t]=e},cc.textureCache._getTextureForKey=cc.textureCache.getTextureForKey,cc.textureCache.getTextureForKey=function(t){var e=this._getTextureForKey(t);if(!e)e=this._textures[t];return e||null},cc.Texture2D.prototype.isLoaded=function(){return!0},cc.Texture2D.prototype.getPixelWidth=cc.Texture2D.prototype.getPixelsWide,cc.Texture2D.prototype.getPixelHeight=cc.Texture2D.prototype.getPixelsHigh,
cc.js.mixin(cc.SpriteFrame.prototype,cc.EventTarget.prototype),cc.SpriteFrame.prototype.textureLoaded=function(){return null!==this.getTexture()},cc.SpriteFrame.prototype._ctor=function(t,e,i,n,r){if(void 0!==t)this.initWithTexture(t,e,i,n,r);else;},cc.SpriteFrame.prototype._initWithTexture=cc.SpriteFrame.prototype.initWithTexture,cc.SpriteFrame.prototype.initWithTexture=function(t,e,i,n,r){this.setTexture(t,e,i,n,r)},cc.SpriteFrame.prototype.setTexture=function(t,e,i,n,r){if(e)this.setRect(e);if(n)this.setOffset(n);if(r)this.setOriginalSize(r);this.setRotated(i||!1);var o=t;if(cc.js.isString(t))this._textureFilename=t,o=cc.textureCache.addImage(t);if(o instanceof cc.Texture2D)this._refreshTexture(o);else;return!0},cc.SpriteFrame.prototype._refreshTexture=function(t){if(this.getTexture()!==t){var e=t.width,i=t.height,n=this.getRect();if(0===n.width||0===n.height)n=cc.rect(0,0,e,i);else this._checkRect(t);var r=this.getOriginalSize();if(0===r.width||0===r.height)r=cc.size(e,i);var o=this.getOffset(),s=this.isRotated();if(void 0===this.insetTop)this.insetTop=0,this.insetBottom=0,this.insetLeft=0,this.insetRight=0;this._initWithTexture(t,n,s,o,r),this.emit("load")}},cc.SpriteFrame.prototype._deserialize=function(t,e){var i=t.rect;if(i)this.setRect(new cc.Rect(i[0],i[1],i[2],i[3]));if(t.offset)this.setOffset(new cc.Vec2(t.offset[0],t.offset[1]));if(t.originalSize)this.setOriginalSize(new cc.Size(t.originalSize[0],t.originalSize[1]));this.setRotated(1===t.rotated),this._name=t.name;var n=t.capInsets;if(n)this.insetLeft=n[0],this.insetTop=n[1],this.insetRight=n[2],this.insetBottom=n[3];var r=t.texture;if(r)e.result.push(this,"_textureFilenameSetter",r)},cc.SpriteFrame.prototype._checkRect=function(t){var e=this.getRect(),i=e.x,n=e.y;if(this.isRotated())i+=e.height,n+=e.width;else i+=e.width,n+=e.height;if(i>t.getPixelWidth())cc.error(cc._LogInfos.RectWidth,t.url);if(n>t.getPixelHeight())cc.error(cc._LogInfos.RectHeight,t.url)};var n=cc.SpriteFrame.prototype.getTexture;cc.SpriteFrame.prototype.getTexture=function(){var t=n.call(this);return this._texture=t,t},cc.js.set(cc.SpriteFrame.prototype,"_textureFilenameSetter",function(t){if(this._textureFilename=t,t){var e=cc.textureCache.addImage(t);this._refreshTexture(e)}}),cc.js.setClassName("cc.SpriteFrame",cc.SpriteFrame)},{}],131:[function(t,e,i){"use strict";if(!cc.Scheduler.prototype.unscheduleAllForTarget)cc.Scheduler.prototype.unscheduleAllForTarget=function(t){this.unscheduleAllCallbacksForTarget(t)};if(!cc.Scheduler.prototype._unschedule)cc.Scheduler.prototype._unschedule=cc.Scheduler.prototype.unscheduleCallbackForTarget;cc.SpriteFrame.prototype.initWithTexture=function(t,e,i,n,r,o){function s(t){if(t&&t.isLoaded()){var n,r;if(i)n=e.x+e.height,r=e.y+e.width;else n=e.x+e.width,r=e.y+e.height;if(n>t.getPixelWidth())cc.error(cc._LogInfos.RectWidth,o);if(r>t.getPixelHeight())cc.error(cc._LogInfos.RectHeight,o)}}if(n=cc.p(0,0),r=r||e,i=i||!1,void 0===this.insetTop)this.insetTop=0,this.insetBottom=0,this.insetLeft=0,this.insetRight=0;var c;if(!t&&o){var a=cc.AssetLibrary._getAssetInfoInRuntime(o);if(!a)return void cc.error('SpriteFrame: Failed to load sprite texture "%s"',o);this._textureFilename=a.url,c=cc.textureCache.addImage(a.url),this._initWithTexture(c,e,i,n,r)}else if(cc.js.isString(t))this._textureFilename=t,c=cc.textureCache.addImage(this._textureFilename),this._initWithTexture(c,e,i,n,r);else if(t instanceof cc.Texture2D)this._textureFilename="",this._initWithTexture(t,e,i,n,r);return this.emit("load"),s(this.getTexture()),!0}},{}],132:[function(t,e,i){"use strict";var n={update:function(t){cc.director.emit(cc.Director.EVENT_BEFORE_UPDATE),cc.director.emit(cc.Director.EVENT_COMPONENT_UPDATE,t)}};cc.Director.getInstance().getScheduler().scheduleUpdateForTarget(n,-1e3,!1)},{}],133:[function(t,e,i){"use strict";cc.Scale9Sprite.prototype.setRenderingType=function(t){if(this._renderingType!==t){if(this._renderingType=t,!this.isScale9Enabled())this.setScale9Enabled(!0);if(t===cc.Scale9Sprite.RenderingType.SIMPLE)this.setInsetLeft(0),this.setInsetTop(0),this.setInsetBottom(0),this.setInsetRight(0)}}},{}],134:[function(t,e,i){},{}]},{},[116,110]);